\section{\texttt{jodliterate} Source Code}

\begin{JODGroupHeader}
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB.*jodliterate s{-}{-} generates literate source code documents directly from JOD groups.}
\CommentTok{NB.}
\CommentTok{NB. verbatim:}
\CommentTok{NB.}
\CommentTok{NB. http://bakerjd99.wordpress.com/2012/10/01/semi{-}literate{-}jod/}
\CommentTok{NB.}
\CommentTok{NB. interface word(s):}
\CommentTok{NB. {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{NB.  grplit         {-} make latex for group (y)}
\CommentTok{NB.  ifacesection   {-} interface section summary string}
\CommentTok{NB.  setjodliterate {-} prepare for processing}
\CommentTok{NB.}
\CommentTok{NB. author:  John D. Baker}
\CommentTok{NB. created: 2012oct01}
\CommentTok{NB. {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{NB. 12oct03 (x) grplit argument added to suppress root tex overwrites}
\CommentTok{NB. 12oct04 group IFACEWORDSgroupname hyperlinked}
\CommentTok{NB. 12oct05 replaced ;: parsing with (wfl) {-} handles bad j code}
\CommentTok{NB. 12oct08 added error handling {-} replaced (write) with (writeas)}
\CommentTok{NB. 12oct11 adjusted LaTeX preamble {-} changing monofonts}
\CommentTok{NB. 12oct12 added (sbtokens) {-} useful for analyzing code text}
\CommentTok{NB. 12oct17 added (wrapvrblong) {-} long source lines now wrapped}
\CommentTok{NB. 13dec29 added to (jacks) GitHub repository}
\CommentTok{NB. 20may07 adjusted word formation (wfl) for J 9.01}
\CommentTok{NB. 20may08 updated for current (pandoc) versions}

\NormalTok{coclass  }\StringTok{\textquotesingle{}ajodliterate\textquotesingle{}}
\NormalTok{coinsert }\StringTok{\textquotesingle{}ijod\textquotesingle{}}

\CommentTok{NB.*dependents}
\CommentTok{NB. declared global here to avoid confusing LaTeX names with J names}
\CommentTok{NB. (*)=: JLTITLETEX JLOVIEWTEX JLBUILDTEX JLGRPLITTEX JODLiteratePreamble}

\CommentTok{NB. Roger Hui\textquotesingle{}s word formation state machine {-} similiar to ;: but}
\CommentTok{NB. parses text with LFs, retains whitespace and handles open quotes.}
\CommentTok{NB.}
\CommentTok{NB. verbatim: note difference}
\CommentTok{NB.}
\CommentTok{NB.    wfl\textquotesingle{}+/ i. 23 5, \textquotesingle{}\textquotesingle{}OPEN QUOTE\textquotesingle{}}
\CommentTok{NB.    ;:\textquotesingle{}+/ i. 23 5, \textquotesingle{}\textquotesingle{}OPEN QUOTE\textquotesingle{}}

\CommentTok{NB. hide script locals !(*)=. mfl sfl}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{256}\KeywordTok{$}\DecValTok{0}                        \CommentTok{NB. X other}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{1}  \RegionMarkerTok{(}\DecValTok{9}\KeywordTok{,a.i.}\StringTok{\textquotesingle{} \textquotesingle{}}\RegionMarkerTok{)}         \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. S whitespace (space and horizontal tab)}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{2}  \RegionMarkerTok{(}\KeywordTok{,}\RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}Aa\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{+/i.}\DecValTok{26}\RegionMarkerTok{)} \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. A A{-}Z a{-}z excluding N B}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{3}  \RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}N\textquotesingle{}}\RegionMarkerTok{)}           \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. N the letter N}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{4}  \RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}B\textquotesingle{}}\RegionMarkerTok{)}           \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. B the letter B}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{5}  \RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}0123456789\_\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. 9 digits and \_}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{6}  \RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}.\textquotesingle{}}\RegionMarkerTok{)}           \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. D .}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{7}  \RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}:\textquotesingle{}}\RegionMarkerTok{)}           \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. C :}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{8}  \RegionMarkerTok{(}\KeywordTok{a.i.}\StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}          \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. Q quote}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{9}  \RegionMarkerTok{(}\DecValTok{13}\RegionMarkerTok{)}                \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. CR}
\NormalTok{mfl}\KeywordTok{=.} \DecValTok{10} \RegionMarkerTok{(}\DecValTok{10}\RegionMarkerTok{)}                \KeywordTok{\}}\NormalTok{mfl  }\CommentTok{NB. LF}

\NormalTok{sfl}\KeywordTok{=.} \DecValTok{\_2}\KeywordTok{]\textbackslash{}"}\DecValTok{1} \KeywordTok{\}.".;.}\NormalTok{\_}\DecValTok{2} \RegionMarkerTok{(}\DecValTok{0} \RegionMarkerTok{: 0)}
\StringTok{\textquotesingle{} X     S    A    N    B    9    D    C    Q    CR     LF  \textquotesingle{}}\KeywordTok{]}\DecValTok{0}
 \DecValTok{1} \DecValTok{1}  \DecValTok{12} \DecValTok{1}  \DecValTok{2} \DecValTok{1}  \DecValTok{3} \DecValTok{1}  \DecValTok{2} \DecValTok{1}  \DecValTok{6} \DecValTok{1}  \DecValTok{1} \DecValTok{1}  \DecValTok{1} \DecValTok{1}  \DecValTok{7} \DecValTok{1}  \DecValTok{10} \DecValTok{1}   \DecValTok{1} \DecValTok{1}   \CommentTok{NB. 0  initial}
 \DecValTok{1} \DecValTok{2}  \DecValTok{12} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{3} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{6} \DecValTok{2}  \DecValTok{1} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 1  other}
 \DecValTok{1} \DecValTok{2}  \DecValTok{12} \DecValTok{2}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 2  alp/num}
 \DecValTok{1} \DecValTok{2}  \DecValTok{12} \DecValTok{2}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{4} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 3  N}
 \DecValTok{1} \DecValTok{2}  \DecValTok{12} \DecValTok{2}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{2} \DecValTok{0}  \DecValTok{5} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 4  NB}
 \DecValTok{9} \DecValTok{0}   \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 5  NB.}
 \DecValTok{1} \DecValTok{4}  \DecValTok{13} \DecValTok{0}  \DecValTok{6} \DecValTok{0}  \DecValTok{6} \DecValTok{0}  \DecValTok{6} \DecValTok{0}  \DecValTok{6} \DecValTok{0}  \DecValTok{6} \DecValTok{0}  \DecValTok{1} \DecValTok{0}  \DecValTok{7} \DecValTok{4}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 6  num}
 \DecValTok{7} \DecValTok{0}   \DecValTok{7} \DecValTok{0}  \DecValTok{7} \DecValTok{0}  \DecValTok{7} \DecValTok{0}  \DecValTok{7} \DecValTok{0}  \DecValTok{7} \DecValTok{0}  \DecValTok{7} \DecValTok{0}  \DecValTok{7} \DecValTok{0}  \DecValTok{8} \DecValTok{0}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 7  \textquotesingle{}}
 \DecValTok{1} \DecValTok{2}  \DecValTok{11} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{3} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{6} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{7} \DecValTok{0}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 8  \textquotesingle{}\textquotesingle{}}
 \DecValTok{9} \DecValTok{0}   \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{9} \DecValTok{0}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 9  comment}
 \DecValTok{1} \DecValTok{2}  \DecValTok{11} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{4} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{6} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}  \DecValTok{11} \DecValTok{0}   \CommentTok{NB. 10 CR}
 \DecValTok{1} \DecValTok{2}  \DecValTok{11} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{4} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{6} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 11 CRLF}
 \DecValTok{1} \DecValTok{2}  \DecValTok{12} \DecValTok{0}  \DecValTok{2} \DecValTok{2}  \DecValTok{3} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{6} \DecValTok{0}  \DecValTok{1} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 12 space}
 \DecValTok{1} \DecValTok{2}  \DecValTok{13} \DecValTok{0}  \DecValTok{2} \DecValTok{2}  \DecValTok{3} \DecValTok{2}  \DecValTok{2} \DecValTok{2}  \DecValTok{6} \DecValTok{0}  \DecValTok{1} \DecValTok{2}  \DecValTok{1} \DecValTok{2}  \DecValTok{7} \DecValTok{2}  \DecValTok{10} \DecValTok{2}   \DecValTok{1} \DecValTok{2}   \CommentTok{NB. 13 space after num}
\RegionMarkerTok{)}

\CommentTok{NB. word formation for lines}
\NormalTok{wfl}\AlertTok{=:}\index{wfl@\texttt{wfl}}  \RegionMarkerTok{(}\DecValTok{0}\KeywordTok{;}\NormalTok{sfl}\KeywordTok{;}\NormalTok{mfl}\RegionMarkerTok{)} \KeywordTok{\&} \KeywordTok{;:}

\NormalTok{JLDIRECTORY}\AlertTok{=:}\index{JLDIRECTORY@\texttt{JLDIRECTORY}}  \StringTok{\textquotesingle{}\textquotesingle{}}
\CommentTok{NB.*enddependents}


\CommentTok{NB.<<\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{} \{ .latex \}}

\CommentTok{NB. group title and author {-} standard \textbackslash{}maketitle}
\NormalTok{JLTITLETEX}\AlertTok{=:}\index{JLTITLETEX@\texttt{JLTITLETEX}}  \DecValTok{0} \RegionMarkerTok{: 0}

\KeywordTok{\%}\NormalTok{ latex author and title}
\KeywordTok{\textbackslash{}}\NormalTok{author}\KeywordTok{\{\textasciitilde{}\#\textasciitilde{}}\NormalTok{author}\KeywordTok{\textasciitilde{}\#\textasciitilde{}\}}
\KeywordTok{\textbackslash{}}\NormalTok{title}\KeywordTok{\{\textbackslash{}}\NormalTok{texttt}\KeywordTok{\{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}\}}\NormalTok{ Group}\KeywordTok{\}}
\RegionMarkerTok{)}

\CommentTok{NB. group overview header}
\NormalTok{JLOVIEWTEX}\AlertTok{=:}\index{JLOVIEWTEX@\texttt{JLOVIEWTEX}}  \DecValTok{0} \RegionMarkerTok{: 0}

\KeywordTok{\%}\NormalTok{ this jodliterate overview}
\KeywordTok{\textbackslash{}}\NormalTok{section}\KeywordTok{\{\textbackslash{}}\NormalTok{texttt}\KeywordTok{\{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}\}}\NormalTok{ Overview}\KeywordTok{\}}
\RegionMarkerTok{)}

\CommentTok{NB. latex group build script }
\NormalTok{JLBUILDTEX}\AlertTok{=:}\index{JLBUILDTEX@\texttt{JLBUILDTEX}}  \DecValTok{0} \RegionMarkerTok{: 0}

\NormalTok{rem sequence of latex commands that generate PDF}
\NormalTok{rem assumes commands are on the working path}
\NormalTok{lualatex  }\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}
\NormalTok{makeindex }\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}
\NormalTok{lualatex  }\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}
\NormalTok{lualatex  }\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}
\RegionMarkerTok{)}

\CommentTok{NB. group root tex {-} columns may need adjusting}
\NormalTok{JLGRPLITTEX}\AlertTok{=:}\index{JLGRPLITTEX@\texttt{JLGRPLITTEX}}  \DecValTok{0} \RegionMarkerTok{: 0}

\KeywordTok{\%}\NormalTok{ Main jodliterate }\RegionMarkerTok{(}\NormalTok{grplit}\RegionMarkerTok{)}\NormalTok{ latex file}\KeywordTok{.} \RegionMarkerTok{(}\NormalTok{grplit}\RegionMarkerTok{)}\NormalTok{ generates }\KeywordTok{"}\NormalTok{group}\KeywordTok{"}
\KeywordTok{\%}\NormalTok{ named versions of this file for each JOD group it processes}\KeywordTok{.}

\KeywordTok{\textbackslash{}}\NormalTok{input}\KeywordTok{\{}\NormalTok{JODLiteratePreamble}\KeywordTok{.}\NormalTok{tex}\KeywordTok{\}}

\KeywordTok{\textbackslash{}}\NormalTok{input}\KeywordTok{\{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{title}\KeywordTok{.}\NormalTok{tex}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{maketitle}
\KeywordTok{\textbackslash{}}\NormalTok{tableofcontents}

\KeywordTok{\textbackslash{}}\NormalTok{newpage}
\KeywordTok{\%}\NormalTok{ commands for adjusting distance}
\KeywordTok{\%}\NormalTok{ between columns and inserting a rule}
\KeywordTok{\%\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{columnsep}\KeywordTok{\}\{}\NormalTok{3em}\KeywordTok{\}}
\KeywordTok{\%\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{columnseprule}\KeywordTok{\}\{}\NormalTok{0}\KeywordTok{.}\NormalTok{5pt}\KeywordTok{\}}
\KeywordTok{\%\textbackslash{}}\NormalTok{twocolumn}
\KeywordTok{\textbackslash{}}\NormalTok{input}\KeywordTok{\{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{oview}\KeywordTok{.}\NormalTok{tex}\KeywordTok{\}}

\KeywordTok{\textbackslash{}}\NormalTok{newpage}
\KeywordTok{\%\textbackslash{}}\NormalTok{onecolumn}
\KeywordTok{\textbackslash{}}\NormalTok{input}\KeywordTok{\{\textasciitilde{}\#\textasciitilde{}}\NormalTok{group}\KeywordTok{\textasciitilde{}\#\textasciitilde{}}\NormalTok{code}\KeywordTok{.}\NormalTok{tex}\KeywordTok{\}}

\KeywordTok{\textbackslash{}}\NormalTok{newpage}
\KeywordTok{\textbackslash{}}\NormalTok{phantomsection}
\KeywordTok{\textbackslash{}}\NormalTok{addcontentsline}\KeywordTok{\{}\NormalTok{toc}\KeywordTok{\}\{}\NormalTok{section}\KeywordTok{\}\{\textbackslash{}}\NormalTok{texttt}\KeywordTok{\{=:\}}\NormalTok{ Index}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{printindex}

\KeywordTok{\textbackslash{}}\NormalTok{end}\KeywordTok{\{}\NormalTok{document}\KeywordTok{\}}
\RegionMarkerTok{)}

\CommentTok{NB. main jodliterate LaTeX preamble}
\NormalTok{JODLiteratePreamble}\AlertTok{=:}\index{JODLiteratePreamble@\texttt{JODLiteratePreamble}}  \DecValTok{0} \RegionMarkerTok{: 0}

\KeywordTok{\%}\NormalTok{ jodliterate latex preamble}\KeywordTok{.} 
\KeywordTok{\%} 
\KeywordTok{\%}\NormalTok{ This file is a highly customized version of the preamble}
\KeywordTok{\%}\NormalTok{ material generated by pandoc\textquotesingle{}s }\KeywordTok{{-}}\NormalTok{s option when producing }
\KeywordTok{\%} \KeywordTok{.}\NormalTok{tex output}\KeywordTok{.}\NormalTok{ pandoc highlighting is overridden and}
\KeywordTok{\%}\NormalTok{ the standard index is redefined}\KeywordTok{.} 

\KeywordTok{\textbackslash{}}\NormalTok{documentclass}\KeywordTok{[}\NormalTok{12pt}\KeywordTok{]\{}\NormalTok{article}\KeywordTok{\}}

\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{[}\NormalTok{landscape}\KeywordTok{]\{}\NormalTok{geometry}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{[}\NormalTok{headings}\KeywordTok{]\{}\NormalTok{fullpage}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{lmodern}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{amssymb}\KeywordTok{,}\NormalTok{amsmath}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{ifxetex}\KeywordTok{,}\NormalTok{ifluatex}\KeywordTok{\}}

\KeywordTok{\%}\NormalTok{ provides }\KeywordTok{\textbackslash{}}\NormalTok{textsubscript}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{fixltx2e}\KeywordTok{\}} 

\KeywordTok{\%}\NormalTok{ use microtype if available}
\KeywordTok{\textbackslash{}}\NormalTok{IfFileExists}\KeywordTok{\{}\NormalTok{microtype}\KeywordTok{.}\NormalTok{sty}\KeywordTok{\}\{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{microtype}\KeywordTok{\}\}\{\}}
\KeywordTok{\textbackslash{}}\NormalTok{ifnum }\DecValTok{0}\KeywordTok{\textbackslash{}}\NormalTok{ifxetex }\DecValTok{1}\KeywordTok{\textbackslash{}}\NormalTok{fi}\KeywordTok{\textbackslash{}}\NormalTok{ifluatex }\DecValTok{1}\KeywordTok{\textbackslash{}}\NormalTok{fi}\KeywordTok{=}\DecValTok{0} \KeywordTok{\%}\NormalTok{ if pdftex}
  \KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{[}\NormalTok{utf8}\KeywordTok{]\{}\NormalTok{inputenc}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{else }\KeywordTok{\%}\NormalTok{ if luatex or xelatex}
  \KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{fontspec}\KeywordTok{\}}
  \KeywordTok{\textbackslash{}}\NormalTok{ifxetex}
    \KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{xltxtra}\KeywordTok{,}\NormalTok{xunicode}\KeywordTok{\}}
  \KeywordTok{\textbackslash{}}\NormalTok{fi}
  \KeywordTok{\textbackslash{}}\NormalTok{defaultfontfeatures}\KeywordTok{\{}\NormalTok{Mapping}\KeywordTok{=}\NormalTok{tex}\KeywordTok{{-}}\NormalTok{text}\KeywordTok{,}\NormalTok{Scale}\KeywordTok{=}\NormalTok{MatchLowercase}\KeywordTok{\}}
  \KeywordTok{\%}\NormalTok{ replace EUROUC with unicode euro character }
  \KeywordTok{\%}\NormalTok{ if you need this character }\KeywordTok{{-}}\NormalTok{ the presence of}
  \KeywordTok{\%}\NormalTok{ this single character in the preamble forces use of xelatex}\KeywordTok{,}\NormalTok{ lualated}
  \KeywordTok{\%\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{euro}\KeywordTok{\}\{}\NormalTok{EUROUC}\KeywordTok{\}}   
  \KeywordTok{\%}\NormalTok{ can set other monospace fonts if they\textquotesingle{}re available}
  \KeywordTok{\%}\NormalTok{ I rather like Source Code Pro see}\KeywordTok{:}
  \KeywordTok{\%}\NormalTok{ http}\KeywordTok{://}\NormalTok{blogs}\KeywordTok{.}\NormalTok{adobe}\KeywordTok{.}\NormalTok{com}\KeywordTok{/}\NormalTok{typblography}\KeywordTok{/}\DecValTok{2012}\KeywordTok{/}\DecValTok{09}\KeywordTok{/}\NormalTok{source}\KeywordTok{{-}}\NormalTok{code}\KeywordTok{{-}}\NormalTok{pro}\KeywordTok{.}\NormalTok{html}
  \KeywordTok{\%\textbackslash{}}\NormalTok{setmonofont}\KeywordTok{\{}\NormalTok{FreeMono}\KeywordTok{\}}
  \KeywordTok{\%\textbackslash{}}\NormalTok{setmonofont}\KeywordTok{\{}\NormalTok{Source Code Pro}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{fi}

\KeywordTok{\%}\NormalTok{ Redefine labelwidth for lists}\KeywordTok{;}\NormalTok{ otherwise}\KeywordTok{,}\NormalTok{ the enumerate package will cause}
\KeywordTok{\%}\NormalTok{ markers to extend beyond the left margin}\KeywordTok{.}
\KeywordTok{\textbackslash{}}\NormalTok{makeatletter}\KeywordTok{\textbackslash{}}\NormalTok{AtBeginDocument}\KeywordTok{\{\%}
  \KeywordTok{\textbackslash{}}\NormalTok{renewcommand}\KeywordTok{\{\textbackslash{}@}\NormalTok{listi}\KeywordTok{\}}
    \KeywordTok{\{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{labelwidth}\KeywordTok{\}\{}\NormalTok{4em}\KeywordTok{\}\}}
\KeywordTok{\}\textbackslash{}}\NormalTok{makeatother}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{enumerate}\KeywordTok{\}}

\KeywordTok{\%}\NormalTok{ build document index}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{makeidx}\KeywordTok{\}}

\KeywordTok{\%}\NormalTok{ colors}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{color}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{shadecolor}\KeywordTok{\}\{}\NormalTok{RGB}\KeywordTok{\}\{}\DecValTok{248}\KeywordTok{,}\DecValTok{248}\KeywordTok{,}\DecValTok{248}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ j control structures }
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{keywcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.13}\KeywordTok{,}\DecValTok{0.29}\KeywordTok{,}\DecValTok{0.53}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ j explicit arguments }\KeywordTok{x} \KeywordTok{y} \KeywordTok{m} \KeywordTok{n} \KeywordTok{u} \KeywordTok{v}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{datacolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.13}\KeywordTok{,}\DecValTok{0.29}\KeywordTok{,}\DecValTok{0.53}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ j numbers }\KeywordTok{{-}}\NormalTok{ all types see }\KeywordTok{j.}\NormalTok{xml}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{decvcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.81}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{basencolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.81}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{floatcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.81}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ j local assignments}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{charcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.31}\KeywordTok{,}\DecValTok{0.60}\KeywordTok{,}\DecValTok{0.02}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{stringcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.31}\KeywordTok{,}\DecValTok{0.60}\KeywordTok{,}\DecValTok{0.02}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{commentcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.56}\KeywordTok{,}\DecValTok{0.35}\KeywordTok{,}\DecValTok{0.01}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ primitive adverbs and conjunctions}
\KeywordTok{\%\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{othercolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.56}\KeywordTok{,}\DecValTok{0.35}\KeywordTok{,}\DecValTok{0.01}\KeywordTok{\}}   
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{othercolor}\KeywordTok{\}\{}\NormalTok{RGB}\KeywordTok{\}\{}\DecValTok{0}\KeywordTok{,}\DecValTok{0}\KeywordTok{,}\DecValTok{255}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ global assignments}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{alertcolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.94}\KeywordTok{,}\DecValTok{0.16}\KeywordTok{,}\DecValTok{0.16}\KeywordTok{\}}
\KeywordTok{\%}\NormalTok{ primitive J verbs and noun names}
\KeywordTok{\textbackslash{}}\NormalTok{definecolor}\KeywordTok{\{}\NormalTok{funccolor}\KeywordTok{\}\{}\NormalTok{rgb}\KeywordTok{\}\{}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.00}\KeywordTok{,}\DecValTok{0.00}\KeywordTok{\}}     

\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{fancyvrb}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{DefineShortVerb}\KeywordTok{[}\NormalTok{commandchars}\KeywordTok{=\textbackslash{}\textbackslash{}\textbackslash{}\{\textbackslash{}\}]\{\textbackslash{}|\}}
\KeywordTok{\textbackslash{}}\NormalTok{DefineVerbatimEnvironment}\KeywordTok{\{}\NormalTok{Highlighting}\KeywordTok{\}\{}\NormalTok{Verbatim}\KeywordTok{\}\{}\NormalTok{commandchars}\KeywordTok{=\textbackslash{}\textbackslash{}\textbackslash{}\{\textbackslash{}\}\}}
\KeywordTok{\%}\NormalTok{ Add }\StringTok{\textquotesingle{},fontsize=\textbackslash{}small\textquotesingle{}}\NormalTok{ for more characters per line}

\KeywordTok{\%}\NormalTok{ pandoc generated syntax coloring commands }\KeywordTok{{-}}\NormalTok{ names}
\KeywordTok{\%}\NormalTok{ are fixed in generated code but definitions may }
\KeywordTok{\%}\NormalTok{ be set to any valid text formatting command}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{framed}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{newenvironment}\KeywordTok{\{}\NormalTok{Shaded}\KeywordTok{\}\{\}\{\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{KeywordTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{keywcolor}\KeywordTok{\}\{\textbackslash{}}\NormalTok{textbf}\KeywordTok{\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}\}}
\KeywordTok{\%}\NormalTok{ works better with Source Code Pro}
\KeywordTok{\%\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{KeywordTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{keywcolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{DataTypeTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{datacolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\%\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{DecValTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{decvcolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{DecValTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\{\#}\DecValTok{1}\KeywordTok{\}\}} 
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{BaseNTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{basencolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{FloatTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{floatcolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{CharTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{charcolor}\KeywordTok{\}\{\textbackslash{}}\NormalTok{textbf}\KeywordTok{\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{StringTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{stringcolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{CommentTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{commentcolor}\KeywordTok{\}\{\textbackslash{}}\NormalTok{textit}\KeywordTok{\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{OtherTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{othercolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}} 
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{AlertTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{alertcolor}\KeywordTok{\}\{\textbackslash{}}\NormalTok{textbf}\KeywordTok{\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}\}}
\KeywordTok{\%\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{FunctionTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textcolor}\KeywordTok{\{}\NormalTok{funccolor}\KeywordTok{\}\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{FunctionTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\{\#}\DecValTok{1}\KeywordTok{\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{RegionMarkerTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\{\#}\DecValTok{1}\KeywordTok{\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{ErrorTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\textbackslash{}}\NormalTok{textbf}\KeywordTok{\{\{\#}\DecValTok{1}\KeywordTok{\}\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{newcommand}\KeywordTok{\{\textbackslash{}}\NormalTok{NormalTok}\KeywordTok{\}[}\DecValTok{1}\KeywordTok{]\{\{\#}\DecValTok{1}\KeywordTok{\}\}}

\KeywordTok{\%}\NormalTok{ JOD oriented auxiliary commands for post processing pandoc generated latex}
\KeywordTok{\textbackslash{}}\NormalTok{newenvironment}\KeywordTok{\{}\NormalTok{JODGroupHeader}\KeywordTok{\}\{\}\{\}}
\KeywordTok{\textbackslash{}}\NormalTok{newenvironment}\KeywordTok{\{}\NormalTok{JODPostProcessor}\KeywordTok{\}\{\}\{\}}

\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{fancyhdr}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{pagestyle}\KeywordTok{\{}\NormalTok{fancy}\KeywordTok{\}}

\KeywordTok{\textbackslash{}}\NormalTok{ifxetex}
  \KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{[}\NormalTok{setpagesize}\KeywordTok{=}\NormalTok{false}\KeywordTok{,} \KeywordTok{\%}\NormalTok{ page size defined by xetex}
\NormalTok{              unicode}\KeywordTok{=}\NormalTok{false}\KeywordTok{,}     \KeywordTok{\%}\NormalTok{ unicode breaks when used with xetex}
\NormalTok{              xetex}\KeywordTok{]\{}\NormalTok{hyperref}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{else}
  \KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{[}\NormalTok{unicode}\KeywordTok{=}\NormalTok{true}\KeywordTok{]\{}\NormalTok{hyperref}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{fi}

\KeywordTok{\textbackslash{}}\NormalTok{hypersetup}\KeywordTok{\{}\NormalTok{breaklinks}\KeywordTok{=}\NormalTok{true}\KeywordTok{,}
\NormalTok{            bookmarks}\KeywordTok{=}\NormalTok{true}\KeywordTok{,}
\NormalTok{            pdfauthor}\KeywordTok{=\{\},}
\NormalTok{            pdftitle}\KeywordTok{=\{\},}
\NormalTok{            colorlinks}\KeywordTok{=}\NormalTok{true}\KeywordTok{,}
\NormalTok{            urlcolor}\KeywordTok{=}\NormalTok{blue}\KeywordTok{,}
\NormalTok{            linkcolor}\KeywordTok{=}\NormalTok{magenta}\KeywordTok{,}
\NormalTok{            pdfborder}\KeywordTok{=\{}\DecValTok{0} \DecValTok{0} \DecValTok{0}\KeywordTok{\}\}}
\KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{parindent}\KeywordTok{\}\{}\NormalTok{0pt}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{parskip}\KeywordTok{\}\{}\NormalTok{6pt plus 2pt minus 1pt}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{emergencystretch}\KeywordTok{\}\{}\NormalTok{3em}\KeywordTok{\}}  \KeywordTok{\%}\NormalTok{ prevent overfull lines}
\KeywordTok{\textbackslash{}}\NormalTok{setcounter}\KeywordTok{\{}\NormalTok{secnumdepth}\KeywordTok{\}\{}\DecValTok{0}\KeywordTok{\}}

\KeywordTok{\%}\NormalTok{ reset latex index to use four columns }\KeywordTok{{-}}\NormalTok{ default is two}
\KeywordTok{\%}\NormalTok{ which results in lots of wasted page space in landscape}
\KeywordTok{\%}\NormalTok{ NOTE}\KeywordTok{:}\NormalTok{ adjust if index names run together }
\KeywordTok{\%}\NormalTok{ from}\KeywordTok{:}\NormalTok{ http}\KeywordTok{://}\NormalTok{www}\KeywordTok{.}\NormalTok{latex}\KeywordTok{{-}}\NormalTok{community}\KeywordTok{.}\NormalTok{org}\KeywordTok{/}\NormalTok{viewtopic}\KeywordTok{.}\NormalTok{php}\KeywordTok{?}\NormalTok{f}\KeywordTok{=}\DecValTok{4}\KeywordTok{\&}\NormalTok{t}\KeywordTok{=}\DecValTok{1735}
\KeywordTok{\textbackslash{}}\NormalTok{usepackage}\KeywordTok{\{}\NormalTok{multicol}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{makeatletter}
\KeywordTok{\textbackslash{}}\NormalTok{renewenvironment}\KeywordTok{\{}\NormalTok{theindex}\KeywordTok{\}}
  \KeywordTok{\{\textbackslash{}}\NormalTok{if}\KeywordTok{@}\NormalTok{twocolumn}
      \KeywordTok{\textbackslash{}@}\NormalTok{restonecolfalse}
   \KeywordTok{\textbackslash{}}\NormalTok{else}
      \KeywordTok{\textbackslash{}@}\NormalTok{restonecoltrue}
   \KeywordTok{\textbackslash{}}\NormalTok{fi}
   \KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{columnseprule}\KeywordTok{\}\{}\NormalTok{0pt}\KeywordTok{\}}
   \KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{columnsep}\KeywordTok{\}\{}\NormalTok{35pt}\KeywordTok{\}}
   \KeywordTok{\textbackslash{}}\NormalTok{begin}\KeywordTok{\{}\NormalTok{multicols}\KeywordTok{\}\{}\DecValTok{4}\KeywordTok{\}[\textbackslash{}}\NormalTok{section}\KeywordTok{*\{\textbackslash{}}\NormalTok{indexname}\KeywordTok{\}]}
   \KeywordTok{\textbackslash{}}\NormalTok{markboth}\KeywordTok{\{\textbackslash{}}\NormalTok{MakeUppercase}\KeywordTok{\textbackslash{}}\NormalTok{indexname}\KeywordTok{\}\%}
            \KeywordTok{\{\textbackslash{}}\NormalTok{MakeUppercase}\KeywordTok{\textbackslash{}}\NormalTok{indexname}\KeywordTok{\}\%}
   \KeywordTok{\textbackslash{}}\NormalTok{thispagestyle}\KeywordTok{\{}\NormalTok{plain}\KeywordTok{\}}
   \KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{parindent}\KeywordTok{\}\{}\NormalTok{0pt}\KeywordTok{\}}
   \KeywordTok{\textbackslash{}}\NormalTok{setlength}\KeywordTok{\{\textbackslash{}}\NormalTok{parskip}\KeywordTok{\}\{}\NormalTok{0pt plus 0}\KeywordTok{.}\NormalTok{3pt}\KeywordTok{\}}
   \KeywordTok{\textbackslash{}}\NormalTok{relax}
   \KeywordTok{\textbackslash{}}\NormalTok{let}\KeywordTok{\textbackslash{}}\NormalTok{item}\KeywordTok{\textbackslash{}@}\NormalTok{idxitem}\KeywordTok{\}\%}
  \KeywordTok{\{\textbackslash{}}\NormalTok{end}\KeywordTok{\{}\NormalTok{multicols}\KeywordTok{\}\textbackslash{}}\NormalTok{if}\KeywordTok{@}\NormalTok{restonecol}\KeywordTok{\textbackslash{}}\NormalTok{onecolumn}\KeywordTok{\textbackslash{}}\NormalTok{else}\KeywordTok{\textbackslash{}}\NormalTok{clearpage}\KeywordTok{\textbackslash{}}\NormalTok{fi}\KeywordTok{\}}
\KeywordTok{\textbackslash{}}\NormalTok{makeatother}

\KeywordTok{\textbackslash{}}\NormalTok{makeindex}

\KeywordTok{\textbackslash{}}\NormalTok{begin}\KeywordTok{\{}\NormalTok{document}\KeywordTok{\}}

\RegionMarkerTok{)}
\CommentTok{NB.>>\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}}

\CommentTok{NB.*end{-}header}
\end{Highlighting}
\end{Shaded}
\end{JODGroupHeader}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. string marking start of LaTeX indexed word {-} see FAKETOKENS}
\NormalTok{BEGININDEX}\AlertTok{=:}\index{BEGININDEX@\texttt{BEGININDEX}} \StringTok{\textquotesingle{}\textbackslash{}KeywordTok\{=::=::\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks start of JOD group header in pandoc latex}
\NormalTok{BEGINJODHEADER}\AlertTok{=:}\index{BEGINJODHEADER@\texttt{BEGINJODHEADER}} \StringTok{\textquotesingle{}\textbackslash{}begin\{JODGroupHeader\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks start of JOD group postprocessor in pandoc latex}
\NormalTok{BEGINJODPOSTP}\AlertTok{=:}\index{BEGINJODPOSTP@\texttt{BEGINJODPOSTP}} \StringTok{\textquotesingle{}\textbackslash{}begin\{JODPostProcessor\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks the start of J script text that is not J}
\NormalTok{BEGINNOTJ}\AlertTok{=:}\index{BEGINNOTJ@\texttt{BEGINNOTJ}} \StringTok{\textquotesingle{}NB.<<\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. carriage return character}
\NormalTok{CR}\AlertTok{=:}\index{CR@\texttt{CR}} \DecValTok{13}\KeywordTok{\{a.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. string marking end of LaTeX indexed word {-} see FAKETOKENS}
\NormalTok{ENDINDEX}\AlertTok{=:}\index{ENDINDEX@\texttt{ENDINDEX}} \StringTok{\textquotesingle{}\textbackslash{}KeywordTok\{=..=..\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks end of JOD group header in pandoc latex}
\NormalTok{ENDJODHEADER}\AlertTok{=:}\index{ENDJODHEADER@\texttt{ENDJODHEADER}} \StringTok{\textquotesingle{}\textbackslash{}end\{JODGroupHeader\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks end of JOD group postprocessor in pandoc latex}
\NormalTok{ENDJODPOSTP}\AlertTok{=:}\index{ENDJODPOSTP@\texttt{ENDJODPOSTP}} \StringTok{\textquotesingle{}\textbackslash{}end\{JODPostProcessor\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks the end of J script text that is not J}
\NormalTok{ENDNOTJ}\AlertTok{=:}\index{ENDNOTJ@\texttt{ENDNOTJ}} \StringTok{\textquotesingle{}NB.>>\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 2 and 3 j (wfl) tokens {-} the trailing blank of (;1\{FAKETOKENS) matters!}
\NormalTok{FAKETOKENS}\AlertTok{=:}\index{FAKETOKENS@\texttt{FAKETOKENS}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \StringTok{\textquotesingle{}|=::=::|=..=.. \textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. interface word list name prefix}
\NormalTok{IFACEWORDSPFX}\AlertTok{=:}\index{IFACEWORDSPFX@\texttt{IFACEWORDSPFX}} \StringTok{\textquotesingle{}IFACEWORDS\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{IFACEWORDSjodliterate}\AlertTok{=:}\index{IFACEWORDSjodliterate@\texttt{IFACEWORDSjodliterate}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \StringTok{\textquotesingle{} THISPANDOC grplit ifacesection setjodliterate\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. jodliterate author {-} inserted in latex \textbackslash{}author\{\}}
\NormalTok{JLAUTHOR}\AlertTok{=:}\index{JLAUTHOR@\texttt{JLAUTHOR}} \StringTok{\textquotesingle{}John D. Baker\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. suffix of jodliterate code file}
\NormalTok{JLCODEFILE}\AlertTok{=:}\index{JLCODEFILE@\texttt{JLCODEFILE}} \StringTok{\textquotesingle{}code.tex\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. suffix of jodliterate overview file}
\NormalTok{JLOVIEWFILE}\AlertTok{=:}\index{JLOVIEWFILE@\texttt{JLOVIEWFILE}} \StringTok{\textquotesingle{}oview.tex\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. name suffix of markdown overview text}
\NormalTok{JLOVIEWSUFFIX}\AlertTok{=:}\index{JLOVIEWSUFFIX@\texttt{JLOVIEWSUFFIX}} \StringTok{\textquotesingle{}\_oview\_tex\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. suffix of jodliterate title file}
\NormalTok{JLTITLEFILE}\AlertTok{=:}\index{JLTITLEFILE@\texttt{JLTITLEFILE}} \StringTok{\textquotesingle{}title.tex\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. temporary latex file}
\NormalTok{LATEXTMP}\AlertTok{=:}\index{LATEXTMP@\texttt{LATEXTMP}} \StringTok{\textquotesingle{}jltemp.tex\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. line feed character}
\NormalTok{LF}\AlertTok{=:}\index{LF@\texttt{LF}} \DecValTok{10}\KeywordTok{\{a.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks start of J code for pandoc {-}{-} requires pandoc with j syntax coloring}
\NormalTok{MARKDOWNHEAD}\AlertTok{=:}\index{MARKDOWNHEAD@\texttt{MARKDOWNHEAD}} \StringTok{\textquotesingle{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{} \{ .j \}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. marks end J code for pandoc}
\NormalTok{MARKDOWNTAIL}\AlertTok{=:}\index{MARKDOWNTAIL@\texttt{MARKDOWNTAIL}} \StringTok{\textquotesingle{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textasciitilde{}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. temporary markdown file}
\NormalTok{MARKDOWNTMP}\AlertTok{=:}\index{MARKDOWNTMP@\texttt{MARKDOWNTMP}} \StringTok{\textquotesingle{}jltemp.markdown\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. root words (ROOTWORDSjodliterate) group}
\NormalTok{ROOTWORDSjodliterate}\AlertTok{=:}\index{ROOTWORDSjodliterate@\texttt{ROOTWORDSjodliterate}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \StringTok{\textquotesingle{} IFACEWORDSjodliterate ROOTWORDSjodliterate grplit sbtokens setjodliterate\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. full pandoc executable path {-} use pandoc only if on shell path}
\hypertarget{THISPANDOC}{\NormalTok{THISPANDOC}}\AlertTok{=:}\index{THISPANDOC@\texttt{THISPANDOC}} \StringTok{\textquotesingle{}"C:\textbackslash{}Program Files\textbackslash{}Pandoc\textbackslash{}pandoc"\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. white space characters}
\NormalTok{WHITESPACE}\AlertTok{=:}\index{WHITESPACE@\texttt{WHITESPACE}} \DecValTok{10} \DecValTok{13} \DecValTok{9} \DecValTok{32}\KeywordTok{\{a.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{WRAPLEAD}\AlertTok{=:}\index{WRAPLEAD@\texttt{WRAPLEAD}} \StringTok{\textquotesingle{}>..>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. maximum number of code listing characters {-} adjust for given LaTeX pagesize}
\NormalTok{WRAPLIMIT}\AlertTok{=:}\index{WRAPLIMIT@\texttt{WRAPLIMIT}} \DecValTok{110}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. invalid j string starting wrapped line {-} exclude \textquotesingle{}=:\textquotesingle{} {-} trailing blank matters}
\NormalTok{WRAPPREFIX}\AlertTok{=:}\index{WRAPPREFIX@\texttt{WRAPPREFIX}} \StringTok{\textquotesingle{})=.)=. \textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB.  pandoc LaTeX fragment from (WRAPPREFIX) {-} these strings must correspond}
\NormalTok{WRAPPREFIXTEX}\AlertTok{=:}\index{WRAPPREFIXTEX@\texttt{WRAPPREFIXTEX}} \StringTok{\textquotesingle{}\textbackslash{}RegionMarkerTok\{)\}\textbackslash{}KeywordTok\{=.\}\textbackslash{}RegionMarkerTok\{)\}\textbackslash{}KeywordTok\{=.\}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. retains string after first occurrence of (x)}
\NormalTok{afterstr}\AlertTok{=:}\index{afterstr@\texttt{afterstr}} \KeywordTok{]} \KeywordTok{\}.\textasciitilde{}} \KeywordTok{\#@[} \KeywordTok{+} \DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{i.\textasciitilde{}}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{[} \KeywordTok{E.} \KeywordTok{]}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. trims all leading and trailing blanks}
\NormalTok{alltrim}\AlertTok{=:}\index{alltrim@\texttt{alltrim}} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{[:} \RegionMarkerTok{(}\KeywordTok{*./\textbackslash{}.} \KeywordTok{+.} \KeywordTok{*./\textbackslash{}}\RegionMarkerTok{)} \StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{\&=}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. retains string before first occurrence of (x)}
\NormalTok{beforestr}\AlertTok{=:}\index{beforestr@\texttt{beforestr}} \KeywordTok{]} \KeywordTok{\{.\textasciitilde{}} \DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{i.\textasciitilde{}}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{[} \KeywordTok{E.} \KeywordTok{]}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{betweenstrs}\AlertTok{=:}\index{betweenstrs@\texttt{betweenstrs}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*betweenstrs v{-}{-} select sublists between  nonnested delimiters}
\CommentTok{NB. discarding delimiters.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  blcl =. (clStart;clEnd) betweenstrs cl}
\CommentTok{NB.        blnl =. (nlStart;nlEnd) betweenstrs nl}
\CommentTok{NB.}
\CommentTok{NB.   (\textquotesingle{}start\textquotesingle{};\textquotesingle{}end\textquotesingle{}) betweenstrs \textquotesingle{}start yada yada end boo hoo start ahh end\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. also applies to numeric delimiters}
\CommentTok{NB.   (1 1;2 2) betweenstrs 1 1 66 666 2 2 7 87 1 1 0 2 2}

\StringTok{\textquotesingle{}s e\textquotesingle{}}\KeywordTok{=.} \KeywordTok{x}
\NormalTok{llst}\KeywordTok{=.} \RegionMarkerTok{((}\KeywordTok{{-}\#}\NormalTok{s}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{|.!.}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ s }\KeywordTok{E.} \KeywordTok{y}\RegionMarkerTok{)} \KeywordTok{+.}\NormalTok{ e }\KeywordTok{E.} \KeywordTok{y}
\NormalTok{mask}\KeywordTok{=.} \KeywordTok{\textasciitilde{}:/\textbackslash{}}\NormalTok{ llst}
\RegionMarkerTok{(}\NormalTok{mask}\KeywordTok{\#}\NormalTok{llst}\RegionMarkerTok{)} \KeywordTok{<;.}\DecValTok{1}\NormalTok{ mask}\KeywordTok{\#y}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. boxes open nouns}
\NormalTok{boxopen}\AlertTok{=:}\index{boxopen@\texttt{boxopen}} \KeywordTok{<\^{}:}\RegionMarkerTok{(}\KeywordTok{L.} \KeywordTok{=} \KeywordTok{0:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{changestr}\AlertTok{=:}\index{changestr@\texttt{changestr}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*changestr v{-}{-} replaces substrings {-} see long documentation.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  clReps changestr cl}
\CommentTok{NB.}
\CommentTok{NB.   NB. first character delimits replacements}
\CommentTok{NB.   \textquotesingle{}/change/becomes/me/ehh\textquotesingle{} changestr \textquotesingle{}blah blah ...\textquotesingle{}}

\NormalTok{pairs}\KeywordTok{=.} \DecValTok{2} \KeywordTok{\{."}\RegionMarkerTok{(}\DecValTok{1}\RegionMarkerTok{)} \DecValTok{\_2} \KeywordTok{[\textbackslash{}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \KeywordTok{x}      \CommentTok{NB. change table}
\NormalTok{cnt}\KeywordTok{=.}\NormalTok{\_}\DecValTok{1} \KeywordTok{[}\NormalTok{ lim}\KeywordTok{=.} \KeywordTok{\#}\NormalTok{ pairs}
\KeywordTok{while.}\NormalTok{ lim }\KeywordTok{>}\NormalTok{ cnt}\KeywordTok{=.>:}\NormalTok{cnt }\KeywordTok{do.}         \CommentTok{NB. process each change pair}
  \StringTok{\textquotesingle{}t c\textquotesingle{}}\KeywordTok{=.}\NormalTok{ cnt }\KeywordTok{\{}\NormalTok{ pairs               }\CommentTok{NB. /target/change}
  \KeywordTok{if.} \KeywordTok{+./}\NormalTok{b}\KeywordTok{=.}\NormalTok{ t }\KeywordTok{E.} \KeywordTok{y} \KeywordTok{do.}             \CommentTok{NB. next if no target}
\NormalTok{    r}\KeywordTok{=.} \KeywordTok{I.}\NormalTok{ b                        }\CommentTok{NB. target starts}
    \StringTok{\textquotesingle{}l q\textquotesingle{}}\KeywordTok{=.} \KeywordTok{\#\&>}\NormalTok{ cnt }\KeywordTok{\{}\NormalTok{ pairs         }\CommentTok{NB. lengths}
\NormalTok{    p}\KeywordTok{=.}\NormalTok{ r }\KeywordTok{+} \DecValTok{0}\KeywordTok{,+/\textbackslash{}}\RegionMarkerTok{(}\KeywordTok{<:\#}\NormalTok{ r}\RegionMarkerTok{)}\KeywordTok{$}\NormalTok{ d}\KeywordTok{=.}\NormalTok{ q }\KeywordTok{{-}}\NormalTok{ l }\CommentTok{NB. change starts}
\NormalTok{    s}\KeywordTok{=.} \KeywordTok{*}\NormalTok{ d                         }\CommentTok{NB. reduce < and > to =}
    \KeywordTok{if.}\NormalTok{ s }\KeywordTok{=} \DecValTok{\_1} \KeywordTok{do.}
\NormalTok{      b}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\#\textasciitilde{}} \KeywordTok{\#}\NormalTok{ b}
\NormalTok{      b}\KeywordTok{=.} \RegionMarkerTok{((}\NormalTok{l }\KeywordTok{*} \KeywordTok{\#}\NormalTok{ r}\RegionMarkerTok{)}\KeywordTok{$} \DecValTok{1} \DecValTok{0} \KeywordTok{\#\textasciitilde{}}\NormalTok{ q}\KeywordTok{,}\NormalTok{l}\KeywordTok{{-}}\NormalTok{q}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{,}\NormalTok{r }\KeywordTok{+/} \KeywordTok{i.}\NormalTok{ l}\RegionMarkerTok{)}\KeywordTok{\}}\NormalTok{ b}
      \KeywordTok{y=.}\NormalTok{ b }\KeywordTok{\#} \KeywordTok{y}
      \KeywordTok{if.}\NormalTok{ q }\KeywordTok{=} \DecValTok{0} \KeywordTok{do.} \KeywordTok{continue.} \KeywordTok{end.}  \CommentTok{NB. next for deletions}
    \KeywordTok{elseif.}\NormalTok{ s }\KeywordTok{=} \DecValTok{1} \KeywordTok{do.}
      \KeywordTok{y=.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \KeywordTok{>:}\NormalTok{ d r}\KeywordTok{\}}\NormalTok{ b            }\CommentTok{NB. first target char replicated}
    \KeywordTok{end.}
    \KeywordTok{y=.}\RegionMarkerTok{(}\NormalTok{c }\KeywordTok{$\textasciitilde{}}\NormalTok{ q }\KeywordTok{*\#}\NormalTok{ r}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{,}\NormalTok{p }\KeywordTok{+/i.}\NormalTok{ q}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}  \CommentTok{NB. insert replacements}
  \KeywordTok{end.}
\KeywordTok{end.} \KeywordTok{y}                              \CommentTok{NB. altered string}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. character table to newline delimited list}
\NormalTok{ctl}\AlertTok{=:}\index{ctl@\texttt{ctl}} \KeywordTok{\}.@}\RegionMarkerTok{(}\KeywordTok{,@}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{,"}\DecValTok{1}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{{-}.@}\RegionMarkerTok{(}\KeywordTok{*./\textbackslash{}."}\DecValTok{1}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{=\&}\StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{@]}\RegionMarkerTok{))))} \KeywordTok{\#} \KeywordTok{,@}\RegionMarkerTok{((}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{,"}\DecValTok{1}\RegionMarkerTok{)}\KeywordTok{@]}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cutnestidx}\AlertTok{=:}\index{cutnestidx@\texttt{cutnestidx}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*cutnestidx v{-}{-} cut list into nested runs and other.}
\CommentTok{NB.}
\CommentTok{NB. Nested runs are delimited by begin and end tags. This verb is}
\CommentTok{NB. oriented toward XML parsing where typical begin  end tags are}
\CommentTok{NB. <ul>  </ul>  and tags  with  attributes  like: <hoo  boy="2">}
\CommentTok{NB. </hoo>}
\CommentTok{NB.}
\CommentTok{NB. This verb can process numeric lists but care must be taken to}
\CommentTok{NB. insure the pad item (1\{.0$y) does  not  match begin  and  end}
\CommentTok{NB. values.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  (ilIdx ;< blcl) =. (clStart;clEnd) cutnestidx cl}
\CommentTok{NB.        (ilIdx ;< blnl) =. (nlStart;nlEnd) cutnestidx nl}
\CommentTok{NB.}
\CommentTok{NB.   xml=. \textquotesingle{}yada <ol><li>one</li><ol><li>sub one</li></ol></ol> boo\textquotesingle{}}
\CommentTok{NB.   (\textquotesingle{}<ol\textquotesingle{};\textquotesingle{}</ol>\textquotesingle{}) cutnestidx xml}
\CommentTok{NB.}
\CommentTok{NB.   88 99 cutnestidx (i.5),88,(10?10),99 88 5 5 5 5 5 99}

\KeywordTok{if.} \KeywordTok{\#y} \KeywordTok{do.}
  \StringTok{\textquotesingle{}s e\textquotesingle{}}\KeywordTok{=.} \KeywordTok{,\&.>} \KeywordTok{x}                \CommentTok{NB. start end lists}
\NormalTok{  ut}\KeywordTok{=.} \DecValTok{1}\KeywordTok{\{.}\DecValTok{0}\KeywordTok{$y}                   \CommentTok{NB. padding}
  \KeywordTok{assert.} \KeywordTok{{-}.}\NormalTok{s }\KeywordTok{{-}:}\NormalTok{ e              }\CommentTok{NB. they must differ}
  \KeywordTok{assert.} \KeywordTok{{-}.}\RegionMarkerTok{(}\NormalTok{s }\KeywordTok{{-}:}\NormalTok{ut}\RegionMarkerTok{)} \KeywordTok{+.}\NormalTok{ e}\KeywordTok{{-}:}\NormalTok{ut}
\NormalTok{  sp}\KeywordTok{=.}\NormalTok{ s }\KeywordTok{E.}\NormalTok{ ut}\KeywordTok{=.y,}\NormalTok{ut            }\CommentTok{NB. start mask}

  \CommentTok{NB. quit if no delimiters}
  \KeywordTok{if.} \KeywordTok{{-}.}\DecValTok{1} \KeywordTok{e.}\NormalTok{ sp }\KeywordTok{do.} \RegionMarkerTok{(}\KeywordTok{i.}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{;<<y} \KeywordTok{return.} \KeywordTok{end.}

\NormalTok{  ep}\KeywordTok{=.}\NormalTok{ e }\KeywordTok{E.}\NormalTok{ ut                  }\CommentTok{NB. end mask}
  \KeywordTok{assert.} \RegionMarkerTok{(}\KeywordTok{+/}\NormalTok{sp}\RegionMarkerTok{)} \KeywordTok{=} \KeywordTok{+/}\NormalTok{ep         }\CommentTok{NB. basic balance}
\NormalTok{  dp}\KeywordTok{=.}\NormalTok{ sp }\KeywordTok{+} \KeywordTok{{-}}\NormalTok{ ep                }\CommentTok{NB. start end marks}
  \KeywordTok{assert.} \DecValTok{0} \KeywordTok{*./} \KeywordTok{.} \KeywordTok{<:} \KeywordTok{+/\textbackslash{}}\NormalTok{ dp     }\CommentTok{NB. nested balance}
\NormalTok{  ep}\KeywordTok{=.} \KeywordTok{I.} \DecValTok{\_1}\KeywordTok{=}\NormalTok{dp }\KeywordTok{[}\NormalTok{ sp}\KeywordTok{=.} \KeywordTok{I.} \DecValTok{1}\KeywordTok{=}\NormalTok{dp  }\CommentTok{NB. start end indexes}
\NormalTok{  ut}\KeywordTok{=.} \KeywordTok{+/\textbackslash{}}\NormalTok{dp }\KeywordTok{{-}.} \DecValTok{0}               \CommentTok{NB. scanned marks}
\NormalTok{  dp}\KeywordTok{=.} \KeywordTok{/:\textasciitilde{}}\NormalTok{ sp}\KeywordTok{,}\NormalTok{ep                }\CommentTok{NB. all indexes}
\NormalTok{  sp}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{firstones }\DecValTok{1}\KeywordTok{<:}\NormalTok{ut}\RegionMarkerTok{)}\KeywordTok{\#}\NormalTok{dp     }\CommentTok{NB. starts of nested}
\NormalTok{  ep}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{\#}\NormalTok{e}\RegionMarkerTok{)}\KeywordTok{+}\RegionMarkerTok{(}\DecValTok{0}\KeywordTok{=}\NormalTok{ut}\RegionMarkerTok{)}\KeywordTok{\#}\NormalTok{dp           }\CommentTok{NB. starts of other}
\NormalTok{  dp}\KeywordTok{=.} \KeywordTok{/:\textasciitilde{}} \KeywordTok{\textasciitilde{}.}\DecValTok{0}\KeywordTok{,}\NormalTok{sp}\KeywordTok{,}\NormalTok{ep            }\CommentTok{NB. cut starts}
\NormalTok{  ut}\KeywordTok{=.} \KeywordTok{\}:} \DecValTok{1}\NormalTok{ dp}\KeywordTok{\}} \RegionMarkerTok{(}\KeywordTok{>:\#y}\RegionMarkerTok{)}\KeywordTok{\#}\DecValTok{0}        \CommentTok{NB. cut mask}
  \RegionMarkerTok{(}\NormalTok{dp }\KeywordTok{i.}\NormalTok{ sp}\RegionMarkerTok{)}\KeywordTok{;<}\NormalTok{ut }\KeywordTok{<;.}\DecValTok{1} \KeywordTok{y}         \CommentTok{NB. nest indexes cut list}
\KeywordTok{else.}
  \RegionMarkerTok{(}\KeywordTok{i.}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{;<<y}                     \CommentTok{NB. empty arg result}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. double quotes {-} doubles internal " quotes like (quote)}
\NormalTok{dbquote}\AlertTok{=:}\index{dbquote@\texttt{dbquote}} \StringTok{\textquotesingle{}"\textquotesingle{}}\KeywordTok{\&,@}\RegionMarkerTok{(}\KeywordTok{,\&}\StringTok{\textquotesingle{}"\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{\#\textasciitilde{}} \KeywordTok{>:@}\RegionMarkerTok{(}\KeywordTok{=\&}\StringTok{\textquotesingle{}"\textquotesingle{}}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. quote unquoted strings containing blanks: dbquoteuq \textquotesingle{}c:\textbackslash{}blanks in\textbackslash{}paths bitch\textquotesingle{}}
\NormalTok{dbquoteuq}\AlertTok{=:}\index{dbquoteuq@\texttt{dbquoteuq}} \KeywordTok{]\textasciigrave{}}\NormalTok{dbquote}\KeywordTok{@.}\RegionMarkerTok{((}\KeywordTok{[:} \KeywordTok{{-}.} \StringTok{\textquotesingle{}""\textquotesingle{}}\KeywordTok{\&{-}:@}\RegionMarkerTok{(}\KeywordTok{\{:} \KeywordTok{,} \KeywordTok{\{.}\RegionMarkerTok{))} \KeywordTok{*.} \StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{e.} \KeywordTok{]}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{decomm}\AlertTok{=:}\index{decomm@\texttt{decomm}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*decomm v{-}{-}  removes comments  from j words. The (x) argument}
\CommentTok{NB. specifies whether all blank lines are removed or retained.}
\CommentTok{NB.}
\CommentTok{NB. monad:  decomm ctWord}
\CommentTok{NB.}
\CommentTok{NB.   decomm jcr \textquotesingle{}decomm\textquotesingle{}  NB. decomment self}
\CommentTok{NB.}
\CommentTok{NB. dyad:  pa decomm ctWord}
\CommentTok{NB.}
\CommentTok{NB.   1 decomm jcr \textquotesingle{}decomm\textquotesingle{}  NB. remove blanks (default)}
\CommentTok{NB.   0 decomm jcr \textquotesingle{}decomm\textquotesingle{}  NB. retain all blank lines}

\DecValTok{1}\NormalTok{ decomm }\KeywordTok{y}
\KeywordTok{:}
\CommentTok{NB. mask of unquoted comment starts}
\NormalTok{c}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{$y}\RegionMarkerTok{)}\KeywordTok{$}\StringTok{\textquotesingle{}NB.\textquotesingle{}} \KeywordTok{E.} \KeywordTok{,y}
\NormalTok{c}\KeywordTok{=.} \KeywordTok{+./\textbackslash{}"}\DecValTok{1}\NormalTok{ c }\KeywordTok{>} \KeywordTok{\textasciitilde{}:/\textbackslash{}"}\DecValTok{1} \KeywordTok{y} \KeywordTok{e.} \StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}

\CommentTok{NB. ,, work around for j8.05 bug {-} remove when fixed}
\KeywordTok{y=.} \KeywordTok{,,y}

\CommentTok{NB. blank out comments}
\KeywordTok{y=.} \StringTok{\textquotesingle{} \textquotesingle{}} \RegionMarkerTok{(}\KeywordTok{I.} \KeywordTok{,}\NormalTok{c}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}
\KeywordTok{y=.} \KeywordTok{y} \KeywordTok{$\textasciitilde{}} \KeywordTok{$}\NormalTok{c}

\CommentTok{NB. remove blank lines {-} default}
\KeywordTok{if.} \KeywordTok{x} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \KeywordTok{y} \KeywordTok{+./} \KeywordTok{.} \KeywordTok{\textasciitilde{}:} \StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. boxes UTF8 names}
\NormalTok{fboxname}\AlertTok{=:}\index{fboxname@\texttt{fboxname}} \RegionMarkerTok{(}\KeywordTok{[:} \KeywordTok{<} \DecValTok{8} \KeywordTok{u:} \KeywordTok{>}\RegionMarkerTok{)} \KeywordTok{::]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. erase files {-} cl | blcl of path file names}
\NormalTok{ferase}\AlertTok{=:}\index{ferase@\texttt{ferase}} \DecValTok{1}\KeywordTok{!:}\DecValTok{55} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_1:}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\NormalTok{fboxname}\KeywordTok{\&>}\RegionMarkerTok{)}\KeywordTok{@}\NormalTok{boxopen}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if file exists 0 otherwise}
\NormalTok{fexist}\AlertTok{=:}\index{fexist@\texttt{fexist}} \KeywordTok{1:@}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{!:}\DecValTok{4}\RegionMarkerTok{)} \KeywordTok{::0:@}\RegionMarkerTok{(}\NormalTok{fboxname}\KeywordTok{\&>}\RegionMarkerTok{)}\KeywordTok{@}\NormalTok{boxopen}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 0\textquotesingle{}s all but first 1 in runs of 1\textquotesingle{}s {-} like (firstone) but differs for nulls}
\NormalTok{firstones}\AlertTok{=:}\index{firstones@\texttt{firstones}} \KeywordTok{>} \RegionMarkerTok{(}\KeywordTok{0:} \KeywordTok{,} \KeywordTok{\}:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{formifacetex}\AlertTok{=:}\index{formifacetex@\texttt{formifacetex}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*formifacetex v{-}{-} formats hyperlinked and highlighted interface words.}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl =. formifacetex blclIwords}

\CommentTok{NB. jod refs !(*)=. get}
\NormalTok{head}\KeywordTok{=.} \StringTok{\textquotesingle{}\textbackslash{}begin\{Shaded\}\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\StringTok{\textquotesingle{}\textbackslash{}begin\{Highlighting\}[]\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}
\NormalTok{tail}\KeywordTok{=.} \StringTok{\textquotesingle{}\textbackslash{}end\{Highlighting\}\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\StringTok{\textquotesingle{}\textbackslash{}end\{Shaded\}\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}
\NormalTok{ctok}\KeywordTok{=.} \StringTok{\textquotesingle{}\textbackslash{}CommentTok\{\textquotesingle{}}
\NormalTok{ntok}\KeywordTok{=.} \StringTok{\textquotesingle{}\textbackslash{}NormalTok\{\textquotesingle{}}
\NormalTok{href}\KeywordTok{=.} \StringTok{\textquotesingle{}\textbackslash{}hyperlink\{\textquotesingle{}}

\CommentTok{NB. fetch current short descriptions}
\StringTok{\textquotesingle{}rc tab\textquotesingle{}}\KeywordTok{=.} \DecValTok{0} \DecValTok{8}\NormalTok{ get }\KeywordTok{y}
\NormalTok{words}\KeywordTok{=.} \DecValTok{0} \KeywordTok{\{"}\DecValTok{1}\NormalTok{ tab}
\NormalTok{desc}\KeywordTok{=.}  \DecValTok{1} \KeywordTok{\{"}\DecValTok{1}\NormalTok{ tab}

\CommentTok{NB. set hyperlinks on words {-} colors on comments}
\NormalTok{words}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{href}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ words }\KeywordTok{,\&.>} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}\}\{\textquotesingle{}}\KeywordTok{,}\NormalTok{ntok}\RegionMarkerTok{)} \KeywordTok{,\&.>} \RegionMarkerTok{(}\KeywordTok{<"}\DecValTok{1} \RegionMarkerTok{(}\KeywordTok{>}\NormalTok{words}\RegionMarkerTok{)}\KeywordTok{,"}\DecValTok{1} \StringTok{\textquotesingle{} \textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>} \KeywordTok{<}\StringTok{\textquotesingle{}\}\}\textquotesingle{}}
\NormalTok{desc}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{ctok}\RegionMarkerTok{)} \KeywordTok{,\&.>} \RegionMarkerTok{(}\NormalTok{alltrim}\KeywordTok{\&.>}\NormalTok{ desc}\RegionMarkerTok{)} \KeywordTok{,\&.>} \StringTok{\textquotesingle{}\}\textquotesingle{}}
\NormalTok{tex}\KeywordTok{=.} \KeywordTok{;}\NormalTok{words }\KeywordTok{,\&.>}\NormalTok{ desc }\KeywordTok{,\&.>}\NormalTok{ LF}
\NormalTok{head}\KeywordTok{,}\NormalTok{tex}\KeywordTok{,}\NormalTok{tail}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{formtexindexes}\AlertTok{=:}\index{formtexindexes@\texttt{formtexindexes}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*formtexindexes v{-}{-} format latex index commands from global marks.}
\CommentTok{NB.}
\CommentTok{NB. monad:  blcl =. formtexindexes blclMarked}

\CommentTok{NB. extract =:=: =.=. marked text}
\NormalTok{inames}\KeywordTok{=.} \KeywordTok{;@}\RegionMarkerTok{(}\StringTok{\textquotesingle{}\{\}\textquotesingle{}}\KeywordTok{\&}\NormalTok{betweenstrs}\RegionMarkerTok{)}\KeywordTok{\&.>} \RegionMarkerTok{(}\KeywordTok{{-}\#}\NormalTok{ENDINDEX}\RegionMarkerTok{)} \KeywordTok{\}.\&.>} \RegionMarkerTok{(}\KeywordTok{\#}\NormalTok{BEGININDEX}\RegionMarkerTok{)} \KeywordTok{\}.\&.>} \KeywordTok{y}

\CommentTok{NB. find any indirect ()=: and multiple \textquotesingle{}\textquotesingle{}=: assignments}
\StringTok{\textquotesingle{}pma pia\textquotesingle{}}\KeywordTok{=.} \KeywordTok{I.\&.>} \KeywordTok{<"}\DecValTok{1} \StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{})\textquotesingle{}} \KeywordTok{=/} \KeywordTok{\{:@}\RegionMarkerTok{(}\KeywordTok{{-}.\&}\StringTok{\textquotesingle{} \textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{\&>}\NormalTok{ inames}

\CommentTok{NB. form latex index commands}
\NormalTok{indexes}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}\textbackslash{}AlertTok\{=:\}\textbackslash{}index\{\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ inames }\KeywordTok{,\&.>} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}@\textbackslash{}texttt\{\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ inames }\KeywordTok{,\&.>} \KeywordTok{<}\StringTok{\textquotesingle{}\}\}\textquotesingle{}}

\CommentTok{NB. replace indirect and multiple assignments with fixed proxies}
\NormalTok{indexes}\KeywordTok{=.} \RegionMarkerTok{((}\KeywordTok{\#}\NormalTok{pma}\RegionMarkerTok{)} \KeywordTok{\#} \KeywordTok{<}\StringTok{\textquotesingle{}\textbackslash{}AlertTok\{=:\}\textbackslash{}index\{00multiple@\textbackslash{}texttt\{\textquotesingle{}\textquotesingle{}...\textquotesingle{}\textquotesingle{}=:\}\}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ pma}\KeywordTok{\}}\NormalTok{ indexes}
\NormalTok{indexes}\KeywordTok{=.} \RegionMarkerTok{((}\KeywordTok{\#}\NormalTok{pia}\RegionMarkerTok{)} \KeywordTok{\#} \KeywordTok{<}\StringTok{\textquotesingle{}\textbackslash{}AlertTok\{=:\}\textbackslash{}index\{01indirect@\textbackslash{}texttt\{(...)=:\}\}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ pia}\KeywordTok{\}}\NormalTok{ indexes}

\CommentTok{NB. adjust j locative chars \_ they give latex indexing grief}
\CommentTok{NB. later versions of pandoc handle this case}
\CommentTok{NB. if. \#pos=. I. \textquotesingle{}\_\textquotesingle{}\&e.\&> indexes do.}
\CommentTok{NB.   indexes=. (\textquotesingle{}\#\_\#\textbackslash{}\_\textquotesingle{}\&changestr\&.> pos\{indexes) pos\} indexes}
\CommentTok{NB. end.}

\NormalTok{indexes}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. size of file in bytes}
\NormalTok{fsize}\AlertTok{=:}\index{fsize@\texttt{fsize}} \DecValTok{1}\KeywordTok{!:}\DecValTok{4} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_1:}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\NormalTok{fboxname}\KeywordTok{\&>}\RegionMarkerTok{)}\KeywordTok{@}\NormalTok{boxopen}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gbodylatex}\AlertTok{=:}\index{gbodylatex@\texttt{gbodylatex}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*gbodylatex v{-}{-} group body latex.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clTex =. gbodylatex clGroupname}

\KeywordTok{if.} \KeywordTok{\#}\NormalTok{mtxt}\KeywordTok{=.}\NormalTok{ markdfrgroup }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ latexfrmarkd mtxt }\KeywordTok{else.} \StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gheadlatex}\AlertTok{=:}\index{gheadlatex@\texttt{gheadlatex}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*gheadlatex v{-}{-} group header latex.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clTex =. gheadlatex clGroupname}

\KeywordTok{if.} \KeywordTok{\#}\NormalTok{mtxt}\KeywordTok{=.}\NormalTok{ markdfrghead }\KeywordTok{y} \KeywordTok{do.}
\NormalTok{  BEGINJODHEADER}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{tlf latexfrmarkd mtxt}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{ENDJODHEADER}\KeywordTok{,}\DecValTok{2}\KeywordTok{\#}\NormalTok{LF}
\KeywordTok{else.}
  \StringTok{\textquotesingle{}\textquotesingle{}}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gpostlatex}\AlertTok{=:}\index{gpostlatex@\texttt{gpostlatex}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*gpostlatex v{-}{-} group post processor latex.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clTex =. gpostlatex clGroupname}

\KeywordTok{if.} \KeywordTok{\#}\NormalTok{mtxt}\KeywordTok{=.}\NormalTok{ markdfrgpost }\KeywordTok{y} \KeywordTok{do.}
\NormalTok{  BEGINJODPOSTP}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{tlf latexfrmarkd mtxt}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{ENDJODPOSTP}
\KeywordTok{else.}
  \StringTok{\textquotesingle{}\textquotesingle{}}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grouplatex}\AlertTok{=:}\index{grouplatex@\texttt{grouplatex}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*grouplatex v{-}{-} group latex with pandoc syntax highlighting.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clTex =. grouplatex clGroupname}
\CommentTok{NB.}
\CommentTok{NB.   NB. requires open JOD dictionary with a \textquotesingle{}jod\textquotesingle{} group}
\CommentTok{NB.   gtex=. grouplatex \textquotesingle{}jod\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  clTex =. paIndex grouplatex clGroupname}
\CommentTok{NB.}
\CommentTok{NB.   0 grouplatex \textquotesingle{}jod\textquotesingle{} NB. do not replace marks with index}

\DecValTok{1}\NormalTok{ grouplatex }\KeywordTok{y}
\KeywordTok{:}
\CommentTok{NB. jod refs !(*)=. badrc\_ajod\_ grp jderr\_ajod\_}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ gnames}\KeywordTok{=.}\NormalTok{ grp }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ gnames }\KeywordTok{return.} \KeywordTok{end.}

\NormalTok{ltx}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{gheadlatex }\KeywordTok{;}\NormalTok{ gbodylatex }\KeywordTok{;}\NormalTok{ gpostlatex}\RegionMarkerTok{)} \KeywordTok{y}
\NormalTok{ltx}\KeywordTok{=.} \KeywordTok{]\textasciigrave{}}\NormalTok{indexgrouptex}\KeywordTok{@.}\RegionMarkerTok{(}\DecValTok{1} \KeywordTok{{-}:} \KeywordTok{x}\RegionMarkerTok{)} \KeywordTok{;}\NormalTok{ tlf}\KeywordTok{\&.>}\NormalTok{ ltx }\KeywordTok{{-}.} \KeywordTok{a:}

\CommentTok{NB. convert wrap marks to LaTeX fragments {-} handle trailing blank first}
\NormalTok{ltx}\KeywordTok{=.} \RegionMarkerTok{(}\StringTok{\textquotesingle{}\#\textquotesingle{}}\KeywordTok{,}\NormalTok{WRAPPREFIXTEX}\KeywordTok{,}\StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{,}\StringTok{\textquotesingle{}\#\textbackslash{}AlertTok\{\textquotesingle{}}\KeywordTok{,}\NormalTok{WRAPLEAD}\KeywordTok{,}\StringTok{\textquotesingle{}\}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ changestr ltx}
\NormalTok{ltx}\KeywordTok{=.} \RegionMarkerTok{(}\StringTok{\textquotesingle{}\#\textquotesingle{}}\KeywordTok{,}\NormalTok{WRAPPREFIXTEX}\KeywordTok{,}\StringTok{\textquotesingle{}\#\textbackslash{}AlertTok\{\textquotesingle{}}\KeywordTok{,}\NormalTok{WRAPLEAD}\KeywordTok{,}\StringTok{\textquotesingle{}\}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ changestr ltx}

\CommentTok{NB. NIMP: the next blank after \textbackslash{}AlertTok should be removed}
\CommentTok{NB. if it\textquotesingle{}s the first blank in a \textbackslash{}NormalTok otherwise the}
\CommentTok{NB. wrap introduces spurious blanks.}

\StringTok{\textquotesingle{}\textbackslash{}section\{\textbackslash{}texttt\{\textquotesingle{}}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{alltrim }\KeywordTok{y}\RegionMarkerTok{)}\KeywordTok{,}\StringTok{\textquotesingle{}\} Source Code\}\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\NormalTok{ltx}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\hypertarget{grplit}{\NormalTok{grplit}}\AlertTok{=:}\index{grplit@\texttt{grplit}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*grplit v{-}{-} make latex for group (y).}
\CommentTok{NB.}
\CommentTok{NB. monad:  (paRc ; blclTeXfiles) =. grplit clGroupname}
\CommentTok{NB.}
\CommentTok{NB.   grplit \textquotesingle{}jodliterate\textquotesingle{}  NB. document self}
\CommentTok{NB.}
\CommentTok{NB. dyad:  (paRc ; blclTeXfiles) =. paOw grplit glGroupname}
\CommentTok{NB.}
\CommentTok{NB.   NB. do not overwrite root tex {-} allows for latex tweaking}
\CommentTok{NB.   0 grplit \textquotesingle{}jodliterate\textquotesingle{}}

\DecValTok{1}\NormalTok{ grplit }\KeywordTok{y}
\KeywordTok{:}
\CommentTok{NB. jod refs !(*)=. badrc\_ajod\_ get grp jderr\_ajod\_ ok\_ajod\_}
\KeywordTok{try.}

\KeywordTok{if.} \DecValTok{3}\KeywordTok{\textasciitilde{}:}\RegionMarkerTok{(}\DecValTok{4}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{<}\StringTok{\textquotesingle{}badrc\_ajod\_\textquotesingle{}} \KeywordTok{do.} \DecValTok{0}\KeywordTok{;}\StringTok{\textquotesingle{}!error: jod is not loaded\textquotesingle{}} \KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.} \DecValTok{0}\KeywordTok{=\#}\NormalTok{JLDIRECTORY  }\KeywordTok{do.} \DecValTok{0}\KeywordTok{;}\StringTok{\textquotesingle{}!error: working directory is not set\textquotesingle{}} \KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. group must exist}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ glist}\KeywordTok{=.}\NormalTok{ GROUP\_ajod}\DecValTok{\_}\NormalTok{ grp group}\KeywordTok{=.} \KeywordTok{y} \KeywordTok{{-}.} \StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{do.}\NormalTok{ glist }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. default overview}
\NormalTok{ohd}\KeywordTok{=.} \RegionMarkerTok{(}\StringTok{\textquotesingle{}/\textasciitilde{}\#\textasciitilde{}group\textasciitilde{}\#\textasciitilde{}/\textquotesingle{}}\KeywordTok{,}\NormalTok{alltrim }\KeywordTok{y}\RegionMarkerTok{)}\NormalTok{ changestr JLOVIEWTEX }\KeywordTok{[}\NormalTok{ gdoc}\KeywordTok{=.} \StringTok{\textquotesingle{}\textquotesingle{}}
\NormalTok{iwords}\KeywordTok{=.}\NormalTok{ ifacewords group}

\CommentTok{NB. overview documents are either markdown/latex group headers or stored LaTeX macros}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ gdoc}\KeywordTok{=.}\NormalTok{ MACRO\_ajod}\DecValTok{\_}\NormalTok{ get group}\KeywordTok{,}\NormalTok{JLOVIEWSUFFIX }\KeywordTok{do.}
  \CommentTok{NB. no stored LaTeX generate LaTeX from group document markdown/latex}
  \KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ gdoc}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{GROUP\_ajod}\DecValTok{\_}\KeywordTok{,}\NormalTok{DOCUMENT\_ajod}\DecValTok{\_}\RegionMarkerTok{)}\NormalTok{ get group }\KeywordTok{do.}\NormalTok{ gdoc }\KeywordTok{return.} \KeywordTok{end.}
  \KeywordTok{if.} \KeywordTok{\#}\NormalTok{gdoc}\KeywordTok{=.} \KeywordTok{;\{:,>}\DecValTok{1}\KeywordTok{\{}\NormalTok{gdoc }\KeywordTok{do.}
\NormalTok{    gdoc}\KeywordTok{=.}\NormalTok{ latexfrmarkd gdoc}
\NormalTok{    ifstr}\KeywordTok{=.}\NormalTok{ ifacesection group}
    \KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{+./}\NormalTok{ifstr }\KeywordTok{E.}\NormalTok{ gdoc}\RegionMarkerTok{)} \KeywordTok{*.} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{IFACEWORDSPFX}\KeywordTok{,}\NormalTok{group}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ glist }\KeywordTok{do.}
\NormalTok{      gdoc}\KeywordTok{=.}\NormalTok{ iwords setifacelinks ifstr}\KeywordTok{;}\NormalTok{gdoc}
    \KeywordTok{end.}
  \KeywordTok{end.}
\KeywordTok{else.}
  \CommentTok{NB. stored macro LaTeX {-} no adjustments}
\NormalTok{  gdoc}\KeywordTok{=.} \KeywordTok{;\{:,>}\DecValTok{1}\KeywordTok{\{}\NormalTok{gdoc}
\KeywordTok{end.}

\CommentTok{NB. root .tex file {-} gets group name}
\NormalTok{wdir}\KeywordTok{=.}\NormalTok{ JLDIRECTORY}
\NormalTok{jlroot}\KeywordTok{=.}\NormalTok{ wdir}\KeywordTok{,}\NormalTok{group}\KeywordTok{,}\StringTok{\textquotesingle{}.tex\textquotesingle{}}
\KeywordTok{if.}\NormalTok{ chroot}\KeywordTok{=.} \KeywordTok{x} \KeywordTok{{-}:} \DecValTok{1} \KeywordTok{do.}
\NormalTok{  root}\KeywordTok{=.} \RegionMarkerTok{(}\StringTok{\textquotesingle{}/\textasciitilde{}\#\textasciitilde{}group\textasciitilde{}\#\textasciitilde{}/\textquotesingle{}}\KeywordTok{,}\NormalTok{group}\RegionMarkerTok{)}\NormalTok{ changestr JLGRPLITTEX}
  \RegionMarkerTok{(}\NormalTok{toJ root}\RegionMarkerTok{)}\NormalTok{ writeas jlroot}
\KeywordTok{end.}

\CommentTok{NB. author title .tex file}
\NormalTok{agstrs}\KeywordTok{=.} \StringTok{\textquotesingle{}/\textasciitilde{}\#\textasciitilde{}author\textasciitilde{}\#\textasciitilde{}/\textquotesingle{}}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{alltrim JLAUTHOR}\RegionMarkerTok{)}\KeywordTok{,}\StringTok{\textquotesingle{}/\textasciitilde{}\#\textasciitilde{}group\textasciitilde{}\#\textasciitilde{}/\textquotesingle{}}\KeywordTok{,}\NormalTok{alltrim }\KeywordTok{y}
\RegionMarkerTok{(}\NormalTok{toJ agstrs changestr JLTITLETEX}\RegionMarkerTok{)}\NormalTok{ writeas jltitle}\KeywordTok{=.}\NormalTok{ wdir}\KeywordTok{,}\NormalTok{group}\KeywordTok{,}\NormalTok{JLTITLEFILE}

\CommentTok{NB. group overview .tex file}
\NormalTok{ohd}\KeywordTok{=.}\NormalTok{ ohd}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\NormalTok{gdoc}
\RegionMarkerTok{(}\NormalTok{toJ ohd}\RegionMarkerTok{)}\NormalTok{ writeas jloview}\KeywordTok{=.}\NormalTok{ wdir}\KeywordTok{,}\NormalTok{group}\KeywordTok{,}\NormalTok{JLOVIEWFILE}

\CommentTok{NB. group build batch script {-} latex utils that compile generated files}
\NormalTok{jlbuildtex}\KeywordTok{=.} \RegionMarkerTok{(}\StringTok{\textquotesingle{}/\textasciitilde{}\#\textasciitilde{}group\textasciitilde{}\#\textasciitilde{}/\textquotesingle{}}\KeywordTok{,}\NormalTok{alltrim }\KeywordTok{y}\RegionMarkerTok{)}\NormalTok{ changestr JLBUILDTEX}
\RegionMarkerTok{(}\NormalTok{toJ jlbuildtex}\RegionMarkerTok{)}\NormalTok{ writeas jlbuildbat}\KeywordTok{=.}\NormalTok{ wdir}\KeywordTok{,}\NormalTok{group}\KeywordTok{,}\StringTok{\textquotesingle{}.bat\textquotesingle{}}

\CommentTok{NB. group source code .tex {-} return file names}
\NormalTok{gltx}\KeywordTok{=.}\NormalTok{ grouplatex group}
\NormalTok{gltx}\KeywordTok{=.}\NormalTok{ iwords setifacetargs gltx}
\RegionMarkerTok{(}\NormalTok{toJ gltx}\RegionMarkerTok{)}\NormalTok{ writeas jlcode}\KeywordTok{=.}\NormalTok{ wdir}\KeywordTok{,}\NormalTok{group}\KeywordTok{,}\NormalTok{JLCODEFILE}
\NormalTok{ok\_ajod}\DecValTok{\_} \RegionMarkerTok{(}\KeywordTok{{-}.}\NormalTok{chroot}\RegionMarkerTok{)} \KeywordTok{\}.}\NormalTok{ jlroot}\KeywordTok{;}\NormalTok{jltitle}\KeywordTok{;}\NormalTok{jloview}\KeywordTok{;}\NormalTok{jlcode}\KeywordTok{;}\NormalTok{jlbuildbat}

\KeywordTok{catchd.}
  \DecValTok{0}\KeywordTok{;}\StringTok{\textquotesingle{}!error: (grplit) failure {-} last J error {-}>\textquotesingle{}}\KeywordTok{;}\DecValTok{13}\KeywordTok{!:}\DecValTok{12} \StringTok{\textquotesingle{}\textquotesingle{}}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\hypertarget{ifacesection}{\NormalTok{ifacesection}}\AlertTok{=:}\index{ifacesection@\texttt{ifacesection}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*ifacesection v{-}{-} interface section summary string.}
\CommentTok{NB.}
\CommentTok{NB. This verb produces the interface section summary  string. For}
\CommentTok{NB. (jodliterate)  to  include an  updated  hyperlinked interface}
\CommentTok{NB. summary it  must find  this string in  generated  latex. Edit}
\CommentTok{NB. this verb if you change the section layout.}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl  =. ifacesection clGroupname}

\StringTok{\textquotesingle{}\textbackslash{}subsection\{\textbackslash{}texttt\{\textquotesingle{}}\KeywordTok{,y,}\StringTok{\textquotesingle{}\} Interface\}\textquotesingle{}}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ifacewords}\AlertTok{=:}\index{ifacewords@\texttt{ifacewords}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*ifacewords v{-}{-} return interface word list.}
\CommentTok{NB.}
\CommentTok{NB. Assume the interface is out of date fetch current  definition}
\CommentTok{NB. from  dictionary.  We  need  the  value   not   the   storage}
\CommentTok{NB. representation so define it in the JOD scratch object.}
\CommentTok{NB.}
\CommentTok{NB. monad:  blcl =. ifacewords clGroupname}

\CommentTok{NB. jod refs !(*)=. get}
\NormalTok{iname}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{IFACEWORDSPFX}\KeywordTok{,y}\RegionMarkerTok{)} \KeywordTok{{-}.} \StringTok{\textquotesingle{} \textquotesingle{}}
\RegionMarkerTok{(}\KeywordTok{;}\NormalTok{SO}\DecValTok{\_\_}\NormalTok{JODobj}\RegionMarkerTok{)}\NormalTok{ get iname}
\NormalTok{iname}\KeywordTok{=.}\NormalTok{ iname}\KeywordTok{,}\StringTok{\textquotesingle{}\_\_SO\_\_JODobj\textquotesingle{}}
\NormalTok{words}\KeywordTok{=.} \KeywordTok{".}\NormalTok{ iname}
\NormalTok{words }\KeywordTok{[} \RegionMarkerTok{(}\DecValTok{4}\KeywordTok{!:}\DecValTok{55}\RegionMarkerTok{)} \KeywordTok{<}\NormalTok{iname}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{indexgrouptex}\AlertTok{=:}\index{indexgrouptex@\texttt{indexgrouptex}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*indexgrouptex v{-}{-} insert index commands in pandoc highlight group latex.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  cl =. clGroupName indexgrouptex clTex}

\StringTok{\textquotesingle{}pos ltx\textquotesingle{}}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{BEGININDEX}\KeywordTok{;}\NormalTok{ENDINDEX}\RegionMarkerTok{)}\NormalTok{ cutnestidx }\KeywordTok{y}
\KeywordTok{if.} \KeywordTok{\#}\NormalTok{pos }\KeywordTok{do.} \KeywordTok{;} \RegionMarkerTok{(}\NormalTok{formtexindexes pos}\KeywordTok{\{}\NormalTok{ltx}\RegionMarkerTok{)}\NormalTok{ pos}\KeywordTok{\}}\NormalTok{ ltx }\KeywordTok{else.} \KeywordTok{y} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. standarizes J path delimiter to unix/linux forward slash}
\NormalTok{jpathsep}\AlertTok{=:}\index{jpathsep@\texttt{jpathsep}} \StringTok{\textquotesingle{}/\textquotesingle{}}\KeywordTok{\&}\RegionMarkerTok{((}\StringTok{\textquotesingle{}\textbackslash{}\textquotesingle{}} \KeywordTok{I.@:=} \KeywordTok{]}\RegionMarkerTok{)}\KeywordTok{\}}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{jtokenize}\AlertTok{=:}\index{jtokenize@\texttt{jtokenize}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*jtokenize v{-}{-} tokenizes j text with (wfl).}
\CommentTok{NB.}
\CommentTok{NB. Similar  to  (;:\&.>)@(<;.2) but preserves  whitespace  and is}
\CommentTok{NB. able to parse invalid j text  containing open quotes. When an}
\CommentTok{NB. open quote  is encountered it is treated like an unterminated}
\CommentTok{NB. string.}
\CommentTok{NB.}
\CommentTok{NB. monad:  blblcl =. jtokenize clJtext}
\CommentTok{NB.}
\CommentTok{NB.   jtokenize 5!:5 <\textquotesingle{}jtokenize\textquotesingle{}}

\NormalTok{ct}\KeywordTok{=.}\NormalTok{ wfl }\KeywordTok{y,}\NormalTok{LF}
\RegionMarkerTok{(}\NormalTok{ct }\KeywordTok{{-}:\&>} \KeywordTok{<,}\NormalTok{LF}\RegionMarkerTok{)} \KeywordTok{<;.}\DecValTok{2}\NormalTok{ ct}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{latexfrmarkd}\AlertTok{=:}\index{latexfrmarkd@\texttt{latexfrmarkd}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*latexfrmarkd v{-}{-} latex from markdown using pandoc.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clTex =. latexfrmarkd clMarkdown}

\CommentTok{NB. require \textquotesingle{}task\textquotesingle{} !(*)=. shell}
\KeywordTok{if.} \KeywordTok{\#y} \KeywordTok{do.}
\NormalTok{  ferase mrktmp}\KeywordTok{=.}\NormalTok{ JLDIRECTORY}\KeywordTok{,}\NormalTok{MARKDOWNTMP}
\NormalTok{  ferase ltxtmp}\KeywordTok{=.}\NormalTok{ JLDIRECTORY}\KeywordTok{,}\NormalTok{LATEXTMP}
  \RegionMarkerTok{(}\NormalTok{toJ }\KeywordTok{y}\RegionMarkerTok{)}\NormalTok{ writeas mrktmp}
  \CommentTok{NB. highlighting style is overridden in latex preamble}
\NormalTok{  shell THISPANDOC}\KeywordTok{,}\StringTok{\textquotesingle{} {-}{-}highlight{-}style=tango \textquotesingle{}}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{dbquoteuq mrktmp}\RegionMarkerTok{)}\KeywordTok{,}\StringTok{\textquotesingle{} {-}o \textquotesingle{}}\KeywordTok{,}\NormalTok{dbquoteuq ltxtmp}
  \KeywordTok{assert.} \DecValTok{0} \KeywordTok{<}\NormalTok{ fsize ltxtmp}
\NormalTok{  tex}\KeywordTok{=.}\NormalTok{ read ltxtmp}
\NormalTok{  tex }\KeywordTok{[}\NormalTok{ ferase ltxtmp }\KeywordTok{[}\NormalTok{ ferase mrktmp}
\KeywordTok{else.}
  \KeywordTok{y}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markdfrghead}\AlertTok{=:}\index{markdfrghead@\texttt{markdfrghead}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markdfrghead v{-}{-} markdown text from group header.}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl =. markdfrghead clGroupname}
\CommentTok{NB.}
\CommentTok{NB.   mtxt=. markdfrghead \textquotesingle{}jod\textquotesingle{}}
\CommentTok{NB.   (toHOST mtxt) write \textquotesingle{}c:/temp/jodhdr.markdown\textquotesingle{}}

\CommentTok{NB. jod refs !(*)=. badrc\_ajod\_ get HEADEND\_ajodmake\_}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ hdr}\KeywordTok{=.} \DecValTok{2}\NormalTok{ get }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ hdr }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.} \DecValTok{0}\KeywordTok{=\#}\NormalTok{hdr}\KeywordTok{=.} \KeywordTok{;}\DecValTok{1}\KeywordTok{\{,>}\DecValTok{1}\KeywordTok{\{}\NormalTok{hdr       }\KeywordTok{do.} \StringTok{\textquotesingle{}\textquotesingle{}}  \KeywordTok{return.} \KeywordTok{end.}
\NormalTok{hdr}\KeywordTok{=.}\NormalTok{ hdr}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\NormalTok{HEADEND\_ajodmake}\DecValTok{\_}

\CommentTok{NB. handle any non j code regions}
\StringTok{\textquotesingle{}idx chd\textquotesingle{}}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{BEGINNOTJ}\KeywordTok{;}\NormalTok{ENDNOTJ}\RegionMarkerTok{)}\NormalTok{ cutnestidx hdr}

\KeywordTok{if.} \KeywordTok{\#}\NormalTok{idx }\KeywordTok{do.}
\NormalTok{  psj}\KeywordTok{=.}\NormalTok{ idx }\KeywordTok{{-}.\textasciitilde{}} \KeywordTok{i.\#}\NormalTok{chd}
\NormalTok{  chd}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{markgnonj}\KeywordTok{\&.>}\NormalTok{ idx}\KeywordTok{\{}\NormalTok{chd}\RegionMarkerTok{)}\NormalTok{ idx}\KeywordTok{\}}\NormalTok{ chd}
\NormalTok{  chd}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{markgassign}\KeywordTok{\&.>}\NormalTok{ psj}\KeywordTok{\{}\NormalTok{chd}\RegionMarkerTok{)}\NormalTok{ psj}\KeywordTok{\}}\NormalTok{ chd}
\NormalTok{  hdr}\KeywordTok{=.} \KeywordTok{;}\NormalTok{chd}
\KeywordTok{else.}
\NormalTok{  hdr}\KeywordTok{=.}\NormalTok{ markgassign hdr}
\KeywordTok{end.}

\KeywordTok{if.} \KeywordTok{\#}\NormalTok{hdr }\KeywordTok{do.}\NormalTok{ markdj hdr }\KeywordTok{else.} \StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markdfrgpost}\AlertTok{=:}\index{markdfrgpost@\texttt{markdfrgpost}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markdfrgpost v{-}{-} markdown from group post processor.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clMarkdown =. markdfrgpost clGroupname}

\CommentTok{NB. jod refs !(*)=. get}
\StringTok{\textquotesingle{}rc post\textquotesingle{}}\KeywordTok{=.}  \DecValTok{2} \KeywordTok{\{.} \DecValTok{4}\NormalTok{ get }\StringTok{\textquotesingle{}POST\_\textquotesingle{}}\KeywordTok{,y} \KeywordTok{{-}.}\StringTok{\textquotesingle{} \textquotesingle{}}
\KeywordTok{if.}\NormalTok{ rc }\KeywordTok{do.}\NormalTok{ markdj markgassign }\KeywordTok{;} \KeywordTok{\{:} \KeywordTok{,}\NormalTok{ post }\KeywordTok{else.} \StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markdfrgroup}\AlertTok{=:}\index{markdfrgroup@\texttt{markdfrgroup}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markdfrgroup v{-}{-} markdown text from group.}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl =. markdfrgrp clGroupname}
\CommentTok{NB.}
\CommentTok{NB.   mtxt=. markdfrgroup \textquotesingle{}jod\textquotesingle{}}
\CommentTok{NB.   (toHOST mtxt) write \textquotesingle{}c:/temp/jcode.markdown\textquotesingle{}}

\CommentTok{NB. jod refs !(*)=. badrc\_ajod\_ get gdeps grp}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ gnl}\KeywordTok{=.}\NormalTok{ grp }\KeywordTok{y}   \KeywordTok{do.}\NormalTok{ gnl }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ gdp}\KeywordTok{=.}\NormalTok{ gdeps }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ gdp }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.} \KeywordTok{\#}\NormalTok{gnl}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{gnl }\KeywordTok{{-}.}\NormalTok{ gdp}\RegionMarkerTok{)} \KeywordTok{{-}.} \KeywordTok{a:} \KeywordTok{do.}\NormalTok{ markdfrwords gnl }\KeywordTok{else.} \StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markdfrwords}\AlertTok{=:}\index{markdfrwords@\texttt{markdfrwords}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markdfrwords v{-}{-} markdown text from word list.}
\CommentTok{NB.}
\CommentTok{NB. This verb takes a  blcl of JOD word names and returns a UTF{-}8}
\CommentTok{NB. encoded cl of  word source  code in markdown format. Markdown}
\CommentTok{NB. is  a simple but versatile  text markup format that is almost}
\CommentTok{NB. ideal for documenting program source code, see:}
\CommentTok{NB.}
\CommentTok{NB. http://daringfireball.net/projects/markdown/}
\CommentTok{NB.}
\CommentTok{NB. monad:  clMarkdown =. markdfrwords blclWords}
\CommentTok{NB.}
\CommentTok{NB.   markdfrwords ;:\textquotesingle{}go ahead mark us up\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. markdown text from JOD group words}
\CommentTok{NB.   mtxt=. markdfrwords \}. grp \textquotesingle{}jod\textquotesingle{}}

\CommentTok{NB. jod refs !(*)=. badrc\_ajod\_ get wttext\_\_MK\_\_JODobj}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ src}\KeywordTok{=.} \DecValTok{0} \DecValTok{10}\NormalTok{ get }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ src }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. commented source code (name,source) table.}
\KeywordTok{if.}\NormalTok{ badrc\_ajod}\DecValTok{\_}\NormalTok{ src}\KeywordTok{=.} \DecValTok{0} \DecValTok{0} \DecValTok{1}\NormalTok{ wttext}\DecValTok{\_\_}\NormalTok{MK}\DecValTok{\_\_}\NormalTok{JODobj }\KeywordTok{>}\DecValTok{1}\KeywordTok{\{}\NormalTok{src }\KeywordTok{do.}\NormalTok{ src}
\KeywordTok{else.}
\NormalTok{  src}\KeywordTok{=.}\NormalTok{ markgassign}\KeywordTok{\&.>} \KeywordTok{\{:"}\DecValTok{1} \KeywordTok{>}\DecValTok{1}\KeywordTok{\{}\NormalTok{src}
  \CommentTok{NB. similar to (markdj) but faster here}
\NormalTok{  utf8 }\KeywordTok{;} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{LF}\KeywordTok{,}\NormalTok{MARKDOWNHEAD}\KeywordTok{,}\NormalTok{LF}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ src }\KeywordTok{,\&.>} \KeywordTok{<}\NormalTok{LF}\KeywordTok{,}\NormalTok{MARKDOWNTAIL}\KeywordTok{,}\NormalTok{LF}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markdj}\AlertTok{=:}\index{markdj@\texttt{markdj}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markdj v{-}{-} mark j code for markdown.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clM =. markdj clJ}

\NormalTok{utf8 }\RegionMarkerTok{(}\NormalTok{LF}\KeywordTok{,}\NormalTok{MARKDOWNHEAD}\KeywordTok{,}\NormalTok{LF}\RegionMarkerTok{)}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{tlf }\KeywordTok{y}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{MARKDOWNTAIL}\KeywordTok{,}\NormalTok{LF}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markgassign}\AlertTok{=:}\index{markgassign@\texttt{markgassign}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markgassign v{-}{-} mark j code for latex indexing.}
\CommentTok{NB.}
\CommentTok{NB. This  verb  tokenizes  j   code  and   replaces  all   global}
\CommentTok{NB. assignments with syntactically incorrect j strings that  will}
\CommentTok{NB. be transformed by pandoc into  easily located  latex  strings}
\CommentTok{NB. that will then be  converted by a post pandoc processor  into}
\CommentTok{NB. valid  latex  index commands. This works  because regex based}
\CommentTok{NB. pandoc coloring does not "understand" j\textquotesingle{}s parsing rules.}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl =. markgassign clJcode}
\CommentTok{NB.}
\CommentTok{NB.  jcode=. \textquotesingle{}markgassign=:\textquotesingle{} , 5!:5 <\textquotesingle{}markgassign\textquotesingle{}}
\CommentTok{NB.  markgassign jcode}

\KeywordTok{if.} \DecValTok{0}\KeywordTok{=\#}\NormalTok{jcode}\KeywordTok{=.} \KeywordTok{y} \KeywordTok{{-}.}\NormalTok{ CR }\KeywordTok{do.} \KeywordTok{y} \KeywordTok{return.} \KeywordTok{end.}
\NormalTok{jcode}\KeywordTok{=.}\NormalTok{ WRAPLIMIT wrapvrblong jcode}
\NormalTok{jtokens}\KeywordTok{=.}\NormalTok{ jtokenize jcode}

\CommentTok{NB. only interested in global assignment lines}
\KeywordTok{if.} \KeywordTok{\#}\NormalTok{gix}\KeywordTok{=.} \KeywordTok{I.} \KeywordTok{;} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}=:\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{e.} \KeywordTok{L:} \DecValTok{1}\NormalTok{ jtokens }\KeywordTok{do.}
\NormalTok{  jgl}\KeywordTok{=.}\NormalTok{ gix}\KeywordTok{\{}\NormalTok{jtokens}
\NormalTok{  jshp}\KeywordTok{=.} \KeywordTok{$}\NormalTok{jat}\KeywordTok{=.} \KeywordTok{>}\NormalTok{jgl}
\NormalTok{  jix}\KeywordTok{=.} \KeywordTok{I.}\NormalTok{ jat }\KeywordTok{=} \KeywordTok{<}\StringTok{\textquotesingle{}=:\textquotesingle{}} \KeywordTok{[}\NormalTok{ jat}\KeywordTok{=.} \KeywordTok{,}\NormalTok{jat}
  \CommentTok{NB. extract global assignments}
  \CommentTok{NB. ignoring interleaving blanks}
\NormalTok{  jat2}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{jat }\KeywordTok{{-}.\&.>} \StringTok{\textquotesingle{} \textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{{-}.} \KeywordTok{a:}
\NormalTok{  anames}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<:I.}\RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}=:\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{{-}:\&>}\NormalTok{ jat2}\RegionMarkerTok{)}\KeywordTok{\{}\NormalTok{jat2}
  \CommentTok{NB. (0\{FAKETOKENS) and (1\{FAKETOKENS) are invalid in j}
\NormalTok{  faketoks}\KeywordTok{=.} \RegionMarkerTok{(}\DecValTok{0}\KeywordTok{\{}\NormalTok{FAKETOKENS}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ anames }\KeywordTok{,\&.>} \DecValTok{1}\KeywordTok{\{}\NormalTok{FAKETOKENS}
\NormalTok{  jat}\KeywordTok{=.} \KeywordTok{<"}\DecValTok{1}\NormalTok{ jshp }\KeywordTok{$}\NormalTok{ faketoks jix}\KeywordTok{\}}\NormalTok{ jat}
\NormalTok{  jat}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{\#\&>}\NormalTok{ jgl}\RegionMarkerTok{)} \KeywordTok{\{.\&.>}\NormalTok{ jat}
  \CommentTok{NB. adjust last LF}
  \RegionMarkerTok{(}\KeywordTok{{-}}\NormalTok{LF}\KeywordTok{=\{:y}\RegionMarkerTok{)} \KeywordTok{\}.} \KeywordTok{;;}\NormalTok{jat gix}\KeywordTok{\}}\NormalTok{ jtokens}
\KeywordTok{else.}
  \KeywordTok{y}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markgnonj}\AlertTok{=:}\index{markgnonj@\texttt{markgnonj}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markgnonj v{-}{-} mark non j code region global assignments.}
\CommentTok{NB.}
\CommentTok{NB. Non J code is often inserted in J scripts as  character nouns}
\CommentTok{NB. using explicit  multi{-}line  \textquotesingle{}0 :  0\textquotesingle{}  definitions. This  verb}
\CommentTok{NB. marks the assigned noun name. Only \textquotesingle{}=: 0 :  0\textquotesingle{} will be  found}
\CommentTok{NB. and marked.}
\CommentTok{NB.}
\CommentTok{NB. verbatim:}
\CommentTok{NB.}
\CommentTok{NB. IamFound =: 0 : 0}
\CommentTok{NB. .... non j code ...}
\CommentTok{NB. )}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl =. markgnonj clNonj}

\NormalTok{ct}\KeywordTok{=.}  \KeywordTok{<;.}\DecValTok{2}\NormalTok{ tlf }\KeywordTok{y}
\NormalTok{mrk}\KeywordTok{=.} \StringTok{\textquotesingle{}=:0:0\textquotesingle{}}
\NormalTok{pos}\KeywordTok{=.} \KeywordTok{I.}\NormalTok{ mrk}\KeywordTok{\&{-}:\&>} \RegionMarkerTok{(}\KeywordTok{{-}\#}\NormalTok{mrk}\RegionMarkerTok{)}\KeywordTok{\&\{.\&.>}\NormalTok{ ct }\KeywordTok{{-}.\&.>} \KeywordTok{<}\NormalTok{WHITESPACE}
\NormalTok{ct}\KeywordTok{=.} \KeywordTok{;}\RegionMarkerTok{(}\NormalTok{LF }\KeywordTok{,\&.>\textasciitilde{}}\NormalTok{ markgassign}\KeywordTok{\&.>}\NormalTok{ pos}\KeywordTok{\{}\NormalTok{ct}\RegionMarkerTok{)}\NormalTok{ pos}\KeywordTok{\}}\NormalTok{ ct}
\RegionMarkerTok{(}\KeywordTok{{-}}\NormalTok{LF}\KeywordTok{=\{:y}\RegionMarkerTok{)} \KeywordTok{\}.}\NormalTok{ ct}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. reads a file as a list of bytes}
\NormalTok{read}\AlertTok{=:}\index{read@\texttt{read}} \DecValTok{1}\KeywordTok{!:}\DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{]\textasciigrave{}<@.}\RegionMarkerTok{(}\DecValTok{32}\KeywordTok{\&>@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. trim right (trailing) blanks}
\NormalTok{rtrim}\AlertTok{=:}\index{rtrim@\texttt{rtrim}} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{[:} \KeywordTok{*./\textbackslash{}.} \StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{=} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. blcl of nonempty noncomment J cl tokens}
\NormalTok{sbtokens}\AlertTok{=:}\index{sbtokens@\texttt{sbtokens}} \KeywordTok{a:} \KeywordTok{{-}.\textasciitilde{}} \RegionMarkerTok{(}\KeywordTok{<}\DecValTok{13} \DecValTok{10} \DecValTok{9}\KeywordTok{\{a.}\RegionMarkerTok{)} \KeywordTok{{-}.\&.>\textasciitilde{}} \KeywordTok{[:}\NormalTok{ alltrim}\KeywordTok{\&.>} \KeywordTok{[:}\NormalTok{ wfl }\KeywordTok{[:}\NormalTok{ ctl }\KeywordTok{[:}\NormalTok{ decomm }\KeywordTok{[:} \KeywordTok{];.}\NormalTok{\_}\DecValTok{1} \RegionMarkerTok{(}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)} \KeywordTok{,} \RegionMarkerTok{(}\DecValTok{13}\KeywordTok{\{a.}\RegionMarkerTok{)} \KeywordTok{{-}.\textasciitilde{}} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{setifacelinks}\AlertTok{=:}\index{setifacelinks@\texttt{setifacelinks}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*setifacelinks  v{-}{-}  set  hyperref   links  in   any  overview}
\CommentTok{NB. interface words section.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  cl =. blclIwords setifacelinks (clIfstr ; clTex)}

\StringTok{\textquotesingle{}ifstr tex\textquotesingle{}}\KeywordTok{=.} \KeywordTok{y}
\NormalTok{rmrk}\KeywordTok{=.} \StringTok{\textquotesingle{}\textbackslash{}end\{Shaded\}\textquotesingle{}}
\NormalTok{head}\KeywordTok{=.}\NormalTok{ ifstr}\KeywordTok{\&}\NormalTok{beforestr tex}
\NormalTok{tail}\KeywordTok{=.}\NormalTok{ ifstr}\KeywordTok{\&}\NormalTok{afterstr tex}

\KeywordTok{if.} \KeywordTok{+./}\NormalTok{rmrk }\KeywordTok{E.}\NormalTok{ tail }\KeywordTok{do.}
\NormalTok{  ifbk}\KeywordTok{=.}\NormalTok{ formifacetex }\KeywordTok{x}
\NormalTok{  tail}\KeywordTok{=.}\NormalTok{ rmrk}\KeywordTok{\&}\NormalTok{afterstr tail}
\NormalTok{  head}\KeywordTok{,}\NormalTok{ifstr}\KeywordTok{,}\RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\#}\NormalTok{LF}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{ifbk}\KeywordTok{,}\NormalTok{tail}
\KeywordTok{else.}
\NormalTok{  tex}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{setifacetargs}\AlertTok{=:}\index{setifacetargs@\texttt{setifacetargs}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*setifacetargs v{-}{-} set hyperlink targets in group latex.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  cl =. blclIwords setifacetargs clTex}

\NormalTok{targs}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}\textbackslash{}NormalTok\{\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>} \KeywordTok{x} \KeywordTok{,\&.>} \KeywordTok{<}\StringTok{\textquotesingle{}\}\textbackslash{}AlertTok\{=:\}\textbackslash{}index\textquotesingle{}}
\NormalTok{rstrs}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}\textbackslash{}hypertarget\{\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>} \KeywordTok{x} \KeywordTok{,\&.>} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}\}\{\textbackslash{}NormalTok\{\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>} \KeywordTok{x} \KeywordTok{,\&.>} \KeywordTok{<}\StringTok{\textquotesingle{}\}\}\textbackslash{}AlertTok\{=:\}\textbackslash{}index\textquotesingle{}}
\NormalTok{chgs}\KeywordTok{=.}  \KeywordTok{;}\RegionMarkerTok{(}\StringTok{\textquotesingle{}\#\textquotesingle{}} \KeywordTok{,\&.>}\NormalTok{ targs}\RegionMarkerTok{)} \KeywordTok{,\&.>} \StringTok{\textquotesingle{}\#\textquotesingle{}} \KeywordTok{,\&.>}\NormalTok{ rstrs}
\NormalTok{chgs changestr }\KeywordTok{y}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\hypertarget{setjodliterate}{\NormalTok{setjodliterate}}\AlertTok{=:}\index{setjodliterate@\texttt{setjodliterate}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*setjodliterate v{-}{-} prepare for processing.}
\CommentTok{NB.}
\CommentTok{NB. monad:  (paRc ; clDir) =. setjodliterate clWorkingDir | zl}
\CommentTok{NB.}
\CommentTok{NB.   setjodliterate \textquotesingle{}c:\textbackslash{}temp\textquotesingle{}           NB. windows}
\CommentTok{NB.   setjodliterate \textquotesingle{}/home/john/temp\textquotesingle{}   NB. linux}
\CommentTok{NB.}
\CommentTok{NB.   NB. use the current JOD put dictionary document directory}
\CommentTok{NB.   setjodliterate \textquotesingle{}\textquotesingle{}}

\KeywordTok{try.}

\KeywordTok{if.} \DecValTok{3}\KeywordTok{\textasciitilde{}:}\RegionMarkerTok{(}\DecValTok{4}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{<}\StringTok{\textquotesingle{}badrc\_ajod\_\textquotesingle{}} \KeywordTok{do.} \DecValTok{0}\KeywordTok{;}\StringTok{\textquotesingle{}!error: jod is not loaded\textquotesingle{}} \KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.} \DecValTok{0} \KeywordTok{=} \KeywordTok{\#}\NormalTok{DPATH}\DecValTok{\_\_}\NormalTok{ST}\DecValTok{\_\_}\NormalTok{JODobj   }\KeywordTok{do.} \DecValTok{0}\KeywordTok{;}\StringTok{\textquotesingle{}!error: no open jod dictionaries\textquotesingle{}} \KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. if the path is empty use the current put dictionary document directory !(*)=. dob}
\KeywordTok{if.} \DecValTok{0} \KeywordTok{e.} \KeywordTok{$y} \KeywordTok{do.} \KeywordTok{y=.}\NormalTok{ DOC\_\_dob }\KeywordTok{[}\NormalTok{ dob}\AlertTok{=:}\index{dob@\texttt{dob}}  \KeywordTok{\{:\{.}\NormalTok{DPATH}\DecValTok{\_\_}\NormalTok{ST}\DecValTok{\_\_}\NormalTok{JODobj }\KeywordTok{end.}

\CommentTok{NB. profile (*)=. IFWIN}
\NormalTok{JLDIRECTORY\_ajodliterate}\DecValTok{\_}\AlertTok{=:}\index{JLDIRECTORY\_ajodliterate\_@\texttt{JLDIRECTORY\_ajodliterate\_}}\NormalTok{  jpathsep}\KeywordTok{\textasciigrave{}}\NormalTok{winpathsep}\KeywordTok{@.}\RegionMarkerTok{(}\NormalTok{IFWIN}\RegionMarkerTok{)}\NormalTok{ tslash2 }\KeywordTok{y}

\CommentTok{NB. write main latex preamble once per directory}
\NormalTok{preamble}\KeywordTok{=.} \StringTok{\textquotesingle{}JODLiteratePreamble.tex\textquotesingle{}}
\KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{fexist JLDIRECTORY}\KeywordTok{,}\NormalTok{preamble }\KeywordTok{do.}
  \RegionMarkerTok{(}\NormalTok{toJ JODLiteratePreamble}\RegionMarkerTok{)}\NormalTok{ writeas JLDIRECTORY}\KeywordTok{,}\NormalTok{preamble}
\KeywordTok{end.}
\DecValTok{1}\KeywordTok{;}\NormalTok{JLDIRECTORY}

\KeywordTok{catchd.}
  \DecValTok{0}\KeywordTok{;}\StringTok{\textquotesingle{}!error: (setjodliterate) failure {-} last J error {-}>\textquotesingle{}}\KeywordTok{;}\DecValTok{13}\KeywordTok{!:}\DecValTok{12} \StringTok{\textquotesingle{}\textquotesingle{}}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. appends trailing line feed character if necessary}
\NormalTok{tlf}\AlertTok{=:}\index{tlf@\texttt{tlf}} \KeywordTok{]} \KeywordTok{,} \RegionMarkerTok{((}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{=} \KeywordTok{\{:}\RegionMarkerTok{)} \KeywordTok{\}.} \RegionMarkerTok{(}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)}\KeywordTok{"}\NormalTok{\_}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. converts character strings to J delimiter LF}
\NormalTok{toJ}\AlertTok{=:}\index{toJ@\texttt{toJ}} \RegionMarkerTok{((}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)} \KeywordTok{I.@}\RegionMarkerTok{(}\KeywordTok{e.\&}\RegionMarkerTok{(}\DecValTok{13}\KeywordTok{\{a.}\RegionMarkerTok{))}\KeywordTok{@]\}} \KeywordTok{]}\RegionMarkerTok{)}\KeywordTok{@:}\RegionMarkerTok{(}\KeywordTok{\#\textasciitilde{}} \KeywordTok{{-}.@}\RegionMarkerTok{((}\DecValTok{13} \DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)}\KeywordTok{\&E.@,}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. appends trailing / iff last character is not \textbackslash{} or /}
\NormalTok{tslash2}\AlertTok{=:}\index{tslash2@\texttt{tslash2}} \RegionMarkerTok{(}\KeywordTok{[:} \KeywordTok{{-}} \StringTok{\textquotesingle{}\textbackslash{}/\textquotesingle{}} \KeywordTok{e.\textasciitilde{}} \KeywordTok{\{:}\RegionMarkerTok{)} \KeywordTok{\}.} \StringTok{\textquotesingle{}/\textquotesingle{}} \KeywordTok{,\textasciitilde{}} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. character list to UTF{-}8}
\NormalTok{utf8}\AlertTok{=:}\index{utf8@\texttt{utf8}} \DecValTok{8}\KeywordTok{\&u:}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. standardizes path delimiter to windows back \textbackslash{} slash}
\NormalTok{winpathsep}\AlertTok{=:}\index{winpathsep@\texttt{winpathsep}} \StringTok{\textquotesingle{}\textbackslash{}\textquotesingle{}}\KeywordTok{\&}\RegionMarkerTok{((}\StringTok{\textquotesingle{}/\textquotesingle{}} \KeywordTok{I.@:=} \KeywordTok{]}\RegionMarkerTok{)}\KeywordTok{\}}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wrapvrblong}\AlertTok{=:}\index{wrapvrblong@\texttt{wrapvrblong}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*wrapvrblong v{-}{-} wraps verbatim text lines with length > (x).}
\CommentTok{NB.}
\CommentTok{NB. Wraps lines with length > (x) and  prefixes each wrapped line}
\CommentTok{NB. with the syntactically invalid j string \textquotesingle{})=.)=.\textquotesingle{} (WRAPPREFIX)}
\CommentTok{NB. This  string  is transformed  by pandoc into  an easily found}
\CommentTok{NB. sequence of LaTeX commands.}
\CommentTok{NB.}
\CommentTok{NB. monad:  cl =. wrapvrblong clTxt}
\CommentTok{NB. dyad:   cl =. iaLength wrapvrblong clTxt}

\NormalTok{WRAPLIMIT wrapvrblong }\KeywordTok{y}
\KeywordTok{:}
\CommentTok{NB. always trim trailing blanks}
\NormalTok{ct}\KeywordTok{=.} \KeywordTok{<@}\NormalTok{rtrim}\KeywordTok{;.}\NormalTok{\_}\DecValTok{2}\NormalTok{ tlf }\KeywordTok{y} \KeywordTok{{-}.}\NormalTok{ CR}

\CommentTok{NB. only wrap lines exceeding limit}
\KeywordTok{if.} \KeywordTok{\#}\NormalTok{pos}\KeywordTok{=.} \KeywordTok{I.} \KeywordTok{x} \KeywordTok{<} \KeywordTok{\#\&>}\NormalTok{ ct }\KeywordTok{do.}
\NormalTok{  wlen}\KeywordTok{=.} \KeywordTok{x{-}\#}\NormalTok{WRAPLEAD}
\NormalTok{  wt}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{{-}}\NormalTok{wlen}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{<\textbackslash{}}\RegionMarkerTok{)}\KeywordTok{\&.>}\NormalTok{ pos}\KeywordTok{\{}\NormalTok{ct}
\NormalTok{  slen}\KeywordTok{=.} \DecValTok{1}\KeywordTok{\&,@:<:@\#\&.>}\NormalTok{ wt}
  \CommentTok{NB. lead wrapped lines with prefix}
\NormalTok{  wt}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{slen }\KeywordTok{\#\&.>} \KeywordTok{<}\RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{,<}\NormalTok{LF}\KeywordTok{,}\NormalTok{WRAPPREFIX}\RegionMarkerTok{)} \KeywordTok{,.\&.>}\NormalTok{ wt}
\NormalTok{  wt}\KeywordTok{=.} \KeywordTok{a:} \KeywordTok{{-}.\textasciitilde{}} \KeywordTok{L:} \DecValTok{1} \KeywordTok{,\&.>}\NormalTok{ wt}
  \CommentTok{NB. last wrapped line LF terminated}
\NormalTok{  wt}\KeywordTok{=.}\NormalTok{ wt }\KeywordTok{,} \KeywordTok{L:} \DecValTok{1} \KeywordTok{<}\NormalTok{LF}
\NormalTok{  nwpos}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{i.\#}\NormalTok{ct}\RegionMarkerTok{)} \KeywordTok{{-}.}\NormalTok{ pos}
\NormalTok{  ct}\KeywordTok{=.} \RegionMarkerTok{((}\NormalTok{nwpos}\KeywordTok{\{}\NormalTok{ct}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ LF}\RegionMarkerTok{)}\NormalTok{ nwpos}\KeywordTok{\}}\NormalTok{ ct}
  \KeywordTok{;;}\NormalTok{wt pos}\KeywordTok{\}} \KeywordTok{<"}\DecValTok{0}\NormalTok{ ct}
\KeywordTok{else.}
  \RegionMarkerTok{(}\KeywordTok{{-}}\NormalTok{LF}\KeywordTok{\textasciitilde{}:\{:y}\RegionMarkerTok{)} \KeywordTok{\}.} \KeywordTok{;}\NormalTok{ ct }\KeywordTok{,\&.>}\NormalTok{ LF}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. write file as list of bytes {-} throws unambiguous error on failure}
\NormalTok{writeas}\AlertTok{=:}\index{writeas@\texttt{writeas}} \RegionMarkerTok{(}\DecValTok{1}\KeywordTok{!:}\DecValTok{2} \KeywordTok{]\textasciigrave{}<@.}\RegionMarkerTok{(}\DecValTok{32}\KeywordTok{\&>@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)))} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{[:} \StringTok{\textquotesingle{}cannot write file\textquotesingle{}}\KeywordTok{\&}\RegionMarkerTok{(}\DecValTok{13}\KeywordTok{!:}\DecValTok{8}\RegionMarkerTok{)} \KeywordTok{1:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}
\begin{JODPostProcessor}
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB.POST\_jodliterate post processor ({-}.)=:}

\NormalTok{smoutput IFACE}\AlertTok{=:}\index{IFACE@\texttt{IFACE}}  \RegionMarkerTok{(}\DecValTok{0} \RegionMarkerTok{: 0)}
\CommentTok{NB. (jodliterate) interface word(s):}
\CommentTok{NB. {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{NB. grplit          NB. make latex for group (y)}
\CommentTok{NB. ifacesection    NB. interface section summary string}
\CommentTok{NB. setjodliterate  NB. prepare for processing}
\RegionMarkerTok{)}

\NormalTok{cocurrent }\StringTok{\textquotesingle{}base\textquotesingle{}}
\NormalTok{coinsert  }\StringTok{\textquotesingle{}ajodliterate\textquotesingle{}}
\end{Highlighting}
\end{Shaded}
\end{JODPostProcessor}
