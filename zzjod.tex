\section{\texttt{jod} Source Code}

\begin{JODGroupHeader}
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. *jod c{-}{-} main JOD dictionary class.}
\CommentTok{NB.}
\CommentTok{NB. All other dictionary classes are extensions of the dictionary class.}
\CommentTok{NB. They all use standard constants and verbs defined in this class.}
\CommentTok{NB.}
\CommentTok{NB. Creating a JOD object defines a (ijod) locale interface.}
\CommentTok{NB. Destroying a JOD object erases the (ijod) locale interface.}
\CommentTok{NB.}
\CommentTok{NB. Contains: dictionary utilities, constants, interface verbs}
\CommentTok{NB.}
\CommentTok{NB. Interface: (verbs made available by ijod locale)}
\CommentTok{NB.   bget    get objects from put dictionary backups}
\CommentTok{NB.   bnl     backup name lists from patterns}
\CommentTok{NB.   del     delete words, tests, groups, macros, et cetera}
\CommentTok{NB.   did     dictionary identification}
\CommentTok{NB.   dnl     dictionary name lists from patterns}
\CommentTok{NB.   dpset   sets dictionary parameters}
\CommentTok{NB.   gdeps   list group and suite dependents}
\CommentTok{NB.   get     get words, tests, macros, et cetera from dictionary}
\CommentTok{NB.   globs   word and test global name references}
\CommentTok{NB.   grp     create and query groups and suites}
\CommentTok{NB.   make    generate J scripts and database dumps}
\CommentTok{NB.   mnl     many dictionary name lists from patterns}
\CommentTok{NB.   newd    create new dictionary}
\CommentTok{NB.   od      opens and closes dictionaries}
\CommentTok{NB.   packd   pack dictionaries}
\CommentTok{NB.   put     put words, tests, macros, et cetera into dictionary}
\CommentTok{NB.   regd    register/unregister a dictionary}
\CommentTok{NB.   restd   restore last backup created by (packd)}
\CommentTok{NB.   rxs     regular expression search}
\CommentTok{NB.   uses    words used by words and tests}
\CommentTok{NB.}
\CommentTok{NB. Notes:}
\CommentTok{NB.   Error messages (JOD errors 000{-}049)}

\NormalTok{coclass  }\StringTok{\textquotesingle{}ajod\textquotesingle{}}
\NormalTok{coinsert }\StringTok{\textquotesingle{}ijod\textquotesingle{}}

\CommentTok{NB. task addon loaded first for J 9.01}
\NormalTok{require }\StringTok{\textquotesingle{}jfiles regex\textquotesingle{}}

\CommentTok{NB.*dependents x{-}{-} words defined in this section have related definitions}

\CommentTok{NB. host specific z locale nouns set during J profile loading}
\CommentTok{NB. (*)=: IFWIN UNAME IFIOS}

\CommentTok{NB. line feed, carriage return, tab and line ends}
\NormalTok{LF}\AlertTok{=:}\index{LF@\texttt{LF}} \DecValTok{10}\KeywordTok{\{a.}
\NormalTok{CR}\AlertTok{=:}\index{CR@\texttt{CR}} \DecValTok{13}\KeywordTok{\{a.}
\NormalTok{TAB}\AlertTok{=:}\index{TAB@\texttt{TAB}} \DecValTok{9}\KeywordTok{\{a.}
\NormalTok{CRLF}\AlertTok{=:}\index{CRLF@\texttt{CRLF}}\NormalTok{ CR}\KeywordTok{,}\NormalTok{LF}

\CommentTok{NB. macro script option codes {-} to add more add a new object code}
\CommentTok{NB. and modify the following definition of MACROTYPE}
\NormalTok{JSCRIPT}\AlertTok{=:}\index{JSCRIPT@\texttt{JSCRIPT}} \DecValTok{21}
\NormalTok{LATEX}\AlertTok{=:}\index{LATEX@\texttt{LATEX}} \DecValTok{22}
\NormalTok{HTML}\AlertTok{=:}\index{HTML@\texttt{HTML}} \DecValTok{23}
\NormalTok{XML}\AlertTok{=:}\index{XML@\texttt{XML}} \DecValTok{24}
\NormalTok{TEXT}\AlertTok{=:}\index{TEXT@\texttt{TEXT}} \DecValTok{25}
\NormalTok{BYTE}\AlertTok{=:}\index{BYTE@\texttt{BYTE}} \DecValTok{26}
\NormalTok{MARKDOWN}\AlertTok{=:}\index{MARKDOWN@\texttt{MARKDOWN}} \DecValTok{27}
\NormalTok{UTF8}\AlertTok{=:}\index{UTF8@\texttt{UTF8}} \DecValTok{28}
\NormalTok{PYTHON}\AlertTok{=:}\index{PYTHON@\texttt{PYTHON}} \DecValTok{29}
\NormalTok{SQL}\AlertTok{=:}\index{SQL@\texttt{SQL}} \DecValTok{30}
\NormalTok{JSON}\AlertTok{=:}\index{JSON@\texttt{JSON}} \DecValTok{31}

\CommentTok{NB. macro text types}
\NormalTok{MACROTYPE}\AlertTok{=:}\index{MACROTYPE@\texttt{MACROTYPE}}\NormalTok{ JSCRIPT}\KeywordTok{,}\NormalTok{LATEX}\KeywordTok{,}\NormalTok{HTML}\KeywordTok{,}\NormalTok{XML}\KeywordTok{,}\NormalTok{TEXT}\KeywordTok{,}\NormalTok{BYTE}\KeywordTok{,}\NormalTok{MARKDOWN}\KeywordTok{,}\NormalTok{UTF8}\KeywordTok{,}\NormalTok{PYTHON}\KeywordTok{,}\NormalTok{SQL}\KeywordTok{,}\NormalTok{JSON}

\CommentTok{NB. object codes}
\NormalTok{WORD}\AlertTok{=:}\index{WORD@\texttt{WORD}} \DecValTok{0}
\NormalTok{TEST}\AlertTok{=:}\index{TEST@\texttt{TEST}} \DecValTok{1}
\NormalTok{GROUP}\AlertTok{=:}\index{GROUP@\texttt{GROUP}} \DecValTok{2}
\NormalTok{SUITE}\AlertTok{=:}\index{SUITE@\texttt{SUITE}} \DecValTok{3}
\NormalTok{MACRO}\AlertTok{=:}\index{MACRO@\texttt{MACRO}} \DecValTok{4}

\CommentTok{NB. dictionary self reference}
\NormalTok{DICTIONARY}\AlertTok{=:}\index{DICTIONARY@\texttt{DICTIONARY}} \DecValTok{5}

\CommentTok{NB. object name class, depends: WORD,TEST,GROUP,SUITE,MACRO}
\NormalTok{OBJECTNC}\AlertTok{=:}\index{OBJECTNC@\texttt{OBJECTNC}}\NormalTok{ WORD}\KeywordTok{,}\NormalTok{TEST}\KeywordTok{,}\NormalTok{GROUP}\KeywordTok{,}\NormalTok{SUITE}\KeywordTok{,}\NormalTok{MACRO}

\CommentTok{NB. bad object code, depends: OBJECTNC}
\NormalTok{badobj}\AlertTok{=:}\index{badobj@\texttt{badobj}} \KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{[:} \KeywordTok{*./} \KeywordTok{[:} \KeywordTok{,} \KeywordTok{]} \KeywordTok{e.}\NormalTok{ OBJECTNC}\KeywordTok{"}\NormalTok{\_}

\CommentTok{NB. path delimiter character \& path punctuation characters}
\NormalTok{PATHDEL}\AlertTok{=:}\index{PATHDEL@\texttt{PATHDEL}}\NormalTok{  IFWIN }\KeywordTok{\{} \StringTok{\textquotesingle{}/\textbackslash{}\textquotesingle{}}
\NormalTok{PATHCHRS}\AlertTok{=:}\index{PATHCHRS@\texttt{PATHCHRS}} \StringTok{\textquotesingle{} :.{-}\textquotesingle{}}\KeywordTok{,}\NormalTok{PATHDEL}

\CommentTok{NB. path verbs {-} embed /\textbackslash{} chars depending on host OS}
\NormalTok{hostsep}\AlertTok{=:}\index{hostsep@\texttt{hostsep}}  \RegionMarkerTok{(}\NormalTok{IFWIN}\KeywordTok{\{}\StringTok{\textquotesingle{}/\textbackslash{}\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{\&}\RegionMarkerTok{(((}\NormalTok{IFWIN}\KeywordTok{\{}\StringTok{\textquotesingle{}\textbackslash{}/\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{I.@:=} \KeywordTok{]}\RegionMarkerTok{)}\KeywordTok{\}}\RegionMarkerTok{)}

\CommentTok{NB. extracts only the path from qualified file names}
\NormalTok{justpath}\AlertTok{=:}\index{justpath@\texttt{justpath}} \KeywordTok{[:} \KeywordTok{\}:} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \RegionMarkerTok{(}\KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{[:} \KeywordTok{+./\textbackslash{}.} \StringTok{\textquotesingle{}:\textquotesingle{}}\KeywordTok{\&=}\RegionMarkerTok{)} \KeywordTok{*.} \KeywordTok{[:} \KeywordTok{+./\textbackslash{}.}\NormalTok{ PATHDEL}\KeywordTok{\&=}

\CommentTok{NB. default master profile user locations}
\CommentTok{NB. jodsystempath is left global here as this}
\CommentTok{NB. verb is defined in jodon.ijs}
\NormalTok{JMASTER}\AlertTok{=:}\index{JMASTER@\texttt{JMASTER}}\NormalTok{ jodsystempath }\StringTok{\textquotesingle{}jmaster\textquotesingle{}}
\NormalTok{JODPROF}\AlertTok{=:}\index{JODPROF@\texttt{JODPROF}}\NormalTok{ jodsystempath }\StringTok{\textquotesingle{}jodprofile.ijs\textquotesingle{}}
\NormalTok{JODUSER}\AlertTok{=:}\index{JODUSER@\texttt{JODUSER}}\NormalTok{ jodsystempath }\StringTok{\textquotesingle{}joduserconfig.ijs\textquotesingle{}}

\CommentTok{NB.*enddependents}

\CommentTok{NB.*end{-}header}
\end{Highlighting}
\end{Shaded}
\end{JODGroupHeader}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. valid characters in file and path names}
\NormalTok{ALPHA}\AlertTok{=:}\index{ALPHA@\texttt{ALPHA}} \StringTok{\textquotesingle{}ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master file cn: dictionary number log {-} see long documentation}
\NormalTok{CNMFDLOG}\AlertTok{=:}\index{CNMFDLOG@\texttt{CNMFDLOG}} \DecValTok{10}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master file cn: in use bit}
\NormalTok{CNMFMARK}\AlertTok{=:}\index{CNMFMARK@\texttt{CNMFMARK}} \DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master file cn: dictionary parameter defaults}
\NormalTok{CNMFPARMDEFS}\AlertTok{=:}\index{CNMFPARMDEFS@\texttt{CNMFPARMDEFS}} \DecValTok{9}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master file cn: dictionary parameters {-} see long documentation}
\NormalTok{CNMFPARMS}\AlertTok{=:}\index{CNMFPARMS@\texttt{CNMFPARMS}} \DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master file cn: main dictionary table {-} see long documentation}
\NormalTok{CNMFTAB}\AlertTok{=:}\index{CNMFTAB@\texttt{CNMFTAB}} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master file cn: main dictionary table backup}
\NormalTok{CNMFTABBCK}\AlertTok{=:}\index{CNMFTABBCK@\texttt{CNMFTABBCK}} \DecValTok{3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. default option code}
\NormalTok{DEFAULT}\AlertTok{=:}\index{DEFAULT@\texttt{DEFAULT}} \DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. comment tag marking end of dependents section}
\NormalTok{DEPENDENTSEND}\AlertTok{=:}\index{DEPENDENTSEND@\texttt{DEPENDENTSEND}} \StringTok{\textquotesingle{}enddependents\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. comment tag marking start of dependents section}
\NormalTok{DEPENDENTSSTART}\AlertTok{=:}\index{DEPENDENTSSTART@\texttt{DEPENDENTSSTART}} \StringTok{\textquotesingle{}dependents\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. numeral characters}
\NormalTok{DIGITS}\AlertTok{=:}\index{DIGITS@\texttt{DIGITS}} \StringTok{\textquotesingle{}0123456789\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. document option code}
\NormalTok{DOCUMENT}\AlertTok{=:}\index{DOCUMENT@\texttt{DOCUMENT}} \DecValTok{9}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. controls dependent block processing {-} (1) process (0) do not process}
\NormalTok{DODEPENDENTS}\AlertTok{=:}\index{DODEPENDENTS@\texttt{DODEPENDENTS}} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. dictionary path table {-} see long documentation}
\NormalTok{DPATH}\AlertTok{=:}\index{DPATH@\texttt{DPATH}} \DecValTok{0} \DecValTok{4}\KeywordTok{$}\DecValTok{00}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. maximum dictionary path length}
\NormalTok{DPLIMIT}\AlertTok{=:}\index{DPLIMIT@\texttt{DPLIMIT}} \DecValTok{32}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR001}\AlertTok{=:}\index{ERR001@\texttt{ERR001}} \StringTok{\textquotesingle{}invalid option(s)\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR002}\AlertTok{=:}\index{ERR002@\texttt{ERR002}} \StringTok{\textquotesingle{}invalid name(s)\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR003}\AlertTok{=:}\index{ERR003@\texttt{ERR003}} \StringTok{\textquotesingle{}name(s) to long\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR004}\AlertTok{=:}\index{ERR004@\texttt{ERR004}} \StringTok{\textquotesingle{}invalid or missing locale\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR005}\AlertTok{=:}\index{ERR005@\texttt{ERR005}} \StringTok{\textquotesingle{}invalid or missing dictionary name(s)\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR006}\AlertTok{=:}\index{ERR006@\texttt{ERR006}} \StringTok{\textquotesingle{}cannot read master\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR007}\AlertTok{=:}\index{ERR007@\texttt{ERR007}} \StringTok{\textquotesingle{}cannot read master documentation\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR008}\AlertTok{=:}\index{ERR008@\texttt{ERR008}} \StringTok{\textquotesingle{}invalid names(s) {-} embedded locale references\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR009}\AlertTok{=:}\index{ERR009@\texttt{ERR009}} \StringTok{\textquotesingle{}no documentation text for {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR010}\AlertTok{=:}\index{ERR010@\texttt{ERR010}} \StringTok{\textquotesingle{}invalid name pattern(s)\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR011}\AlertTok{=:}\index{ERR011@\texttt{ERR011}} \StringTok{\textquotesingle{}error(s) creating dictionary master file\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR012}\AlertTok{=:}\index{ERR012@\texttt{ERR012}} \StringTok{\textquotesingle{}master in use {-} wait or try (dpset)\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR013}\AlertTok{=:}\index{ERR013@\texttt{ERR013}} \StringTok{\textquotesingle{}cannot mark master\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR014}\AlertTok{=:}\index{ERR014@\texttt{ERR014}} \StringTok{\textquotesingle{}invalid name and text\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR015}\AlertTok{=:}\index{ERR015@\texttt{ERR015}} \StringTok{\textquotesingle{}invalid name, class and text\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR016}\AlertTok{=:}\index{ERR016@\texttt{ERR016}} \StringTok{\textquotesingle{}definition failure among {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR017}\AlertTok{=:}\index{ERR017@\texttt{ERR017}} \StringTok{\textquotesingle{}jfile replace error\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR018}\AlertTok{=:}\index{ERR018@\texttt{ERR018}} \StringTok{\textquotesingle{}dictionary in use {-} cannot unregister\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR019}\AlertTok{=:}\index{ERR019@\texttt{ERR019}} \StringTok{\textquotesingle{}invalid parameter or value\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR020}\AlertTok{=:}\index{ERR020@\texttt{ERR020}} \StringTok{\textquotesingle{}table name(s) are not unique\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR021}\AlertTok{=:}\index{ERR021@\texttt{ERR021}} \StringTok{\textquotesingle{}dll error generating GUID\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR022}\AlertTok{=:}\index{ERR022@\texttt{ERR022}} \StringTok{\textquotesingle{}JOD z interface clashes with current z locale names. JOD load aborted\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR023}\AlertTok{=:}\index{ERR023@\texttt{ERR023}} \StringTok{\textquotesingle{}white space preservation is off {-} turn on to put\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR024}\AlertTok{=:}\index{ERR024@\texttt{ERR024}} \StringTok{\textquotesingle{}dependent section unbalanced\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR025}\AlertTok{=:}\index{ERR025@\texttt{ERR025}} \StringTok{\textquotesingle{}only one balanced dependent section allowed\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR026}\AlertTok{=:}\index{ERR026@\texttt{ERR026}} \StringTok{\textquotesingle{}error in joduserconfig.ijs {-} last J error {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR027}\AlertTok{=:}\index{ERR027@\texttt{ERR027}} \StringTok{\textquotesingle{}unable to set master parameters {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ERR028}\AlertTok{=:}\index{ERR028@\texttt{ERR028}} \StringTok{\textquotesingle{}not supported on this environment {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. explain option code}
\NormalTok{EXPLAIN}\AlertTok{=:}\index{EXPLAIN@\texttt{EXPLAIN}} \DecValTok{8}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. space in bytes required to create dictionary (0 turns off volume sizing)}
\NormalTok{FREESPACE}\AlertTok{=:}\index{FREESPACE@\texttt{FREESPACE}} \DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. group and suite header code}
\NormalTok{HEADER}\AlertTok{=:}\index{HEADER@\texttt{HEADER}} \DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. database file extension (it\textquotesingle{}s changed in the past)}
\NormalTok{IJF}\AlertTok{=:}\index{IJF@\texttt{IJF}} \StringTok{\textquotesingle{}.ijf\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. J script file extension}
\NormalTok{IJS}\AlertTok{=:}\index{IJS@\texttt{IJS}} \StringTok{\textquotesingle{}.ijs\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. inverted data code: name classes and macro types}
\NormalTok{INCLASS}\AlertTok{=:}\index{INCLASS@\texttt{INCLASS}} \DecValTok{12}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. inverted data code: object creation time}
\NormalTok{INCREATE}\AlertTok{=:}\index{INCREATE@\texttt{INCREATE}} \DecValTok{13}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. inverted data code: last object put time}
\NormalTok{INPUT}\AlertTok{=:}\index{INPUT@\texttt{INPUT}} \DecValTok{14}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. inverted data code: object size in bytes}
\NormalTok{INSIZE}\AlertTok{=:}\index{INSIZE@\texttt{INSIZE}} \DecValTok{15}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. core JOD interface {-} loaded into (ijod) {-} see (setjodinterface)}
\NormalTok{IzJODinterface}\AlertTok{=:}\index{IzJODinterface@\texttt{IzJODinterface}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1}\NormalTok{ \textquotesingle{} bnl bget del did dnl dpset gdeps get globs grp make mnl newd od packd put regd res}
\AlertTok{>..>}\NormalTok{ td rxs uses\textquotesingle{}}

\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. standard dictionary file names {-} order matters}
\NormalTok{JDFILES}\AlertTok{=:}\index{JDFILES@\texttt{JDFILES}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \StringTok{\textquotesingle{} jwords jtests jgroups jsuites jmacros juses\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. standard dictionary subdirectory names {-} order matters}
\NormalTok{JDSDIRS}\AlertTok{=:}\index{JDSDIRS@\texttt{JDSDIRS}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \StringTok{\textquotesingle{} script suite document dump alien backup\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. default JOD user directory}
\NormalTok{JJODDIR}\AlertTok{=:}\index{JJODDIR@\texttt{JJODDIR}} \StringTok{\textquotesingle{}joddicts\textbackslash{}\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. regular expression matching valid J names}
\NormalTok{JNAME}\AlertTok{=:}\index{JNAME@\texttt{JNAME}} \StringTok{\textquotesingle{}[[:alpha:]][[:alnum:]\_]*\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. version, make and date}
\NormalTok{JODVMD}\AlertTok{=:}\index{JODVMD@\texttt{JODVMD}} \StringTok{\textquotesingle{}1.0.1\textquotesingle{}}\KeywordTok{;}\DecValTok{7}\KeywordTok{;}\StringTok{\textquotesingle{}28 Mar 2020 13:01:05\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. base J version {-} prior versions not supported by JOD}
\NormalTok{JVERSION}\AlertTok{=:}\index{JVERSION@\texttt{JVERSION}} \KeywordTok{,}\DecValTok{6.0199999999999996}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. default master file parameters}
\NormalTok{MASTERPARMS}\AlertTok{=:}\index{MASTERPARMS@\texttt{MASTERPARMS}} \DecValTok{6} \DecValTok{3}\KeywordTok{$}\StringTok{\textquotesingle{}PUTFACTOR\textquotesingle{}}\KeywordTok{;}\StringTok{\textquotesingle{}(+integer) words stored in one loop pass\textquotesingle{}}\KeywordTok{;}\DecValTok{100}\KeywordTok{;}\StringTok{\textquotesingle{}GETFACTOR\textquotesingle{}}\KeywordTok{;}\NormalTok{\textquotesingle{}}\RegionMarkerTok{(}\KeywordTok{+}\NormalTok{integer}\RegionMarkerTok{)}\NormalTok{ words }
\AlertTok{>..>}\NormalTok{ retrieved in one loop pass }\RegionMarkerTok{(}\KeywordTok{<}\DecValTok{2048}\RegionMarkerTok{)}\StringTok{\textquotesingle{};250;\textquotesingle{}}\NormalTok{COPYFACTOR}\StringTok{\textquotesingle{};\textquotesingle{}}\RegionMarkerTok{(}\KeywordTok{+}\NormalTok{integer}\RegionMarkerTok{)}\NormalTok{ components copied in one loop pass}\StringTok{\textquotesingle{};100;\textquotesingle{}}
\AlertTok{>..>}\NormalTok{ DUMPFACTOR}\StringTok{\textquotesingle{};\textquotesingle{}}\RegionMarkerTok{(}\KeywordTok{+}\NormalTok{integer}\RegionMarkerTok{)}\NormalTok{ objects dumped in one loop pass }\RegionMarkerTok{(}\KeywordTok{<}\DecValTok{240}\RegionMarkerTok{)}\StringTok{\textquotesingle{};50;\textquotesingle{}}\NormalTok{DOCUMENTWIDTH}\StringTok{\textquotesingle{};\textquotesingle{}}\RegionMarkerTok{(}\KeywordTok{+}\NormalTok{integer}\RegionMarkerTok{)}\NormalTok{ width of ju}
\AlertTok{>..>}\NormalTok{ stified document text}\StringTok{\textquotesingle{};61;\textquotesingle{}}\NormalTok{WWWBROWSER}\StringTok{\textquotesingle{};\textquotesingle{}}\RegionMarkerTok{(}\NormalTok{character}\RegionMarkerTok{)}\NormalTok{ browser command line }\KeywordTok{{-}}\NormalTok{ used for jod help}\StringTok{\textquotesingle{};\textquotesingle{}} \KeywordTok{"}\NormalTok{C}\KeywordTok{:\textbackslash{}}\NormalTok{Progra}
\AlertTok{>..>}\KeywordTok{m}\NormalTok{ Files}\KeywordTok{\textbackslash{}}\NormalTok{Internet Explorer}\KeywordTok{\textbackslash{}}\NormalTok{IEXPLORE}\KeywordTok{.}\NormalTok{EXE}\KeywordTok{"}\NormalTok{\textquotesingle{}}

\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. maximum length of short explanation text}
\NormalTok{MAXEXPLAIN}\AlertTok{=:}\index{MAXEXPLAIN@\texttt{MAXEXPLAIN}} \DecValTok{80}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. maximum length of dictionary names}
\NormalTok{MAXNAME}\AlertTok{=:}\index{MAXNAME@\texttt{MAXNAME}} \DecValTok{128}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. (name,[class],value) option code}
\NormalTok{NVTABLE}\AlertTok{=:}\index{NVTABLE@\texttt{NVTABLE}} \DecValTok{10}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. successful return}
\NormalTok{OK}\AlertTok{=:}\index{OK@\texttt{OK}} \DecValTok{1}\KeywordTok{;}\DecValTok{1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK001}\AlertTok{=:}\index{OK001@\texttt{OK001}} \StringTok{\textquotesingle{}dictionary unregistered {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK002}\AlertTok{=:}\index{OK002@\texttt{OK002}} \StringTok{\textquotesingle{} is a noun {-} no references\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK003}\AlertTok{=:}\index{OK003@\texttt{OK003}} \StringTok{\textquotesingle{}defaults restored for {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK004}\AlertTok{=:}\index{OK004@\texttt{OK004}} \StringTok{\textquotesingle{}master file reset\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK005}\AlertTok{=:}\index{OK005@\texttt{OK005}} \StringTok{\textquotesingle{}path cleared {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK006}\AlertTok{=:}\index{OK006@\texttt{OK006}} \StringTok{\textquotesingle{}parameter set {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK007}\AlertTok{=:}\index{OK007@\texttt{OK007}} \StringTok{\textquotesingle{}put dictionary is now a read/only library {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK008}\AlertTok{=:}\index{OK008@\texttt{OK008}} \StringTok{\textquotesingle{}put dictionary read/write status restored {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{OK009}\AlertTok{=:}\index{OK009@\texttt{OK009}} \StringTok{\textquotesingle{}put dictionary references deleted {-}>\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. indexes of dictionary subdirectories in dictionary parameter list}
\NormalTok{PARMDIRS}\AlertTok{=:}\index{PARMDIRS@\texttt{PARMDIRS}} \DecValTok{4} \DecValTok{5} \DecValTok{6} \DecValTok{7} \DecValTok{8} \DecValTok{9}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. parameter file {-} extension is required}
\NormalTok{PARMFILE}\AlertTok{=:}\index{PARMFILE@\texttt{PARMFILE}} \StringTok{\textquotesingle{}jodparms.ijs\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. displayed path delimiter character}
\NormalTok{PATHSHOWDEL}\AlertTok{=:}\index{PATHSHOWDEL@\texttt{PATHSHOWDEL}} \StringTok{\textquotesingle{}/\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. search pattern option codes}
\NormalTok{PATOPS}\AlertTok{=:}\index{PATOPS@\texttt{PATOPS}} \DecValTok{1} \DecValTok{2} \DecValTok{3} \DecValTok{\_1} \DecValTok{\_2} \DecValTok{\_3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. controls whether words are saved when whitespace is discarded}
\NormalTok{PUTBLACK}\AlertTok{=:}\index{PUTBLACK@\texttt{PUTBLACK}} \DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. reference option code}
\NormalTok{REFERENCE}\AlertTok{=:}\index{REFERENCE@\texttt{REFERENCE}} \DecValTok{11}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. maximum number of words per locale}
\NormalTok{SYMBOLLIM}\AlertTok{=:}\index{SYMBOLLIM@\texttt{SYMBOLLIM}} \DecValTok{2048}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. uses union option code}
\NormalTok{UNION}\AlertTok{=:}\index{UNION@\texttt{UNION}} \DecValTok{31}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. retains string after first occurrence of (x)}
\NormalTok{afterstr}\AlertTok{=:}\index{afterstr@\texttt{afterstr}} \KeywordTok{]} \KeywordTok{\}.\textasciitilde{}} \KeywordTok{\#@[} \KeywordTok{+} \DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{i.\textasciitilde{}}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{[} \KeywordTok{E.} \KeywordTok{]}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. trims all leading and trailing blanks}
\NormalTok{alltrim}\AlertTok{=:}\index{alltrim@\texttt{alltrim}} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{[:} \RegionMarkerTok{(}\KeywordTok{*./\textbackslash{}.} \KeywordTok{+.} \KeywordTok{*./\textbackslash{}}\RegionMarkerTok{)} \StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{\&=}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. test for jfile append errors}
\NormalTok{badappend}\AlertTok{=:}\index{badappend@\texttt{badappend}} \KeywordTok{0:} \KeywordTok{>} \KeywordTok{\{.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{badblia}\AlertTok{=:}\index{badblia@\texttt{badblia}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*badblia v{-}{-} returns 0 if (y) is a boxed list of integer atoms}
\CommentTok{NB. or singleton codes from (x)}

\KeywordTok{if.} \DecValTok{\_1} \KeywordTok{{-}:}\NormalTok{ dat}\KeywordTok{=.} \KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{;} \KeywordTok{::} \KeywordTok{\_1:}\RegionMarkerTok{)} \KeywordTok{y} \KeywordTok{do.} \DecValTok{1}
\KeywordTok{elseif.} \RegionMarkerTok{(}\KeywordTok{\#y}\RegionMarkerTok{)} \KeywordTok{\textasciitilde{}:} \KeywordTok{\#}\NormalTok{dat }\KeywordTok{do.} \DecValTok{1}
\KeywordTok{elseif.}\NormalTok{ badil dat }\KeywordTok{do.} \DecValTok{1}
\KeywordTok{elseif.do.} \KeywordTok{{-}.} \KeywordTok{*./}\NormalTok{ dat }\KeywordTok{e.} \KeywordTok{x}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if (y) is not boxed}
\NormalTok{badbu}\AlertTok{=:}\index{badbu@\texttt{badbu}} \KeywordTok{[:} \DecValTok{32}\KeywordTok{\&\textasciitilde{}:} \DecValTok{3}\KeywordTok{!:}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if (y) is not a character list or atom}
\NormalTok{badcl}\AlertTok{=:}\index{badcl@\texttt{badcl}} \KeywordTok{{-}.@}\RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\&=@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{))} \KeywordTok{+.} \KeywordTok{1:} \KeywordTok{<} \KeywordTok{[:} \KeywordTok{\#} \KeywordTok{$}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if (y) is not floating}
\NormalTok{badfl}\AlertTok{=:}\index{badfl@\texttt{badfl}} \KeywordTok{[:} \KeywordTok{{-}.} \DecValTok{8}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{=} \DecValTok{3}\KeywordTok{!:}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if (y) is not a list of non{-}extended integers}
\NormalTok{badil}\AlertTok{=:}\index{badil@\texttt{badil}} \KeywordTok{{-}.@}\RegionMarkerTok{(((}\KeywordTok{[:} \KeywordTok{\#} \KeywordTok{$}\RegionMarkerTok{)} \KeywordTok{e.} \DecValTok{0} \DecValTok{1}\KeywordTok{"}\NormalTok{\_}\RegionMarkerTok{)} \KeywordTok{*.} \DecValTok{3}\KeywordTok{!:}\DecValTok{0} \KeywordTok{e.} \DecValTok{1} \DecValTok{4}\KeywordTok{"}\NormalTok{\_}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. bad jfile operation}
\NormalTok{badjr}\AlertTok{=:}\index{badjr@\texttt{badjr}} \KeywordTok{[:} \KeywordTok{+./} \DecValTok{\_1} \DecValTok{\_2}\KeywordTok{\&e.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. bad locale name}
\NormalTok{badlocn}\AlertTok{=:}\index{badlocn@\texttt{badlocn}} \KeywordTok{[} \KeywordTok{>:} \KeywordTok{[:} \DecValTok{18}\KeywordTok{!:}\DecValTok{0} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_2:}\RegionMarkerTok{)} \KeywordTok{[:} \KeywordTok{<} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. bad return code}
\NormalTok{badrc}\AlertTok{=:}\index{badrc@\texttt{badrc}} \KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{1:} \KeywordTok{{-}:} \KeywordTok{[:} \KeywordTok{>} \KeywordTok{\{.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. test for jfile replacement errors}
\NormalTok{badreps}\AlertTok{=:}\index{badreps@\texttt{badreps}} \KeywordTok{0:} \KeywordTok{>} \KeywordTok{<./}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if any of shape, type or sign differ}
\NormalTok{badsts}\AlertTok{=:}\index{badsts@\texttt{badsts}} \KeywordTok{0:}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if items are not unique 0 otherwise}
\NormalTok{badunique}\AlertTok{=:}\index{badunique@\texttt{badunique}} \KeywordTok{\#} \KeywordTok{\textasciitilde{}:} \KeywordTok{[:} \KeywordTok{\#} \KeywordTok{\textasciitilde{}.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. retains string before first occurrence of (x)}
\NormalTok{beforestr}\AlertTok{=:}\index{beforestr@\texttt{beforestr}} \KeywordTok{]} \KeywordTok{\{.\textasciitilde{}} \DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{i.\textasciitilde{}}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{[} \KeywordTok{E.} \KeywordTok{]}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bget}\AlertTok{=:}\index{bget@\texttt{bget}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*bget v{-}{-} retrieves objects from put dictionary backups.}
\CommentTok{NB.}
\CommentTok{NB. (bget) implements  a subset of (get). (bget) fetches  objects}
\CommentTok{NB. from either the last backup or particular backups.}
\CommentTok{NB.}
\CommentTok{NB. OBJECTS ARE NOT DEFINED IN LOCALES for the simple reason that}
\CommentTok{NB. backup fetches may return many versions of the same object.}
\CommentTok{NB.}
\CommentTok{NB. Only put  dictionary backups  are searched there is no backup}
\CommentTok{NB. path.  Also,  there is no corresponding  (bput)  because  the}
\CommentTok{NB. files  read  by (bget)  are backups that, once  created,  are}
\CommentTok{NB. never altered by JOD.}
\CommentTok{NB.}
\CommentTok{NB. Also,   certain  objects  are  not  fetched,  name   classes,}
\CommentTok{NB. timestamps and sizes.}
\CommentTok{NB.}
\CommentTok{NB. monad:  bget cl|blcl}
\CommentTok{NB.}
\CommentTok{NB.   NB. get last word backup}
\CommentTok{NB.   bget \textquotesingle{}oops\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. collect from most current backup}
\CommentTok{NB.   bget ;: \textquotesingle{}shawn of the dead\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. collect objects from particular put dictionary backups}
\CommentTok{NB.   bget <;.\_1 \textquotesingle{} us.12 poor.10 little.08 words.08 lastback\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. get many versions of a word}
\CommentTok{NB.   bget <;.\_1 \textquotesingle{} me.12 me.09 me.08 me.02\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes bget cl|bluu}
\CommentTok{NB.}
\CommentTok{NB.   5 bget \textquotesingle{}\textquotesingle{}     NB. dictionary document from last backup}
\CommentTok{NB.   5 bget \textquotesingle{}.12\textquotesingle{}  NB. dictionary document from particular backup}
\CommentTok{NB.   5 bget \}. bnl \textquotesingle{}.\textquotesingle{}  NB. dictionary document versions in all backups}
\CommentTok{NB.}
\CommentTok{NB.   NB. get a suite header from particular backup}
\CommentTok{NB.   3 bget \textquotesingle{}sweet.04\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. get long documents of an object}
\CommentTok{NB.   2 9 bget <;.\_1 \textquotesingle{} gfoo.12 gfoo.05 gfoo.00\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. all short explanations of words in last backup}
\CommentTok{NB.   0 8 get \}. revo \textquotesingle{}\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   NB. three versions of a group\textquotesingle{}s header {-} similar to (get) where}
\CommentTok{NB.   NB. (2 get \textquotesingle{}group\textquotesingle{}) returns the group header}
\CommentTok{NB.   2   bget <;.\_1 \textquotesingle{} gfoo.12 gfoo.05 gfoo.00\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   2 1 bget <;.\_1 \textquotesingle{} gfoo.12 gfoo.05 gfoo.00\textquotesingle{}  NB. three versions of a group\textquotesingle{}s word list}

\NormalTok{WORD bget }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001}

\KeywordTok{if.} \RegionMarkerTok{(}\DecValTok{2}\KeywordTok{<\#x}\RegionMarkerTok{)} \KeywordTok{+.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. do we have a dictionary open?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. are backups present?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkback}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{\{:}\DecValTok{0}\KeywordTok{\{}\NormalTok{DPATH}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{else.}\NormalTok{ bn}\KeywordTok{=.}\NormalTok{ rv uv }\KeywordTok{end.}

\CommentTok{NB. format standard (x) options}
\KeywordTok{x=.} \KeywordTok{x} \KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{{-}}\DecValTok{2}\KeywordTok{{-}\#x}\RegionMarkerTok{)} \KeywordTok{\{.}\NormalTok{ DEFAULT}

\CommentTok{NB. are backup names and numbers valid?}
\KeywordTok{if.}\NormalTok{ badrc bnm}\KeywordTok{=.} \RegionMarkerTok{((}\KeywordTok{\{.x}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{bn}\RegionMarkerTok{)}\NormalTok{ bchecknames}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{,}\NormalTok{boxopen }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ bnm }\KeywordTok{return.} \KeywordTok{else.}\NormalTok{ bnm}\KeywordTok{=.}\NormalTok{ rv bnm }\KeywordTok{end.}

\KeywordTok{select.} \KeywordTok{\{.} \KeywordTok{x}
\KeywordTok{case.}\NormalTok{ WORD }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ WORD bgetexplain}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{,}\DecValTok{1}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ TEST }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ TEST bgetexplain}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{,}\DecValTok{1}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ GROUP }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ HEADER   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{,}\DecValTok{2}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ GROUP bgetgstext}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ GROUP bgetexplain}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{,}\DecValTok{1}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ SUITE }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ HEADER   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{,}\DecValTok{2}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ SUITE bgetgstext}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ SUITE bgetexplain}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{,}\DecValTok{1}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ MACRO }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ MACRO bgetexplain}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{,}\DecValTok{1}\RegionMarkerTok{)}\NormalTok{ bgetobjects}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ DICTIONARY }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ bgetdicdoc}\DecValTok{\_\_}\NormalTok{ST bnm}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.do.}\NormalTok{ jderr msg}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bnl}\AlertTok{=:}\index{bnl@\texttt{bnl}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*bnl v{-}{-} list objects in put dictionary database backup files.}
\CommentTok{NB.}
\CommentTok{NB. monad:  dnl clStr | zlStr}
\CommentTok{NB.}
\CommentTok{NB.   bnl \textquotesingle{}\textquotesingle{}        NB. list all words in last backup}
\CommentTok{NB.   bnl \textquotesingle{}.\textquotesingle{}       NB. list backup suffixes}
\CommentTok{NB.   bnl \textquotesingle{}pfx\textquotesingle{}     NB. list all words in last backup starting with \textquotesingle{}pfx\textquotesingle{}}
\CommentTok{NB.   bnl \textquotesingle{}re.12\textquotesingle{}   NB. list all words in backup 12 starting with \textquotesingle{}re\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes bnl clStr | zlStr}
\CommentTok{NB.}
\CommentTok{NB.   4 2  bnl \textquotesingle{}ex\textquotesingle{}     NB. macros with names containing \textquotesingle{}ex\textquotesingle{} in last backup}
\CommentTok{NB.   2 3  bnl \textquotesingle{}et.13\textquotesingle{}  NB. groups with names ending with \textquotesingle{}et\textquotesingle{} in backup 13}
\CommentTok{NB.}
\CommentTok{NB.   14 bnl \textquotesingle{}.\textquotesingle{}  NB. display pack/backup dates}

\NormalTok{WORD bnl }\KeywordTok{y}
\KeywordTok{:}
\KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.x}\NormalTok{ nlargs }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. format standard (bnl) (x) options and search}
\KeywordTok{x=.}  \KeywordTok{x} \KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{<:\#x}\RegionMarkerTok{)}\KeywordTok{\}.} \DecValTok{1} \KeywordTok{,}\NormalTok{ DEFAULT}

\CommentTok{NB. special list backup dates case first}
\KeywordTok{if.} \RegionMarkerTok{(}\NormalTok{INPUT}\KeywordTok{=}\DecValTok{0}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{*.} \RegionMarkerTok{(}\KeywordTok{,}\NormalTok{NDOT}\DecValTok{\_\_}\NormalTok{ST}\RegionMarkerTok{)}\KeywordTok{{-}:}\NormalTok{alltrim }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{x}\NormalTok{ bnlsearch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{return.} \KeywordTok{end.}

\KeywordTok{if.} \RegionMarkerTok{((}\DecValTok{0}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ WORD}\KeywordTok{,}\NormalTok{MACRO}\RegionMarkerTok{)} \KeywordTok{*.} \KeywordTok{{-}.}\RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ DEFAULT}\KeywordTok{,}\NormalTok{MACROTYPE}\KeywordTok{,i.} \DecValTok{4} \KeywordTok{do.}\NormalTok{ jderr ERR001}
\KeywordTok{elseif.} \RegionMarkerTok{(}\KeywordTok{\{.} \KeywordTok{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ OBJECTNC }\KeywordTok{do.} \KeywordTok{x}\NormalTok{ bnlsearch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{elseif.do.}\NormalTok{ jderr ERR001}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. boxes open nouns}
\NormalTok{boxopen}\AlertTok{=:}\index{boxopen@\texttt{boxopen}} \KeywordTok{<\^{}:}\RegionMarkerTok{(}\KeywordTok{L.} \KeywordTok{=} \KeywordTok{0:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{catrefs}\AlertTok{=:}\index{catrefs@\texttt{catrefs}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*catrefs v{-}{-} split into nonlocale and locale names.}
\CommentTok{NB.}
\CommentTok{NB. monad:  catrefs blcl}

\KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{,a:}\RegionMarkerTok{)}\KeywordTok{{-}:,y} \KeywordTok{do.} \StringTok{\textquotesingle{}\textquotesingle{}}
\KeywordTok{else.}
\NormalTok{  r}\KeywordTok{=.}\NormalTok{ islocref}\KeywordTok{\&>} \KeywordTok{y}  \CommentTok{NB. insure 2 item result}
\NormalTok{  s}\KeywordTok{=.} \KeywordTok{<}\RegionMarkerTok{(}\KeywordTok{{-}.}\NormalTok{r}\RegionMarkerTok{)} \KeywordTok{\#} \KeywordTok{y}
\NormalTok{  l}\KeywordTok{=.} \KeywordTok{<}\NormalTok{r }\KeywordTok{\#} \KeywordTok{y}
\NormalTok{  s}\KeywordTok{,}\NormalTok{l}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. call dll}
\NormalTok{cd}\AlertTok{=:}\index{cd@\texttt{cd}} \DecValTok{15}\KeywordTok{!:}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{changestr}\AlertTok{=:}\index{changestr@\texttt{changestr}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*changestr v{-}{-} replaces substrings {-} see long documentation.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  clReps changestr cl}
\CommentTok{NB.}
\CommentTok{NB.   NB. first character delimits replacements}
\CommentTok{NB.   \textquotesingle{}/change/becomes/me/ehh\textquotesingle{} changestr \textquotesingle{}blah blah ...\textquotesingle{}}

\NormalTok{pairs}\KeywordTok{=.} \DecValTok{2} \KeywordTok{\{."}\RegionMarkerTok{(}\DecValTok{1}\RegionMarkerTok{)} \DecValTok{\_2} \KeywordTok{[\textbackslash{}} \KeywordTok{<;.}\NormalTok{\_}\DecValTok{1} \KeywordTok{x}      \CommentTok{NB. change table}
\NormalTok{cnt}\KeywordTok{=.}\NormalTok{\_}\DecValTok{1} \KeywordTok{[}\NormalTok{ lim}\KeywordTok{=.} \KeywordTok{\#}\NormalTok{ pairs}
\KeywordTok{while.}\NormalTok{ lim }\KeywordTok{>}\NormalTok{ cnt}\KeywordTok{=.>:}\NormalTok{cnt }\KeywordTok{do.}         \CommentTok{NB. process each change pair}
  \StringTok{\textquotesingle{}t c\textquotesingle{}}\KeywordTok{=.}\NormalTok{ cnt }\KeywordTok{\{}\NormalTok{ pairs               }\CommentTok{NB. /target/change}
  \KeywordTok{if.} \KeywordTok{+./}\NormalTok{b}\KeywordTok{=.}\NormalTok{ t }\KeywordTok{E.} \KeywordTok{y} \KeywordTok{do.}             \CommentTok{NB. next if no target}
\NormalTok{    r}\KeywordTok{=.} \KeywordTok{I.}\NormalTok{ b                        }\CommentTok{NB. target starts}
    \StringTok{\textquotesingle{}l q\textquotesingle{}}\KeywordTok{=.} \KeywordTok{\#\&>}\NormalTok{ cnt }\KeywordTok{\{}\NormalTok{ pairs         }\CommentTok{NB. lengths}
\NormalTok{    p}\KeywordTok{=.}\NormalTok{ r }\KeywordTok{+} \DecValTok{0}\KeywordTok{,+/\textbackslash{}}\RegionMarkerTok{(}\KeywordTok{<:\#}\NormalTok{ r}\RegionMarkerTok{)}\KeywordTok{$}\NormalTok{ d}\KeywordTok{=.}\NormalTok{ q }\KeywordTok{{-}}\NormalTok{ l }\CommentTok{NB. change starts}
\NormalTok{    s}\KeywordTok{=.} \KeywordTok{*}\NormalTok{ d                         }\CommentTok{NB. reduce < and > to =}
    \KeywordTok{if.}\NormalTok{ s }\KeywordTok{=} \DecValTok{\_1} \KeywordTok{do.}
\NormalTok{      b}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\#\textasciitilde{}} \KeywordTok{\#}\NormalTok{ b}
\NormalTok{      b}\KeywordTok{=.} \RegionMarkerTok{((}\NormalTok{l }\KeywordTok{*} \KeywordTok{\#}\NormalTok{ r}\RegionMarkerTok{)}\KeywordTok{$} \DecValTok{1} \DecValTok{0} \KeywordTok{\#\textasciitilde{}}\NormalTok{ q}\KeywordTok{,}\NormalTok{l}\KeywordTok{{-}}\NormalTok{q}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{,}\NormalTok{r }\KeywordTok{+/} \KeywordTok{i.}\NormalTok{ l}\RegionMarkerTok{)}\KeywordTok{\}}\NormalTok{ b}
      \KeywordTok{y=.}\NormalTok{ b }\KeywordTok{\#} \KeywordTok{y}
      \KeywordTok{if.}\NormalTok{ q }\KeywordTok{=} \DecValTok{0} \KeywordTok{do.} \KeywordTok{continue.} \KeywordTok{end.}  \CommentTok{NB. next for deletions}
    \KeywordTok{elseif.}\NormalTok{ s }\KeywordTok{=} \DecValTok{1} \KeywordTok{do.}
      \KeywordTok{y=.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \KeywordTok{>:}\NormalTok{ d r}\KeywordTok{\}}\NormalTok{ b            }\CommentTok{NB. first target char replicated}
    \KeywordTok{end.}
    \KeywordTok{y=.}\RegionMarkerTok{(}\NormalTok{c }\KeywordTok{$\textasciitilde{}}\NormalTok{ q }\KeywordTok{*\#}\NormalTok{ r}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{,}\NormalTok{p }\KeywordTok{+/i.}\NormalTok{ q}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}  \CommentTok{NB. insert replacements}
  \KeywordTok{end.}
\KeywordTok{end.} \KeywordTok{y}                              \CommentTok{NB. altered string}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{checknames}\AlertTok{=:}\index{checknames@\texttt{checknames}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*checknames v{-}{-} tests alleged  boxed lists of J names. Accepts}
\CommentTok{NB. all valid J  names. When (x{-}:1)  names  with embedded locale}
\CommentTok{NB. references  are  rejected  otherwise  embedded   locales  are}
\CommentTok{NB. accepted.}
\CommentTok{NB.}
\CommentTok{NB. monad:  checknames cl|blcl}
\CommentTok{NB.}
\CommentTok{NB.   checknames \textquotesingle{}we\textquotesingle{};\textquotesingle{}check\textquotesingle{};\textquotesingle{}out\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  pa checknames cl|blcl}
\CommentTok{NB.}
\CommentTok{NB.   0 checknames ;:\textquotesingle{}accept our\_poor\_ locale\_\_NAMES\textquotesingle{}}

\DecValTok{1}\NormalTok{ checknames }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR002  }\CommentTok{NB. errmsg: invalid name(s)}
\KeywordTok{if.} \DecValTok{1}\KeywordTok{<\#$} \KeywordTok{y}        \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{y=.} \KeywordTok{,\&.>}\NormalTok{ boxopen }\KeywordTok{y}   \CommentTok{NB. allow char lists}
\KeywordTok{if.} \KeywordTok{+./}\NormalTok{ badcl}\KeywordTok{\&>} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\KeywordTok{if.} \KeywordTok{x} \KeywordTok{do.}
  \CommentTok{NB. restrict embedded locales}
\NormalTok{  msg2}\KeywordTok{=.}\NormalTok{ ERR008  }\CommentTok{NB. errmsg: invalid names(s) {-} embedded locale references}
  \KeywordTok{if.} \StringTok{\textquotesingle{}\_\textquotesingle{}} \KeywordTok{e.} \KeywordTok{,} \DecValTok{\_1}\KeywordTok{\&\{.\&>} \KeywordTok{y}  \KeywordTok{do.}\NormalTok{ jderr msg2 }\KeywordTok{return.} \KeywordTok{end.}
  \KeywordTok{if.} \KeywordTok{+./} \KeywordTok{+./@:}\RegionMarkerTok{(}\StringTok{\textquotesingle{}\_\_\textquotesingle{}}\KeywordTok{\&E.}\RegionMarkerTok{)}\KeywordTok{\&>} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg2 }\KeywordTok{return.} \KeywordTok{end.}
  \KeywordTok{if.} \DecValTok{\_2} \KeywordTok{e.}\NormalTok{ nc }\KeywordTok{y}     \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{else.}
  \CommentTok{NB. permit embedded locales {-} test must eschew class tests}
  \CommentTok{NB. to avoid evaluation of indirect locale references}
  \KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{\#}\NormalTok{jnfrblcl }\KeywordTok{y}\RegionMarkerTok{)}\KeywordTok{\textasciitilde{}:\#y} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{end.}

\KeywordTok{if.}\NormalTok{ MAXNAME }\KeywordTok{<} \KeywordTok{>./} \KeywordTok{\#\&>} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR003 }\KeywordTok{return.} \KeywordTok{end.} \CommentTok{NB. errmsg: name(s) to long}
\NormalTok{ok trimnl }\KeywordTok{y}  \CommentTok{NB. return deblanked name list}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{checknttab}\AlertTok{=:}\index{checknttab@\texttt{checknttab}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*checknttab v{-}{-}  checks (name,text)  tables. A name text table}
\CommentTok{NB. is a two column boxed table. Column 0  contains valid  names.}
\CommentTok{NB. Column 1 contains character  lists representing various texts}
\CommentTok{NB. like J scripts, LaTeX or HTML code.}
\CommentTok{NB.}
\CommentTok{NB. monad:  checknttab btcl}
\CommentTok{NB.}
\CommentTok{NB.  checknttab (;:\textquotesingle{}n1 n2 n3\textquotesingle{}) ,. \textquotesingle{}blah blah..\textquotesingle{};\textquotesingle{}more ehh..\textquotesingle{};\textquotesingle{}stuff ...\textquotesingle{}}

\NormalTok{msg }\KeywordTok{=.}\NormalTok{ ERR014 }\CommentTok{NB. errmsg: invalid name and text}
\KeywordTok{if.}\NormalTok{ badbu }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \KeywordTok{{-}.} \DecValTok{1} \DecValTok{2} \KeywordTok{e.\textasciitilde{}} \KeywordTok{\#$} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \DecValTok{2} \KeywordTok{\textasciitilde{}:} \KeywordTok{\{:} \KeywordTok{$} \KeywordTok{y=.}\NormalTok{ plt }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \KeywordTok{+./}\NormalTok{badcl}\KeywordTok{\&>} \DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{checknames }\RegionMarkerTok{(}\KeywordTok{<a:;}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{\{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.}\NormalTok{ badunique uv}\KeywordTok{=.} \KeywordTok{\}.}\NormalTok{uv }\KeywordTok{do.}\NormalTok{ jderr ERR020}
\KeywordTok{elseif.do.}\NormalTok{ ok }\KeywordTok{<y=.}\NormalTok{ uv }\RegionMarkerTok{(}\KeywordTok{<a:;}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}  \CommentTok{NB. insures deblanked names}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{checknttab2}\AlertTok{=:}\index{checknttab2@\texttt{checknttab2}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*checknttab2 v{-}{-} checks (name,class,text) tables.  Similar  to}
\CommentTok{NB. (checknttab)  except the  additional column is a numeric name}
\CommentTok{NB. class or type code.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes checknttab2 btcl}
\CommentTok{NB.}
\CommentTok{NB.  (i.4) checknttab2 \textquotesingle{}name\textquotesingle{};3;\textquotesingle{}verb=: ...\textquotesingle{}}

\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR015 }\CommentTok{NB. errmsg: invalid name, class and text}
\KeywordTok{if.}\NormalTok{ badbu }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \KeywordTok{{-}.} \DecValTok{1} \DecValTok{2} \KeywordTok{e.\textasciitilde{}} \KeywordTok{\#$} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \DecValTok{3} \KeywordTok{\textasciitilde{}:} \KeywordTok{\{:} \KeywordTok{$} \KeywordTok{y=.}\NormalTok{ plt }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \KeywordTok{+./}\NormalTok{badcl}\KeywordTok{\&>} \KeywordTok{\{:"}\DecValTok{1} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.} \KeywordTok{x}\NormalTok{ badblia }\DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{checknames }\RegionMarkerTok{(}\KeywordTok{<a:;}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{\{y} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{elseif.}\NormalTok{ badunique uv}\KeywordTok{=.} \KeywordTok{\}.}\NormalTok{uv }\KeywordTok{do.}\NormalTok{ jderr ERR020}
\KeywordTok{elseif.do.}\NormalTok{ ok }\KeywordTok{<y=.}\NormalTok{ uv }\RegionMarkerTok{(}\KeywordTok{<a:;}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}  \CommentTok{NB. insures deblanked names}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{checknttab3}\AlertTok{=:}\index{checknttab3@\texttt{checknttab3}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*checknttab3 v{-}{-} checks all three (name,[class],text) tables.}
\CommentTok{NB.}
\CommentTok{NB. monad:  checknttab3 bt}

\KeywordTok{if.} \DecValTok{3} \KeywordTok{=}\NormalTok{ cols}\KeywordTok{=.} \KeywordTok{\{:$y} \KeywordTok{do.}
  \CommentTok{NB. there are two species of three column tables {-} words}
  \CommentTok{NB. and macros {-} distingquished by the codes in column 1}
  \KeywordTok{if.} \RegionMarkerTok{((}\KeywordTok{i.} \DecValTok{4}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{ MACROTYPE}\RegionMarkerTok{)}\NormalTok{ badblia }\DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR014}
  \CommentTok{NB. macro codes start at 21 much higher than J name class codes}
  \KeywordTok{elseif.} \DecValTok{3} \KeywordTok{<} \KeywordTok{<./} \KeywordTok{;}\DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y} \KeywordTok{do.}
\NormalTok{    MACROTYPE checknttab2 }\KeywordTok{y}
  \KeywordTok{elseif.} \KeywordTok{do.}
    \RegionMarkerTok{(}\KeywordTok{i.} \DecValTok{4}\RegionMarkerTok{)}\NormalTok{ checknttab2 }\KeywordTok{y}
  \KeywordTok{end.}
\KeywordTok{elseif.} \DecValTok{2} \KeywordTok{=}\NormalTok{ cols }\KeywordTok{do.}
  \CommentTok{NB. two column tables}
\NormalTok{  checknttab }\KeywordTok{y}
\KeywordTok{elseif.do.}\NormalTok{ jderr ERR014}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{createjod}\AlertTok{=:}\index{createjod@\texttt{createjod}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*createjod  v{-}{-}  dictionary  object  creation verb. (y)  is  a}
\CommentTok{NB. dictionary object locale reference. This verb initializes  an}
\CommentTok{NB. (ijod) locale user interface for the JOD system.  and creates}
\CommentTok{NB. all necessary subobjects.}
\CommentTok{NB.}
\CommentTok{NB. monad:  paRc =. createjod ba}
\CommentTok{NB.}
\CommentTok{NB.   JD=: conew \textquotesingle{}ajod\textquotesingle{}}
\CommentTok{NB.   createjod\_\_JD JD}

\CommentTok{NB. set default master, profile and user if they don\textquotesingle{}t exist}
\KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{wex }\KeywordTok{<}\StringTok{\textquotesingle{}JMASTER\textquotesingle{}} \KeywordTok{do.}\NormalTok{ JMASTER}\AlertTok{=:}\index{JMASTER@\texttt{JMASTER}}\NormalTok{ jodsystempath }\StringTok{\textquotesingle{}jmaster\textquotesingle{}} \KeywordTok{end.}
\KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{wex }\KeywordTok{<}\StringTok{\textquotesingle{}JODPROF\textquotesingle{}} \KeywordTok{do.}\NormalTok{ JODPROF}\AlertTok{=:}\index{JODPROF@\texttt{JODPROF}}\NormalTok{ jodsystempath }\StringTok{\textquotesingle{}jodprofile.ijs\textquotesingle{}} \KeywordTok{end.}
\KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{wex }\KeywordTok{<}\StringTok{\textquotesingle{}JODUSER\textquotesingle{}} \KeywordTok{do.}\NormalTok{ JODUSER}\AlertTok{=:}\index{JODUSER@\texttt{JODUSER}}\NormalTok{ jodsystempath }\StringTok{\textquotesingle{}joduserconfig.ijs\textquotesingle{}} \KeywordTok{end.}

\CommentTok{NB. set J version number}
\NormalTok{JVERSION\_ajod}\DecValTok{\_}\AlertTok{=:}\index{JVERSION\_ajod\_@\texttt{JVERSION\_ajod\_}}  \RegionMarkerTok{(}\NormalTok{jvn }\KeywordTok{::} \KeywordTok{\_9:}\RegionMarkerTok{)} \StringTok{\textquotesingle{}\textquotesingle{}}

\CommentTok{NB. create master file if necessary}
\KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{ fex }\KeywordTok{<}\NormalTok{JMASTER}\KeywordTok{,}\NormalTok{IJF }\KeywordTok{do.}
  \KeywordTok{if.}\NormalTok{ badrc mdat}\KeywordTok{=.}\NormalTok{ createmast JMASTER }\KeywordTok{do.}\NormalTok{ mdat }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{end.}

\CommentTok{NB. execute any user script {-} allows for redefintions of various}
\CommentTok{NB. class nouns before JOD objects are created {-} joduserconfig.ijs}
\CommentTok{NB. is not installed and must be created by users}
\KeywordTok{if.}\NormalTok{ fex }\KeywordTok{<}\NormalTok{JODUSER }\KeywordTok{do.}
  \CommentTok{NB. attempt execution of script {-} obfuscate names (/:)=:}
  \KeywordTok{if.} \RegionMarkerTok{(}\NormalTok{\_}\DecValTok{9} \KeywordTok{{-}:} \RegionMarkerTok{((}\DecValTok{0}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{::} \KeywordTok{\_9:}\RegionMarkerTok{)} \KeywordTok{<}\NormalTok{JODUSER}\RegionMarkerTok{)}\KeywordTok{\{}\DecValTok{0} \DecValTok{1} \KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{jderr ERR026}\RegionMarkerTok{)}\KeywordTok{,<}\DecValTok{13}\KeywordTok{!:}\DecValTok{12} \StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{end.}

\CommentTok{NB. initialize master dictionary parameters {-} used when}
\CommentTok{NB. creating directory objects to insure that all master}
\CommentTok{NB. parameters are set in directory objects {-} this amends}
\CommentTok{NB. the "jod" class to exploit inheritance in all derived classes}
\KeywordTok{if.}\NormalTok{ badjr mdat}\KeywordTok{=.}\NormalTok{ jread JMASTER}\KeywordTok{;}\NormalTok{CNMFPARMS }\KeywordTok{do.}\NormalTok{ jderr ERR006 }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{MASTERPARMS\_ajod}\DecValTok{\_}\AlertTok{=:}\index{MASTERPARMS\_ajod\_@\texttt{MASTERPARMS\_ajod\_}}  \KeywordTok{>}\NormalTok{ mdat}

\CommentTok{NB. extension objects and complete (ijod) interface (*)=. JODEXT IZJODALL}
\NormalTok{JODEXT}\AlertTok{=:}\index{JODEXT@\texttt{JODEXT}}  \DecValTok{0}\KeywordTok{$a:}
\NormalTok{IZJODALL}\AlertTok{=:}\index{IZJODALL@\texttt{IZJODALL}}\NormalTok{  IzJODinterface}\KeywordTok{,<}\StringTok{\textquotesingle{}JODobj\textquotesingle{}}

\CommentTok{NB. create storage, scratch, maker and utility objects !(*)=. JOD ST SO MK UT}
\NormalTok{JOD}\AlertTok{=:}\index{JOD@\texttt{JOD}}  \KeywordTok{y}
\NormalTok{ST}\AlertTok{=:}\index{ST@\texttt{ST}}\NormalTok{  conew }\StringTok{\textquotesingle{}ajodstore\textquotesingle{}}
\NormalTok{MK}\AlertTok{=:}\index{MK@\texttt{MK}}\NormalTok{  conew }\StringTok{\textquotesingle{}ajodmake\textquotesingle{}}
\NormalTok{UT}\AlertTok{=:}\index{UT@\texttt{UT}}\NormalTok{  conew }\StringTok{\textquotesingle{}ajodutil\textquotesingle{}}

\CommentTok{NB. empty classless object {-} must see ijod}
\NormalTok{SO}\AlertTok{=:}\index{SO@\texttt{SO}}\NormalTok{  cocreate }\StringTok{\textquotesingle{}\textquotesingle{}}
\RegionMarkerTok{(}\StringTok{\textquotesingle{}ijod\textquotesingle{}}\KeywordTok{;}\StringTok{\textquotesingle{}z\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ copath }\KeywordTok{;}\NormalTok{SO}

\NormalTok{obs}\KeywordTok{=.}\NormalTok{ JOD}\KeywordTok{;}\NormalTok{ST}\KeywordTok{;}\NormalTok{MK}\KeywordTok{;}\NormalTok{UT}\KeywordTok{;<}\NormalTok{SO}

\CommentTok{NB. initialize objects {-} they need to know each other}
\NormalTok{createst}\DecValTok{\_\_}\NormalTok{ST obs}
\NormalTok{createmk}\DecValTok{\_\_}\NormalTok{MK obs}
\NormalTok{createut}\DecValTok{\_\_}\NormalTok{UT obs}

\CommentTok{NB. create direct \_n\_ (ijod) locale interface {-} if the (ijod)}
\CommentTok{NB. trap word (jodsf) exists define an error trapping interface}
\KeywordTok{".\&.>} \KeywordTok{y}\NormalTok{ defzface IzJODinterface}

\CommentTok{NB. attempt to create J temp directory ignoring errors}
\CommentTok{NB. required for JOD edit utilities and not always present on J systems}
\NormalTok{makedir }\KeywordTok{<}\NormalTok{jpath }\StringTok{\textquotesingle{}\textasciitilde{}temp/\textquotesingle{}}

\CommentTok{NB. execute any master dictionary profile script}
\KeywordTok{if.}\NormalTok{ fex }\KeywordTok{<}\NormalTok{JODPROF }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{\_}\DecValTok{9} \KeywordTok{{-}:} \RegionMarkerTok{((}\DecValTok{0}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{::} \KeywordTok{\_9:}\RegionMarkerTok{)} \KeywordTok{<}\NormalTok{JODPROF}\RegionMarkerTok{)}\KeywordTok{\{}\DecValTok{1} \DecValTok{0} \KeywordTok{else.} \DecValTok{1} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{createmast}\AlertTok{=:}\index{createmast@\texttt{createmast}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*createmast v{-}{-} creates the dictionary master file. The master}
\CommentTok{NB. file  holds  the  master dictionary  directory and dictionary}
\CommentTok{NB. parameters. The master file tracks the state of dictionaries.}
\CommentTok{NB. In  this  system  only  one   task  can   open  a  dictionary}
\CommentTok{NB. read/write. When  opening a  dictionary  the master  file  is}
\CommentTok{NB. checked to  determine  if  the  dictionary  has  been  opened}
\CommentTok{NB. read/write  by  another  task.  Dictionaries  can  be  opened}
\CommentTok{NB. read/only by any number of tasks.}
\CommentTok{NB.}
\CommentTok{NB. monad:  createmast clFile}
\CommentTok{NB.}
\CommentTok{NB.   createmast\_ajod\_  JMASTER\_ajod\_  NB. recreate master}

\NormalTok{fn}\KeywordTok{=.}\NormalTok{  hostsep }\KeywordTok{y}
\KeywordTok{if.}\NormalTok{ IFWIN }\KeywordTok{do.}
\NormalTok{  syp}\KeywordTok{=.}\NormalTok{ PATHDEL }\KeywordTok{,\textasciitilde{}} \RegionMarkerTok{(}\NormalTok{justdrv }\KeywordTok{,} \StringTok{\textquotesingle{}:\textquotesingle{}}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{,}\NormalTok{ justpath}\RegionMarkerTok{)}\NormalTok{ fn}
\KeywordTok{else.}
\NormalTok{  syp}\KeywordTok{=.}\NormalTok{ PATHDEL }\KeywordTok{,\textasciitilde{}}\NormalTok{ justpath fn}
\KeywordTok{end.}

\KeywordTok{if.}\NormalTok{ badappend jcreate fn }\KeywordTok{do.}
\NormalTok{  jderr ERR011 }\CommentTok{NB. errmsg: error(s) creating dictionary master file}
  \KeywordTok{return.}
\KeywordTok{end.}

\NormalTok{fn}\KeywordTok{=.}\NormalTok{ jopen\_jfiles}\DecValTok{\_}\NormalTok{ fn}
\NormalTok{cn}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\DecValTok{0}\KeywordTok{;}\NormalTok{now }\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ jappend fn     }\CommentTok{NB. c0 use bit and last change}
\StringTok{\textquotesingle{}jodversion jodbuildcnt\textquotesingle{}}\KeywordTok{=.} \DecValTok{2}\KeywordTok{\{.}\NormalTok{JODVMD}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{jodversion}\KeywordTok{;}\NormalTok{jodbuildcnt}\KeywordTok{,}\NormalTok{didnum }\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ jappend fn  }\CommentTok{NB. c1 version, build \#, unique id}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,} \RegionMarkerTok{(}\DecValTok{4} \DecValTok{0}\KeywordTok{$}\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ jappend fn    }\CommentTok{NB. c2 dictionary directory}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,} \RegionMarkerTok{(}\DecValTok{4} \DecValTok{0}\KeywordTok{$}\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ jappend fn    }\CommentTok{NB. c3 directory backup}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,} \RegionMarkerTok{(}\DecValTok{3}\KeywordTok{\#<}\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\NormalTok{ jappend fn     }\CommentTok{NB. c4,c5,c6 RESERVED}

\CommentTok{NB. parse parameter settings {-}{-}{-} sets (MASTERPARMS)}
\KeywordTok{try.}
  \DecValTok{0}\KeywordTok{!:}\DecValTok{0} \KeywordTok{<}\NormalTok{syp}\KeywordTok{,}\NormalTok{PARMFILE}
\NormalTok{  parms}\KeywordTok{=.} \KeywordTok{<}\NormalTok{dptable MASTERPARMS    }\CommentTok{NB. created by 0!:0 !(*)=. MASTERPARMS}
\KeywordTok{catchd.}
\NormalTok{  jclose\_jfiles}\DecValTok{\_}\NormalTok{ fn}
  \RegionMarkerTok{(}\NormalTok{jderr ERR027}\RegionMarkerTok{)}\KeywordTok{,<}\NormalTok{syp}\KeywordTok{,}\NormalTok{PARMFILE }\KeywordTok{return.}
\KeywordTok{end.}

\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,}\NormalTok{ parms jappend fn       }\CommentTok{NB. c7 active dictionary parameters}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,}\NormalTok{ parms jappend fn       }\CommentTok{NB. c8 active parameter backup}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,}\NormalTok{ parms jappend fn       }\CommentTok{NB. c9 default parameters}
\NormalTok{cn}\KeywordTok{=.}\NormalTok{ cn}\KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{i.}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ jappend fn       }\CommentTok{NB. c10 dictionary log}
\NormalTok{jclose\_jfiles}\DecValTok{\_}\NormalTok{ fn}
\KeywordTok{if.} \DecValTok{0} \KeywordTok{>} \KeywordTok{<./}\NormalTok{cn }\KeywordTok{do.}
\NormalTok{  jderr ERR011}
\KeywordTok{else.}
\NormalTok{  ok }\KeywordTok{\{:}\NormalTok{ cn  }\CommentTok{NB. return last component}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. character table to newline delimited list}
\NormalTok{ctl}\AlertTok{=:}\index{ctl@\texttt{ctl}} \KeywordTok{\}.@}\RegionMarkerTok{(}\KeywordTok{,@}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{,"}\DecValTok{1}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{{-}.@}\RegionMarkerTok{(}\KeywordTok{*./\textbackslash{}."}\DecValTok{1}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{=\&}\StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{@]}\RegionMarkerTok{))))} \KeywordTok{\#} \KeywordTok{,@}\RegionMarkerTok{((}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{,"}\DecValTok{1}\RegionMarkerTok{)}\KeywordTok{@]}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. YYYYMMDD to YYYY MM DD {-} see long document}
\NormalTok{datefrnum}\AlertTok{=:}\index{datefrnum@\texttt{datefrnum}} \DecValTok{0} \DecValTok{100} \DecValTok{100}\KeywordTok{\&\#:@<.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. enclose all character lists in blcl in " quotes}
\NormalTok{dblquote}\AlertTok{=:}\index{dblquote@\texttt{dblquote}} \StringTok{\textquotesingle{}"\textquotesingle{}}\KeywordTok{\&,@:}\RegionMarkerTok{(}\KeywordTok{,\&}\StringTok{\textquotesingle{}"\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{\&.>}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{decomm}\AlertTok{=:}\index{decomm@\texttt{decomm}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*decomm v{-}{-}  removes comments  from j words. The (x) argument}
\CommentTok{NB. specifies whether all blank lines are removed or retained.}
\CommentTok{NB.}
\CommentTok{NB. monad:  decomm ctWord}
\CommentTok{NB.}
\CommentTok{NB.   decomm jcr \textquotesingle{}decomm\textquotesingle{}  NB. decomment self}
\CommentTok{NB.}
\CommentTok{NB. dyad:  pa decomm ctWord}
\CommentTok{NB.}
\CommentTok{NB.   1 decomm jcr \textquotesingle{}decomm\textquotesingle{}  NB. remove blanks (default)}
\CommentTok{NB.   0 decomm jcr \textquotesingle{}decomm\textquotesingle{}  NB. retain all blank lines}

\DecValTok{1}\NormalTok{ decomm }\KeywordTok{y}
\KeywordTok{:}
\CommentTok{NB. mask of unquoted comment starts}
\NormalTok{c}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{$y}\RegionMarkerTok{)}\KeywordTok{$}\StringTok{\textquotesingle{}NB.\textquotesingle{}} \KeywordTok{E.} \KeywordTok{,y}
\NormalTok{c}\KeywordTok{=.} \KeywordTok{+./\textbackslash{}"}\DecValTok{1}\NormalTok{ c }\KeywordTok{>} \KeywordTok{\textasciitilde{}:/\textbackslash{}"}\DecValTok{1} \KeywordTok{y} \KeywordTok{e.} \StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}

\CommentTok{NB. ,, work around for j8.05 bug {-} remove when fixed}
\KeywordTok{y=.} \KeywordTok{,,y}

\CommentTok{NB. blank out comments}
\KeywordTok{y=.} \StringTok{\textquotesingle{} \textquotesingle{}} \RegionMarkerTok{(}\KeywordTok{I.} \KeywordTok{,}\NormalTok{c}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}
\KeywordTok{y=.} \KeywordTok{y} \KeywordTok{$\textasciitilde{}} \KeywordTok{$}\NormalTok{c}

\CommentTok{NB. remove blank lines {-} default}
\KeywordTok{if.} \KeywordTok{x} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \KeywordTok{y} \KeywordTok{+./} \KeywordTok{.} \KeywordTok{\textasciitilde{}:} \StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{defzface}\AlertTok{=:}\index{defzface@\texttt{defzface}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*defzface v{-}{-} define (ijod) interface from word list.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  blcl =. clSuffix defzface blclWords}

\CommentTok{NB. if the top level error trap word exists}
\CommentTok{NB. define an error trapping interface}
\KeywordTok{if.} \DecValTok{3} \KeywordTok{=} \RegionMarkerTok{(}\DecValTok{4}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{<}\StringTok{\textquotesingle{}jodsf\_ijod\_\textquotesingle{}} \KeywordTok{do.}
\NormalTok{  iface}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{y} \KeywordTok{,\&.>}\NormalTok{ locsfx }\KeywordTok{x}\RegionMarkerTok{)} \KeywordTok{,\&.>} \KeywordTok{<}\StringTok{\textquotesingle{} :: jodsf\textquotesingle{}}
\KeywordTok{else.}
\NormalTok{  iface}\KeywordTok{=.} \KeywordTok{y} \KeywordTok{,\&.>}\NormalTok{ locsfx }\KeywordTok{x}
\KeywordTok{end.}
\RegionMarkerTok{(}\KeywordTok{y} \KeywordTok{,\&.>} \KeywordTok{<}\StringTok{\textquotesingle{}\_ijod\_=:\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ iface}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{del}\AlertTok{=:}\index{del@\texttt{del}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*del v{-}{-} deletes objects in dictionary database  files. Result}
\CommentTok{NB. is  a return code and message. The deletion only modifies the}
\CommentTok{NB. object\textquotesingle{}s directory. The  actual data  remains in the file  as}
\CommentTok{NB. "dead"  components  until a (packd)  operation reclaims  file}
\CommentTok{NB. space.}
\CommentTok{NB.}
\CommentTok{NB. monad:  del blclWords}
\CommentTok{NB.}
\CommentTok{NB.   del ;: \textquotesingle{}we are toast\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  iaObject del blclName}
\CommentTok{NB.}
\CommentTok{NB.   1 del \textquotesingle{}toast these tests\textquotesingle{}}

\NormalTok{WORD del }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001}
\KeywordTok{if.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. do we have a put dictionary open?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{DL}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\{}\NormalTok{ uv}

\KeywordTok{select.} \KeywordTok{x}
\KeywordTok{case.}\NormalTok{ WORD }\KeywordTok{do.}
  \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;}\NormalTok{INVWORDS}\DecValTok{\_\_}\NormalTok{ST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ delstuff}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{case.}\NormalTok{ TEST }\KeywordTok{do.}
  \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{;}\NormalTok{INVTESTS}\DecValTok{\_\_}\NormalTok{ST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ delstuff}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{case.}\NormalTok{ GROUP }\KeywordTok{do.}
  \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{;}\NormalTok{INVGROUPS}\DecValTok{\_\_}\NormalTok{ST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ delstuff}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{case.}\NormalTok{ SUITE }\KeywordTok{do.}
  \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{;}\NormalTok{INVSUITES}\DecValTok{\_\_}\NormalTok{ST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ delstuff}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{case.}\NormalTok{ MACRO }\KeywordTok{do.}
  \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{;}\NormalTok{INVMACROS}\DecValTok{\_\_}\NormalTok{ST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ delstuff}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{case.}\NormalTok{ REFERENCE }\KeywordTok{do.}
  \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{ checknames }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y}
  \KeywordTok{elseif.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ DL delwordrefs}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{\}.} \KeywordTok{y} \KeywordTok{do.}\NormalTok{ msg}
  \KeywordTok{elseif.do.} \RegionMarkerTok{(}\NormalTok{ok OK009}\RegionMarkerTok{)}\KeywordTok{,<}\NormalTok{DNAME}\DecValTok{\_\_}\NormalTok{DL}
  \KeywordTok{end.}
\KeywordTok{case.} \KeywordTok{do.}\NormalTok{ jderr msg}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{destroyjod}\AlertTok{=:}\index{destroyjod@\texttt{destroyjod}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*destroyjod v{-}{-}  dictionary  object  destroy  verb.  This  verb}
\CommentTok{NB. erases the JOD (ijod) locale user interface.}
\CommentTok{NB.}
\CommentTok{NB. monad:  destroyjd uuIgnore}

\CommentTok{NB. close any open dictionaries}
\DecValTok{3}\NormalTok{ od }\StringTok{\textquotesingle{}\textquotesingle{}}

\CommentTok{NB. erase current direct \_n\_ ijod locale references}
\CommentTok{NB. (*)=. IZJODALL JODEXT}
\RegionMarkerTok{(}\DecValTok{4}\KeywordTok{!:}\DecValTok{55}\RegionMarkerTok{)}\NormalTok{ IZJODALL }\KeywordTok{,\&.>}\NormalTok{ locsfx }\StringTok{\textquotesingle{}z\textquotesingle{}}

\CommentTok{NB. destroy sub{-}objects !(*)=. ST MK UT SO}
\NormalTok{coerase ST}\KeywordTok{,}\NormalTok{MK}\KeywordTok{,}\NormalTok{UT}\KeywordTok{,}\NormalTok{SO}

\CommentTok{NB. destroy any JOD class extension objects}
\NormalTok{coerase JODEXT}

\CommentTok{NB. return self reference}
\DecValTok{18}\KeywordTok{!:}\DecValTok{5} \StringTok{\textquotesingle{}\textquotesingle{}}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{did}\AlertTok{=:}\index{did@\texttt{did}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*did v{-}{-} dictionary identification and statistics}
\CommentTok{NB.}
\CommentTok{NB. monad:  did uuIgnore}
\CommentTok{NB. dyad:  uuIgnore did uuIgnore}

\KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{else.}\NormalTok{ ok }\KeywordTok{\{."}\DecValTok{1}\NormalTok{ DPATH}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{end.}
\KeywordTok{:}
\DecValTok{0}\NormalTok{ didstats}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{didnum}\AlertTok{=:}\index{didnum@\texttt{didnum}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*didnum  v{-}{-}  generates  a  unique extended  precision integer}
\CommentTok{NB. based GUID.  The GUID is designed to produce a unique  global}
\CommentTok{NB. identifier every time it\textquotesingle{}s called.}
\CommentTok{NB.}
\CommentTok{NB. monad:  didnum uuIgnore}

\CommentTok{NB. Original Windows only code}
\CommentTok{NB. call dll to get GUID}
\CommentTok{NB. guid=. genguid <16\#\textquotesingle{} \textquotesingle{}}
\CommentTok{NB. if. 0 \textasciitilde{}: >\{. guid do. jderr ERR021}
\CommentTok{NB. else.}
\CommentTok{NB.  NB. guid as 128 bit mask}
\CommentTok{NB.  guid=. , (a. i. >\{: guid)\{ truth 8}
\CommentTok{NB.}
\CommentTok{NB.  NB. convert mask to an integer computing}
\CommentTok{NB.  NB. only required extended powers of 2}
\CommentTok{NB.  pos=. I. guid}
\CommentTok{NB.  +/(2x \^{} pos) pos\} guid}
\CommentTok{NB. end.}

\CommentTok{NB. More general Win/Linux/Mac code}
\NormalTok{guidsx }\KeywordTok{i.}\DecValTok{0}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dnl}\AlertTok{=:}\index{dnl@\texttt{dnl}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*dnl v{-}{-} list objects in dictionary database files.}
\CommentTok{NB.}
\CommentTok{NB. monad:  dnl clStr|zlStr}
\CommentTok{NB.}
\CommentTok{NB.   dnl \textquotesingle{}\textquotesingle{}        NB. list all words on path}
\CommentTok{NB.   dnl \textquotesingle{}pfx\textquotesingle{}     NB. list all words on path begining with \textquotesingle{}pfx\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes dnl clStr|zlStr}
\CommentTok{NB.}
\CommentTok{NB.   4 2  dnl \textquotesingle{}ex\textquotesingle{}  NB. macros with names containing \textquotesingle{}ex\textquotesingle{}}
\CommentTok{NB.   0 \_3 dnl \textquotesingle{}ugh\textquotesingle{} NB. path order listing of words ending with \textquotesingle{}ugh\textquotesingle{}}

\NormalTok{WORD dnl }\KeywordTok{y}
\KeywordTok{:}
\KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.x}\NormalTok{ nlargs }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. format standard (dnl) (x) options and search}
\KeywordTok{x=.}  \KeywordTok{x} \KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{<:\#x}\RegionMarkerTok{)}\KeywordTok{\}.} \DecValTok{1} \KeywordTok{,}\NormalTok{ DEFAULT}
\KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{\{.} \KeywordTok{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ OBJECTNC }\KeywordTok{do.} \KeywordTok{x}\NormalTok{ dnlsearch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{else.}\NormalTok{ jderr ERR001 }\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dpset}\AlertTok{=:}\index{dpset@\texttt{dpset}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*dpset v{-}{-} set dictionary parameters.}
\CommentTok{NB.}
\CommentTok{NB. monad:  dpset zl | clCommand | (cllParm ; uuValue)}
\CommentTok{NB. dyad:  iaCode dpset (clParm ; uuValue)}

\CommentTok{NB. objects !(*)=. DL ST}
\CommentTok{NB. allow mixed assignments (<:)=:}

\CommentTok{NB. resets should always work {-} close any open dictionaries}
\KeywordTok{if.} \KeywordTok{y} \KeywordTok{{-}:} \StringTok{\textquotesingle{}RESETME\textquotesingle{}} \KeywordTok{do.}
  \DecValTok{3}\NormalTok{ od }\StringTok{\textquotesingle{}\textquotesingle{}} \CommentTok{NB. HARDCODE 3 close code}
  \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ markmast}\KeywordTok{\textasciitilde{}}\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{else.}\NormalTok{ ok OK004 }\KeywordTok{[}\NormalTok{ remast }\DecValTok{1} \KeywordTok{end.}
\KeywordTok{elseif.} \KeywordTok{y} \KeywordTok{{-}:} \StringTok{\textquotesingle{}RESETALL\textquotesingle{}} \KeywordTok{do.}
  \DecValTok{3}\NormalTok{ od }\StringTok{\textquotesingle{}\textquotesingle{}} \CommentTok{NB. HARDCODE 3 close code}
  \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ markmast}\KeywordTok{\textasciitilde{}}\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{else.}\NormalTok{ ok OK004 }\KeywordTok{[}\NormalTok{ remast }\DecValTok{0} \KeywordTok{end.}
\KeywordTok{elseif.do.}
  \CommentTok{NB. other options require an open dictionary}
  \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{  DL}\KeywordTok{=.}  \KeywordTok{\{:\{.}\NormalTok{DPATH}\DecValTok{\_\_}\NormalTok{ST}

  \KeywordTok{if.}\NormalTok{ isempty }\KeywordTok{y} \KeywordTok{do.}
    \CommentTok{NB. display settable parameters of put/first with current values}
\NormalTok{    ok }\KeywordTok{<|:>\{:>}\NormalTok{jread WF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{CNPARMS}\DecValTok{\_\_}\NormalTok{ST}

  \KeywordTok{elseif.} \KeywordTok{{-}.}\NormalTok{badcl }\KeywordTok{y} \KeywordTok{do.}
    \CommentTok{NB. if we are resetting READWRITE status dictionary need only be open}
    \KeywordTok{if.} \StringTok{\textquotesingle{}READWRITE\textquotesingle{}}\KeywordTok{{-}:y} \KeywordTok{do.}

      \CommentTok{NB. check attributes of READONLY dictionary to insure}
      \CommentTok{NB. that it will allow read/write operations on all files}
\NormalTok{      dcfiles}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{WF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{TF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{GF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{SF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{MF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{UF}\DecValTok{\_\_}\NormalTok{DL}\RegionMarkerTok{)} \KeywordTok{,\&.>} \KeywordTok{<}\NormalTok{IJF}
      \CommentTok{NB. err msg (JODstore errors): dictionary file attributes do not allow read/write}
      \KeywordTok{if.} \DecValTok{0} \KeywordTok{e.}\NormalTok{ iswriteable}\DecValTok{\_\_}\NormalTok{ST dcfiles }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{jderr ERR095}\DecValTok{\_\_}\NormalTok{ST}\RegionMarkerTok{)}\KeywordTok{,<}\NormalTok{DNAME}\DecValTok{\_\_}\NormalTok{DL }\KeywordTok{return.} \KeywordTok{end.}

      \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{libstatus}\DecValTok{\_\_}\NormalTok{DL }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg}
      \KeywordTok{else.}
\NormalTok{        RW}\DecValTok{\_\_}\NormalTok{DL}\AlertTok{=:}\index{RW\_\_DL@\texttt{RW\_\_DL}}  \KeywordTok{{-}.}\NormalTok{ LIBSTATUS}\DecValTok{\_\_}\NormalTok{DL}\AlertTok{=:}\index{LIBSTATUS\_\_DL@\texttt{LIBSTATUS\_\_DL}}  \DecValTok{0}  \CommentTok{NB. library off/read write}
\NormalTok{        ok OK008}\KeywordTok{;}\NormalTok{DNAME}\DecValTok{\_\_}\NormalTok{DL}
      \KeywordTok{end.}
      \KeywordTok{return.}
    \KeywordTok{end.}
    \CommentTok{NB. other changes of dictionary parameters require a put dictionary}
    \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{select.} \KeywordTok{y}
    \KeywordTok{case.} \StringTok{\textquotesingle{}DEFAULTS\textquotesingle{}} \KeywordTok{do.}
      \KeywordTok{if.}\NormalTok{ badjr dat}\KeywordTok{=.}\NormalTok{ jread JMASTER}\KeywordTok{;}\NormalTok{CNMFPARMDEFS   }\KeywordTok{do.}\NormalTok{ jderr ERR088}
      \KeywordTok{elseif.}\NormalTok{ badjr dpt}\KeywordTok{=.}\NormalTok{ jread WF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{CNPARMS}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{do.}\NormalTok{ jderr ERR088}
      \KeywordTok{elseif.}\NormalTok{ dpt}\KeywordTok{=.} \KeywordTok{<}\RegionMarkerTok{(}\KeywordTok{\}:>}\NormalTok{dpt}\RegionMarkerTok{)}\KeywordTok{,<|:} \DecValTok{1} \DecValTok{0} \DecValTok{1}\KeywordTok{\#"}\DecValTok{1}\NormalTok{ dat}\KeywordTok{=.} \KeywordTok{>}\NormalTok{dat}
\NormalTok{              badreps dpt jreplace WF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{CNPARMS}\DecValTok{\_\_}\NormalTok{ST  }\KeywordTok{do.}\NormalTok{ jderr ERR017}
      \KeywordTok{elseif.do.}
        \CommentTok{NB. reset live object parameters}
        \RegionMarkerTok{((}\KeywordTok{\{."}\DecValTok{1}\NormalTok{ dat}\RegionMarkerTok{)} \KeywordTok{,\&.>}\NormalTok{ locsfx DL}\RegionMarkerTok{)}\AlertTok{=:}\index{01indirect@\texttt{(...)=:}}  \KeywordTok{\{:"}\DecValTok{1}\NormalTok{ dat}
\NormalTok{        ok OK003}\KeywordTok{;}\NormalTok{DNAME}\DecValTok{\_\_}\NormalTok{DL}
      \KeywordTok{end.}
    \KeywordTok{case.} \StringTok{\textquotesingle{}CLEARPATH\textquotesingle{}} \KeywordTok{do.}
\NormalTok{      RPATH}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{=.} \KeywordTok{i.}\DecValTok{0}
      \KeywordTok{if.}\NormalTok{ badreps }\RegionMarkerTok{(}\KeywordTok{i.}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ jreplace UF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{CNRPATH}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{do.}
\NormalTok{        jderr ERR017}
      \KeywordTok{else.}
\NormalTok{        ok OK005}\KeywordTok{;}\NormalTok{DNAME}\DecValTok{\_\_}\NormalTok{DL}
      \KeywordTok{end.}
    \KeywordTok{case.} \StringTok{\textquotesingle{}READONLY\textquotesingle{}} \KeywordTok{do.}
      \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{libstatus}\DecValTok{\_\_}\NormalTok{DL }\DecValTok{1} \KeywordTok{do.}\NormalTok{ msg}
      \KeywordTok{else.}
\NormalTok{        RW}\DecValTok{\_\_}\NormalTok{DL}\AlertTok{=:}\index{RW\_\_DL@\texttt{RW\_\_DL}}  \KeywordTok{{-}.}\NormalTok{ LIBSTATUS}\DecValTok{\_\_}\NormalTok{DL}\AlertTok{=:}\index{LIBSTATUS\_\_DL@\texttt{LIBSTATUS\_\_DL}}  \DecValTok{1}  \CommentTok{NB. library on/read only}
\NormalTok{        ok OK007}\KeywordTok{;}\NormalTok{DNAME}\DecValTok{\_\_}\NormalTok{DL}
      \KeywordTok{end.}
    \KeywordTok{case.do.}\NormalTok{ jderr ERR001}
    \KeywordTok{end.}

  \KeywordTok{elseif.} \KeywordTok{{-}.}\NormalTok{badbu }\KeywordTok{y} \KeywordTok{do.}
    \CommentTok{NB. parameter changes only allowed for put dictionaries}
    \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{    msg}\KeywordTok{=.}\NormalTok{ ERR019  }\CommentTok{NB. errmsg: invalid name/parameter}
    \KeywordTok{if.} \KeywordTok{{-}.} \RegionMarkerTok{(}\DecValTok{1}\KeywordTok{=\#$} \KeywordTok{y}\RegionMarkerTok{)} \KeywordTok{*.} \DecValTok{2}\KeywordTok{=\#y} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badjr dpt}\KeywordTok{=.}\NormalTok{ jread WF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{CNPARMS}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{do.}\NormalTok{ jderr ERR088 }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{    usp}\KeywordTok{=.} \KeywordTok{>\{:}\NormalTok{dpt}\KeywordTok{=.} \KeywordTok{>}\NormalTok{dpt}
    \KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{\{:$}\NormalTok{usp}\RegionMarkerTok{)} \KeywordTok{=}\NormalTok{ pos}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{\{.}\NormalTok{usp}\RegionMarkerTok{)} \KeywordTok{i.} \KeywordTok{\{.y} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{>}\NormalTok{pos}\KeywordTok{\{\{:}\NormalTok{usp}\RegionMarkerTok{)}\NormalTok{ badsts }\KeywordTok{>\{:y} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
    \CommentTok{NB. reset live object}
    \RegionMarkerTok{(}\StringTok{\textquotesingle{}\_\_DL\textquotesingle{}} \KeywordTok{,\textasciitilde{}} \KeywordTok{>}\NormalTok{pos}\KeywordTok{\{\{.}\NormalTok{usp}\RegionMarkerTok{)}\AlertTok{=:}\index{01indirect@\texttt{(...)=:}}  \KeywordTok{>\{:y}
\NormalTok{    dpt}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{\}:}\NormalTok{dpt}\RegionMarkerTok{)}\KeywordTok{,<}\NormalTok{usp}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{\{:y}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{<}\DecValTok{1}\KeywordTok{;}\NormalTok{pos}\RegionMarkerTok{)}\KeywordTok{\}}\NormalTok{ usp}
    \KeywordTok{if.}\NormalTok{ badreps }\RegionMarkerTok{(}\KeywordTok{<}\NormalTok{dpt}\RegionMarkerTok{)}\NormalTok{ jreplace WF}\DecValTok{\_\_}\NormalTok{DL}\KeywordTok{;}\NormalTok{CNPARMS}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{do.}\NormalTok{ jderr ERR017 }\KeywordTok{else.}\NormalTok{ ok OK006}\KeywordTok{;y} \KeywordTok{end.}

  \KeywordTok{elseif.do.}\NormalTok{ jderr ERR001}
  \KeywordTok{end.}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dptable}\AlertTok{=:}\index{dptable@\texttt{dptable}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*dptable  v{-}{-}  parses MASTERPARMS.}
\CommentTok{NB.}
\CommentTok{NB. (MASTERPARMS) is set by running the script (jodparms.ijs).}
\CommentTok{NB.}
\CommentTok{NB. monad:  dptable clParms}
\CommentTok{NB.}
\CommentTok{NB.   0!:0 <jpath \textquotesingle{}\textasciitilde{}addons\textbackslash{}general\textbackslash{}jodparms.ijs\textquotesingle{}}
\CommentTok{NB.   dptable\_\_JODobj  MASTERPARMS}

\CommentTok{NB. parse MASTERPARMS table {-} remove J comments}
\KeywordTok{y=.} \RegionMarkerTok{(}\KeywordTok{<;.}\NormalTok{\_}\DecValTok{1}\RegionMarkerTok{)}\KeywordTok{"}\DecValTok{1}  \StringTok{\textquotesingle{};\textquotesingle{}} \KeywordTok{,.}\NormalTok{ decomm }\KeywordTok{];.}\NormalTok{\_}\DecValTok{2} \KeywordTok{y} \KeywordTok{{-}.}\NormalTok{ CR}

\CommentTok{NB. remove extra blanks}
\KeywordTok{y=.} \RegionMarkerTok{(}\NormalTok{alltrim}\KeywordTok{\&.>}\RegionMarkerTok{(}\KeywordTok{<a:;}\DecValTok{0} \DecValTok{1}\RegionMarkerTok{)}\KeywordTok{\{y}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{<a:;}\DecValTok{0} \DecValTok{1}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}

\CommentTok{NB. handle parm types currently only (+integer) and (character)}
\CommentTok{NB. NIMP {-} there is no error checking for dictionary parameters}
\NormalTok{ptype}\KeywordTok{=.} \KeywordTok{>} \DecValTok{1}\KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}
\NormalTok{pint}\KeywordTok{=.} \KeywordTok{I.} \RegionMarkerTok{(}\KeywordTok{,:}\StringTok{\textquotesingle{}(+integer)\textquotesingle{}}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{\{."}\DecValTok{1}\RegionMarkerTok{)}\KeywordTok{@E.}\NormalTok{ ptype}

\CommentTok{NB. character and other types left as is}
\CommentTok{NB. char=. I. (,:\textquotesingle{}(character)\textquotesingle{}) (\{."1)@E. ptype}
\KeywordTok{y=.} \RegionMarkerTok{(}\KeywordTok{".\&.>} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{pint}\KeywordTok{;}\DecValTok{2}\RegionMarkerTok{)}\KeywordTok{\{y}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{<}\NormalTok{pint}\KeywordTok{;}\DecValTok{2}\RegionMarkerTok{)}\KeywordTok{\}} \KeywordTok{y}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if empty dictionary name list 0 otherwise}
\NormalTok{empdnl}\AlertTok{=:}\index{empdnl@\texttt{empdnl}} \RegionMarkerTok{(}\KeywordTok{,<}\DecValTok{0}\KeywordTok{$}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{{-}:} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. test boxed list of path\textbackslash{}file names for existence (0 some bad, 1 all ok)}
\NormalTok{fex}\AlertTok{=:}\index{fex@\texttt{fex}} \KeywordTok{*./@:}\RegionMarkerTok{(}\KeywordTok{1:@}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{!:}\DecValTok{4}\RegionMarkerTok{)} \KeywordTok{::0:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 0\textquotesingle{}s all but the first 1 in runs of 1\textquotesingle{}s}
\NormalTok{firstone}\AlertTok{=:}\index{firstone@\texttt{firstone}} \KeywordTok{]} \KeywordTok{>} \KeywordTok{[:} \KeywordTok{\}:} \KeywordTok{0:} \KeywordTok{,} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. first of doubles}
\NormalTok{fod}\AlertTok{=:}\index{fod@\texttt{fod}} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \DecValTok{1} \DecValTok{0}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{$\textasciitilde{}} \KeywordTok{\#}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. first on path order list index {-} see long documentation}
\NormalTok{fopix}\AlertTok{=:}\index{fopix@\texttt{fopix}} \KeywordTok{1:} \KeywordTok{i.\textasciitilde{}} \KeywordTok{[} \KeywordTok{+/@:e.\&>} \KeywordTok{[:} \KeywordTok{<} \KeywordTok{[:} \KeywordTok{<} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gdeps}\AlertTok{=:}\index{gdeps@\texttt{gdeps}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*gdeps v{-}{-} group and suite dependents.}
\CommentTok{NB.}
\CommentTok{NB. Dependents are global J assignments between the dependents tags:}
\CommentTok{NB.}
\CommentTok{NB. verbatim:}
\CommentTok{NB.}
\CommentTok{NB.    NB.*dependents}
\CommentTok{NB.    NB.*enddependents}
\CommentTok{NB.}
\CommentTok{NB. monad:  gdeps clGroup}
\CommentTok{NB.}
\CommentTok{NB.   gdeps \textquotesingle{}jod\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:   iaGScode gdeps clGroupSuite}
\CommentTok{NB.}
\CommentTok{NB.   3 gdeps}

\NormalTok{GROUP gdeps }\KeywordTok{y}
\KeywordTok{:}
\KeywordTok{if.}\NormalTok{ badil }\KeywordTok{x}     \KeywordTok{do.}\NormalTok{ jderr ERR001 }\CommentTok{NB. errmsg: invalid options}
\KeywordTok{elseif.}\NormalTok{ badcl }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR002 }\CommentTok{NB. errmsg: invalid name(s)}
\KeywordTok{elseif.}  \KeywordTok{x=.} \KeywordTok{\{.x}
         \KeywordTok{{-}.} \KeywordTok{x} \KeywordTok{e.}\NormalTok{ GROUP}\KeywordTok{,}\NormalTok{SUITE }\KeywordTok{do.}\NormalTok{ jderr ERR001}
\KeywordTok{elseif.}\NormalTok{  badrc uv0}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{x,}\DecValTok{1}\RegionMarkerTok{)}\NormalTok{ obtext}\DecValTok{\_\_}\NormalTok{UT }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ uv0}
\KeywordTok{elseif.do.}
\NormalTok{  uv0}\KeywordTok{=.} \KeywordTok{,>}\DecValTok{2}\KeywordTok{\{}\NormalTok{uv0}
  \CommentTok{NB. hides tags from searches}
\NormalTok{  beg}\KeywordTok{=.} \StringTok{\textquotesingle{}NB.*\textquotesingle{}}\KeywordTok{,}\NormalTok{DEPENDENTSSTART}
\NormalTok{  fin}\KeywordTok{=.} \StringTok{\textquotesingle{}NB.*\textquotesingle{}}\KeywordTok{,}\NormalTok{DEPENDENTSEND}
\NormalTok{  tcnt}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{+/}\NormalTok{beg }\KeywordTok{E.}\NormalTok{ uv0}\RegionMarkerTok{)}\KeywordTok{,+/}\NormalTok{fin }\KeywordTok{E.}\NormalTok{ uv0}
  \KeywordTok{select.}\NormalTok{ tcnt}
  \KeywordTok{case.} \DecValTok{0} \DecValTok{0} \KeywordTok{do.}\NormalTok{ ok }\StringTok{\textquotesingle{}\textquotesingle{}}
  \KeywordTok{case.} \DecValTok{0} \DecValTok{1} \KeywordTok{do.}\NormalTok{ jderr ERR024  }\CommentTok{NB.errmsg: dependent block unbalanced}
  \KeywordTok{case.} \DecValTok{1} \DecValTok{0} \KeywordTok{do.}\NormalTok{ jderr ERR024}
  \KeywordTok{case.} \DecValTok{1} \DecValTok{1} \KeywordTok{do.}
\NormalTok{     uv0}\KeywordTok{=.} \KeywordTok{];.}\NormalTok{\_}\DecValTok{1}\NormalTok{ LF}\KeywordTok{,}\NormalTok{fin beforestr uv0 }\KeywordTok{{-}.}\NormalTok{ CR}
     \DecValTok{0}\NormalTok{ namecats}\DecValTok{\_\_}\NormalTok{MK uv0 }\KeywordTok{\}.\textasciitilde{}} \KeywordTok{I.} \RegionMarkerTok{(}\KeywordTok{,:}\NormalTok{beg}\RegionMarkerTok{)} \KeywordTok{+./"}\DecValTok{1}\KeywordTok{@E.}\NormalTok{ uv0}
  \KeywordTok{case.do.}
\NormalTok{    jderr ERR025 }\CommentTok{NB. errmsg: only one balanced dependent block allowed}
  \KeywordTok{end.}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{get}\AlertTok{=:}\index{get@\texttt{get}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*get v{-}{-} retrieves objects from dictionary database files.}
\CommentTok{NB.}
\CommentTok{NB. monad:  get blcl}
\CommentTok{NB.}
\CommentTok{NB.   get ;: \textquotesingle{}us poor little words\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes get bluu}
\CommentTok{NB.}
\CommentTok{NB.   2 8 put \textquotesingle{}GroupName\textquotesingle{};\textquotesingle{}Group documentation text ....\textquotesingle{}}
\CommentTok{NB.   2 8 get \textquotesingle{}GroupName\textquotesingle{}}
\CommentTok{NB.   4 get \textquotesingle{}MacroText\textquotesingle{}}

\NormalTok{WORD get }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001 }\KeywordTok{[}\NormalTok{ loc }\KeywordTok{=.} \KeywordTok{<}\StringTok{\textquotesingle{}base\textquotesingle{}} \CommentTok{NB. errmsg: invalid option(s)}

\KeywordTok{if.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}
  \CommentTok{NB. errmsg: invalid or missing locale}
  \KeywordTok{if.} \DecValTok{\_2}\KeywordTok{\&}\NormalTok{badlocn }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr ERR004 }\KeywordTok{return.} \KeywordTok{else.} \KeywordTok{x=.}\NormalTok{ WORD }\KeywordTok{[}\NormalTok{ loc}\KeywordTok{=.} \KeywordTok{<x{-}.}\StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{end.}
\KeywordTok{end.}

\CommentTok{NB. do we have a dictionary open?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. format standard (x) options}
\KeywordTok{x=.} \KeywordTok{x} \KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{{-}}\DecValTok{3}\KeywordTok{{-}\#x}\RegionMarkerTok{)} \KeywordTok{\{.}\NormalTok{ DEFAULT }\KeywordTok{,} \DecValTok{0}
\KeywordTok{if.} \KeywordTok{{-}.} \DecValTok{0} \DecValTok{1} \KeywordTok{e.\textasciitilde{}} \KeywordTok{\{:} \KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\KeywordTok{select.} \KeywordTok{\{.} \KeywordTok{x}
\KeywordTok{case.}\NormalTok{ WORD }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ loc defwords}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ WORD getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ WORD getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ NVTABLE  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ INCLASS}\KeywordTok{;}\NormalTok{INCREATE}\KeywordTok{;}\NormalTok{INPUT}\KeywordTok{;}\NormalTok{INSIZE }\KeywordTok{do.} \RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{.x}\RegionMarkerTok{)}\NormalTok{ invfetch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.}\NormalTok{ WORD getntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ TEST }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ TEST getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ TEST getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ INCREATE}\KeywordTok{;}\NormalTok{INPUT}\KeywordTok{;}\NormalTok{INSIZE }\KeywordTok{do.} \RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{.x}\RegionMarkerTok{)}\NormalTok{ invfetch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.}\NormalTok{ TEST getntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ GROUP }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ GROUP getgstext}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ GROUP getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ GROUP getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ INCREATE}\KeywordTok{;}\NormalTok{INPUT }\KeywordTok{do.} \RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{.x}\RegionMarkerTok{)}\NormalTok{ invfetch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.}\NormalTok{ GROUP getntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ SUITE }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ SUITE getgstext}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ SUITE getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ SUITE getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ INCREATE}\KeywordTok{;}\NormalTok{INPUT }\KeywordTok{do.} \RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{.x}\RegionMarkerTok{)}\NormalTok{ invfetch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.}\NormalTok{ SUITE getntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ MACRO }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ MACRO getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ MACRO getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ INCLASS}\KeywordTok{;}\NormalTok{INCREATE}\KeywordTok{;}\NormalTok{INPUT}\KeywordTok{;}\NormalTok{INSIZE }\KeywordTok{do.} \RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{.x}\RegionMarkerTok{)}\NormalTok{ invfetch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.}\NormalTok{ MACRO getntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ DICTIONARY }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ getdicdoc}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.do.}\NormalTok{ jderr msg}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{globals}\AlertTok{=:}\index{globals@\texttt{globals}} \DecValTok{4} \RegionMarkerTok{: 0}
\KeywordTok{if.}\NormalTok{ badcl }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR002 }\KeywordTok{return.} \KeywordTok{end.} \CommentTok{NB. errmsg: invalid name(s)}
\KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.} \DecValTok{0}\NormalTok{ checknames }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y}
\KeywordTok{else.}
  \KeywordTok{y} \KeywordTok{=.>}\DecValTok{1}\KeywordTok{\{y}
  \CommentTok{NB. use base locale if no locale reference}
  \KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{islocref }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y=.} \KeywordTok{y,}\StringTok{\textquotesingle{}\_base\_\textquotesingle{}} \KeywordTok{end.}
  \KeywordTok{x}\NormalTok{ wrdglobals}\DecValTok{\_\_}\NormalTok{MK }\KeywordTok{y}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{globs}\AlertTok{=:}\index{globs@\texttt{globs}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*globs v{-}{-} analyze, report and store global names}
\CommentTok{NB.}
\CommentTok{NB. monad:  globs clName}
\CommentTok{NB.}
\CommentTok{NB.   globs \textquotesingle{}word\textquotesingle{}    NB. list globals in locale word}
\CommentTok{NB.}
\CommentTok{NB. dyad:   iaCode globs clName}
\CommentTok{NB.}
\CommentTok{NB.   NB. stores global references of word in dictionary}
\CommentTok{NB.   0 globs \textquotesingle{}word\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   1 globs \textquotesingle{}test\textquotesingle{}  NB. list globals in test}

\DecValTok{0}\NormalTok{ globals }\KeywordTok{y}
\KeywordTok{:}
\KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{,x}\RegionMarkerTok{)}\KeywordTok{{-}:,}\NormalTok{REFERENCE }\KeywordTok{do.} \DecValTok{1}\NormalTok{ globals }\KeywordTok{y}
\KeywordTok{elseif.}\NormalTok{ badcl }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR002 }\CommentTok{NB. errmsg: invalid name(s)}
\KeywordTok{elseif.do.}
  \KeywordTok{select.} \KeywordTok{x}
  \KeywordTok{case.}\NormalTok{ WORD }\KeywordTok{do.}
    \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0}  \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{else.}\NormalTok{ DL}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\{}\NormalTok{ uv }\KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{ checknames}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{return.} \KeywordTok{else.} \KeywordTok{y=.} \KeywordTok{,>\}.y} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ inputdict}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{<y}  \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ WORD getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{else.}\NormalTok{ uv}\KeywordTok{=.} \KeywordTok{,}\DecValTok{1} \KeywordTok{\{::}\NormalTok{ uv }\KeywordTok{end.}
    \KeywordTok{if.} \DecValTok{0}\KeywordTok{=>}\DecValTok{1}\KeywordTok{\{}\NormalTok{uv }\KeywordTok{do.}\NormalTok{ ok }\StringTok{\textquotesingle{}<\textquotesingle{}}\KeywordTok{,y,}\StringTok{\textquotesingle{}>\textquotesingle{}}\KeywordTok{,}\NormalTok{OK002 }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.} \DecValTok{0}\NormalTok{ namecats}\DecValTok{\_\_}\NormalTok{MK }\KeywordTok{];.}\NormalTok{\_}\DecValTok{2} \RegionMarkerTok{(}\KeywordTok{>}\DecValTok{2}\KeywordTok{\{}\NormalTok{uv}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{LF }\KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
    \RegionMarkerTok{(}\KeywordTok{y;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putwordxrs}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{\}.}\NormalTok{uv}
  \KeywordTok{case.}\NormalTok{ TEST }\KeywordTok{do.}
    \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ TEST get }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{else.}\NormalTok{ uv}\KeywordTok{=.} \KeywordTok{,}\DecValTok{1} \KeywordTok{\{::}\NormalTok{ uv }\KeywordTok{end.}
    \CommentTok{NB. return references in stored test text}
    \DecValTok{0}\NormalTok{ namecats}\DecValTok{\_\_}\NormalTok{MK }\KeywordTok{];.}\NormalTok{\_}\DecValTok{2} \RegionMarkerTok{(}\KeywordTok{>}\DecValTok{1}\KeywordTok{\{}\NormalTok{uv}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{LF}
  \KeywordTok{case.do.}\NormalTok{ jderr ERR001  }\CommentTok{NB. errmsg: invalid option(s)}
  \KeywordTok{end.}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grp}\AlertTok{=:}\index{grp@\texttt{grp}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*grp v{-}{-} create and modify groups.}
\CommentTok{NB.}
\CommentTok{NB. monad:  grp blcl}
\CommentTok{NB. dyad: ia grp ?}

\NormalTok{GROUP grp }\KeywordTok{y}
\KeywordTok{:}
\KeywordTok{select.} \KeywordTok{x}
  \KeywordTok{case.}\NormalTok{ GROUP }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{,}\NormalTok{WORD}\RegionMarkerTok{)}\NormalTok{ gsmakeq }\KeywordTok{y}
  \KeywordTok{case.}\NormalTok{ SUITE }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{,}\NormalTok{TEST}\RegionMarkerTok{)}\NormalTok{ gsmakeq }\KeywordTok{y}
  \KeywordTok{case.do.}\NormalTok{ jderr ERR001 }\CommentTok{NB. errmsg: invalid option(s)}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gsmakeq}\AlertTok{=:}\index{gsmakeq@\texttt{gsmakeq}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*gsmakeq v{-}{-} make or query groups and suites.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes gsmakeq blcl}

\StringTok{\textquotesingle{}gscode obcode\textquotesingle{}}\KeywordTok{=.} \KeywordTok{x}

\KeywordTok{if.}\NormalTok{ isempty }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ gscode dnl }\StringTok{\textquotesingle{}\textquotesingle{}}
\KeywordTok{else.}
  \KeywordTok{if.}\NormalTok{ badcl }\KeywordTok{y} \KeywordTok{do.}

    \CommentTok{NB. create/modify group}
    \KeywordTok{if.}\NormalTok{ badrc mdl}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0}  \KeywordTok{do.}\NormalTok{ mdl }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ checkpath}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{\{:}\NormalTok{ mdl }\KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
    \CommentTok{NB. remove empties from name list allows (grp \textquotesingle{}name\textquotesingle{};\textquotesingle{}\textquotesingle{}) to create null groups}
    \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{  checknames }\KeywordTok{y} \KeywordTok{{-}.} \KeywordTok{a:} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{return.} \KeywordTok{end.}
    \RegionMarkerTok{((}\KeywordTok{\{:}\NormalTok{mdl}\RegionMarkerTok{)}\KeywordTok{;}\NormalTok{obcode}\KeywordTok{;}\NormalTok{gscode}\RegionMarkerTok{)}\NormalTok{ putgs}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{\}.} \KeywordTok{y}

  \KeywordTok{else.}

    \CommentTok{NB. query group contents}
    \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{ checknames }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{return.} \KeywordTok{end.}
\NormalTok{    gscode gslistnl}\DecValTok{\_\_}\NormalTok{ST rv }\KeywordTok{y}
  \KeywordTok{end.}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{guids}\AlertTok{=:}\index{guids@\texttt{guids}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*guids v{-}{-} create guids as 16 byte strings on supported J systems.}
\CommentTok{NB.}
\CommentTok{NB. This verb taken from \textasciitilde{}addons/general/misc/guids.ijs returns guids}
\CommentTok{NB. on Windows, Linux and Mac systems.}
\CommentTok{NB.}
\CommentTok{NB. monad:  guids zl | ilShape}
\CommentTok{NB.}
\CommentTok{NB.   guids \textquotesingle{}\textquotesingle{}    NB. create guid as a 16{-}byte character string}
\CommentTok{NB.   guids $0}
\CommentTok{NB.   guids 3 4   NB. create 3x4 array of 16{-}byte strings}

\KeywordTok{if.}\NormalTok{ IFWIN }\KeywordTok{do.}
\NormalTok{  cmd}\KeywordTok{=.} \StringTok{\textquotesingle{}ole32 CoCreateGuid i *c\textquotesingle{}}
\KeywordTok{else.}
\NormalTok{  cmd}\KeywordTok{=.} \RegionMarkerTok{((}\NormalTok{UNAME}\KeywordTok{{-}:}\StringTok{\textquotesingle{}Darwin\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{\{::}\StringTok{\textquotesingle{}libuuid.so.1\textquotesingle{}}\KeywordTok{;}\StringTok{\textquotesingle{}libSystem.B.dylib\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{,}\StringTok{\textquotesingle{} uuid\_generate n *c\textquotesingle{}}
\KeywordTok{end.}
\KeywordTok{>\{:"}\DecValTok{1}\NormalTok{ cmd }\DecValTok{15}\KeywordTok{!:}\DecValTok{0}\KeywordTok{"}\DecValTok{1} \DecValTok{0} \KeywordTok{<"}\DecValTok{1} \RegionMarkerTok{(}\KeywordTok{y,}\DecValTok{16}\RegionMarkerTok{)}\KeywordTok{$}\StringTok{\textquotesingle{} \textquotesingle{}}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. guids as extended precision integers: guidsx i.0 [ guidsx 3 5}
\NormalTok{guidsx}\AlertTok{=:}\index{guidsx@\texttt{guidsx}} \DecValTok{256} \KeywordTok{\#.} \KeywordTok{[:} \KeywordTok{x:} \KeywordTok{a.} \KeywordTok{i.}\NormalTok{ guids}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. returns result of linux/unix commands as text string}
\NormalTok{host}\AlertTok{=:}\index{host@\texttt{host}} \KeywordTok{[:} \DecValTok{2}\KeywordTok{!:}\DecValTok{0} \StringTok{\textquotesingle{}(\textquotesingle{}}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{,} \KeywordTok{]} \KeywordTok{,} \StringTok{\textquotesingle{} || true)\textquotesingle{}}\KeywordTok{"}\NormalTok{\_}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if noun is empty on any axis and 0 otherwise}
\NormalTok{isempty}\AlertTok{=:}\index{isempty@\texttt{isempty}} \KeywordTok{0:} \KeywordTok{e.} \KeywordTok{$}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 if name is a locale reference 0 otherwise}
\NormalTok{islocref}\AlertTok{=:}\index{islocref@\texttt{islocref}} \RegionMarkerTok{(}\StringTok{\textquotesingle{}\_\textquotesingle{}}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{=} \KeywordTok{\{:}\RegionMarkerTok{)} \KeywordTok{+.} \KeywordTok{[:} \KeywordTok{+./} \StringTok{\textquotesingle{}\_\_\textquotesingle{}}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{E.} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. error trapped call to jappend\_jfiles\_}
\NormalTok{jappend}\AlertTok{=:}\index{jappend@\texttt{jappend}}\NormalTok{ jappend\_jfiles}\DecValTok{\_} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_2:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. character table representation of j words, call:  jcr \textquotesingle{}verb\textquotesingle{}}
\NormalTok{jcr}\AlertTok{=:}\index{jcr@\texttt{jcr}} \KeywordTok{[:} \KeywordTok{];.}\NormalTok{\_}\DecValTok{1} \RegionMarkerTok{(}\DecValTok{10}\KeywordTok{\{a.}\RegionMarkerTok{)} \KeywordTok{,} \KeywordTok{[:} \DecValTok{5}\KeywordTok{!:}\DecValTok{5} \KeywordTok{<}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. error trapped call to jcreate\_jfiles\_}
\NormalTok{jcreate}\AlertTok{=:}\index{jcreate@\texttt{jcreate}}\NormalTok{ jcreate\_jfiles}\DecValTok{\_} \KeywordTok{::0:}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. format error message}
\NormalTok{jderr}\AlertTok{=:}\index{jderr@\texttt{jderr}} \KeywordTok{0:} \KeywordTok{;} \StringTok{\textquotesingle{}!JOD error: \textquotesingle{}}\KeywordTok{"}\NormalTok{\_ }\KeywordTok{,} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{jdmasterr}\AlertTok{=:}\index{jdmasterr@\texttt{jdmasterr}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*jdmasterr v{-}{-} master error handling.}
\CommentTok{NB.}
\CommentTok{NB. Use when the master file is set otherwise the master will not}
\CommentTok{NB. be  properly reset. Because of the file overhead I decided to}
\CommentTok{NB. use a second error  handler  instead  of  burdening the  very}
\CommentTok{NB. frequently called  (jderr)  with this  often unnecessary file}
\CommentTok{NB. access function.}

\KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{markmast}\KeywordTok{\textasciitilde{}}\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{else.}\NormalTok{ jderr }\KeywordTok{y} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{jnfrblcl}\AlertTok{=:}\index{jnfrblcl@\texttt{jnfrblcl}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*jnfrblcl  v{-}{-} extracts valid  J names  from  boxed  lists  of}
\CommentTok{NB. character lists. Only  proper  unquoted,  inflection free (no}
\CommentTok{NB. trailing .\textquotesingle{}s)  names are  returned. This  verb extracts names}
\CommentTok{NB. without using name class tests. Class tests cannot be used on}
\CommentTok{NB. indirect locale names, eg. (BOO\_\_HOO)  as the noun (HOO) must}
\CommentTok{NB. exist.}
\CommentTok{NB.}
\CommentTok{NB. monad: jnfrblcl  blcl}
\CommentTok{NB.}
\CommentTok{NB.   jnfrblcl \textquotesingle{}good\textquotesingle{};\textquotesingle{} \textquotesingle{}\textquotesingle{} bad\textquotesingle{};\textquotesingle{}888\textquotesingle{};\textquotesingle{}ok\textquotesingle{};\textquotesingle{}notok.\textquotesingle{};\textquotesingle{}3r7\textquotesingle{}}

\CommentTok{NB. trim end blanks and eliminate any empties}
\KeywordTok{y=.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \DecValTok{0} \KeywordTok{<} \KeywordTok{\#\&>} \KeywordTok{y=.}\NormalTok{alltrim}\KeywordTok{\&.>} \KeywordTok{y}

\CommentTok{NB. remove all lists containing invalid name characters}
\KeywordTok{y=.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \KeywordTok{y} \KeywordTok{*./@:e.\&>} \KeywordTok{<}\NormalTok{ALPHA}\KeywordTok{,}\StringTok{\textquotesingle{}\_\textquotesingle{}}

\CommentTok{NB. remove all lists beginning with numerals and \_}
\KeywordTok{y=.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \KeywordTok{{-}.}\RegionMarkerTok{(}\KeywordTok{\{.\&>} \KeywordTok{y}\RegionMarkerTok{)} \KeywordTok{e.} \StringTok{\textquotesingle{}\_0123456789\textquotesingle{}}

\CommentTok{NB. extract any remaing names with regular expression}
\KeywordTok{if.} \KeywordTok{\#y} \KeywordTok{do.}\NormalTok{ JNAME rxall }\KeywordTok{;} \KeywordTok{y} \KeywordTok{,\&.>} \StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{else.} \StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. standarizes J path delimiter to unix/linux forward slash}
\NormalTok{jpathsep}\AlertTok{=:}\index{jpathsep@\texttt{jpathsep}} \StringTok{\textquotesingle{}/\textquotesingle{}}\KeywordTok{\&}\RegionMarkerTok{((}\StringTok{\textquotesingle{}\textbackslash{}\textquotesingle{}} \KeywordTok{I.@:=} \KeywordTok{]}\RegionMarkerTok{)}\KeywordTok{\}}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. error trapped call to jread\_jfiles\_}
\NormalTok{jread}\AlertTok{=:}\index{jread@\texttt{jread}}\NormalTok{ jread\_jfiles}\DecValTok{\_} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_2:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. error trapped call to jreplace\_jfiles\_}
\NormalTok{jreplace}\AlertTok{=:}\index{jreplace@\texttt{jreplace}}\NormalTok{ jreplace\_jfiles}\DecValTok{\_} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_2:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. extracts the drive from qualified file names}
\NormalTok{justdrv}\AlertTok{=:}\index{justdrv@\texttt{justdrv}} \KeywordTok{[:} \KeywordTok{\}:} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \KeywordTok{[:} \KeywordTok{+./\textbackslash{}.} \StringTok{\textquotesingle{}:\textquotesingle{}}\KeywordTok{\&=}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{jvn}\AlertTok{=:}\index{jvn@\texttt{jvn}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*jvn{-}{-} J version number.}
\CommentTok{NB.}
\CommentTok{NB. monad:  na =. jvn uuIgnore}

\CommentTok{NB. J version number}
\NormalTok{ver}\KeywordTok{=.} \DecValTok{9}\KeywordTok{!:}\DecValTok{14} \StringTok{\textquotesingle{}\textquotesingle{}}
\NormalTok{ver}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{ver }\KeywordTok{e.} \StringTok{\textquotesingle{}0123456789/\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{\#}\NormalTok{ver}

\CommentTok{NB. return version 6.01 if string is not numeric}
\DecValTok{100} \KeywordTok{\%\textasciitilde{}} \KeywordTok{,} \DecValTok{601} \KeywordTok{".} \RegionMarkerTok{(}\NormalTok{ver }\KeywordTok{i.} \StringTok{\textquotesingle{}/\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{\{.}\NormalTok{ ver}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. removes all leading and trailing CR and LF characters}
\NormalTok{lfcrtrim}\AlertTok{=:}\index{lfcrtrim@\texttt{lfcrtrim}} \KeywordTok{]} \KeywordTok{\#\textasciitilde{}} \KeywordTok{[:} \KeywordTok{{-}.} \KeywordTok{[:} \RegionMarkerTok{(}\KeywordTok{*./\textbackslash{}.} \KeywordTok{+.} \KeywordTok{*./\textbackslash{}}\RegionMarkerTok{)} \KeywordTok{]} \KeywordTok{e.} \RegionMarkerTok{(}\DecValTok{10} \DecValTok{13}\KeywordTok{\{a.}\RegionMarkerTok{)}\KeywordTok{"}\NormalTok{\_}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. surround names with locale delimiters, eg: \_name\_}
\NormalTok{locsfx}\AlertTok{=:}\index{locsfx@\texttt{locsfx}} \StringTok{\textquotesingle{}\_\textquotesingle{}}\KeywordTok{\&,@,\&}\StringTok{\textquotesingle{}\_\textquotesingle{}}\KeywordTok{\&.>}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{make}\AlertTok{=:}\index{make@\texttt{make}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*make v{-}{-} makes J scripts.}
\CommentTok{NB.}
\CommentTok{NB. monad:  make zl|cl}
\CommentTok{NB.}
\CommentTok{NB.   make \textquotesingle{}\textquotesingle{}  NB. basic put dump}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilObjOpt make cl|blcl}
\CommentTok{NB.}
\CommentTok{NB.   0 make ;:\textquotesingle{}an arbitrary list of words into a script and file it\textquotesingle{}}
\CommentTok{NB.   0 2 make ;: \textquotesingle{}a list of words returned as a character list\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   3 make \textquotesingle{}suite\textquotesingle{}    NB. make suite write to script subdirectory}
\CommentTok{NB.   2 2 make \textquotesingle{}group\textquotesingle{}  NB. make group return character list}
\CommentTok{NB.}
\CommentTok{NB.   NB. make groups that are not in put dictionary}
\CommentTok{NB.   NB. file is written to put dictionary script directory}
\CommentTok{NB.   2 \_1 make \textquotesingle{}deepgroup\textquotesingle{}}

\NormalTok{makedump}\DecValTok{\_\_}\NormalTok{MK }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001  }\CommentTok{NB. errmsg: invalid option(s)}
\KeywordTok{if.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. do we have a dictionary open?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. format standard (x) options HARDCODE}
\KeywordTok{x=.} \DecValTok{2} \KeywordTok{\{.} \KeywordTok{x} \KeywordTok{,} \DecValTok{1} \DecValTok{2}
\KeywordTok{if.} \KeywordTok{{-}.}\RegionMarkerTok{(}\KeywordTok{\{:} \KeywordTok{x}\RegionMarkerTok{)} \KeywordTok{e.} \DecValTok{\_2} \DecValTok{\_1} \DecValTok{1} \DecValTok{2} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{\{.} \KeywordTok{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ GROUP}\KeywordTok{,}\NormalTok{SUITE }\KeywordTok{do.} \KeywordTok{x}\NormalTok{ makegs}\DecValTok{\_\_}\NormalTok{MK }\KeywordTok{y}
\KeywordTok{elseif.}  \RegionMarkerTok{(}\KeywordTok{\{.} \KeywordTok{x}\RegionMarkerTok{)}\KeywordTok{=}\NormalTok{WORD }\KeywordTok{do.}
  \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{WORD obtext}\DecValTok{\_\_}\NormalTok{UT }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ uv}
  \KeywordTok{elseif.} \DecValTok{1}\KeywordTok{=\{:} \KeywordTok{x} \KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;}\DecValTok{1}\KeywordTok{\{}\NormalTok{uv}\RegionMarkerTok{)}\NormalTok{ writeijs}\DecValTok{\_\_}\NormalTok{MK }\KeywordTok{>\{:}\NormalTok{uv}
  \KeywordTok{elseif.do.}\NormalTok{ ok }\KeywordTok{>\{:}\NormalTok{ uv}
  \KeywordTok{end.}
\KeywordTok{elseif.do.}\NormalTok{ jderr msg}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. make a directory (1 success, 0 failure)}
\NormalTok{makedir}\AlertTok{=:}\index{makedir@\texttt{makedir}} \DecValTok{1}\KeywordTok{!:}\DecValTok{5} \KeywordTok{::0:}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{markmast}\AlertTok{=:}\index{markmast@\texttt{markmast}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*markmast v{-}{-} marks the master dictionary file. This system is}
\CommentTok{NB. is primarily  a single  writer  system. Many dictionary tasks}
\CommentTok{NB. can read data but only one  task can  change  it.  The master}
\CommentTok{NB. file  is used to enforce this  protocol. (markmast)  sets and}
\CommentTok{NB. unsets a use bit. When the bit is set the master file  itself}
\CommentTok{NB. cannot be changed.}
\CommentTok{NB.}
\CommentTok{NB. monad:  markmast uuIgnore}
\CommentTok{NB. dyad:   uuIgnore markmast uuIgnore}

\CommentTok{NB. set the use bit/timestamp in the master file}
\KeywordTok{if.}\NormalTok{ badjr ub}\KeywordTok{=.}\NormalTok{ jread JMASTER}\KeywordTok{;}\NormalTok{CNMFMARK }\KeywordTok{do.}\NormalTok{ jderr ERR006  }\CommentTok{NB. errmsg: cannot read master}
\KeywordTok{elseif.} \KeywordTok{>\{.>}\NormalTok{ub }\KeywordTok{do.}\NormalTok{ jderr ERR012  }\CommentTok{NB. errmsg: master in use {-} wait or try (dpset)}
\KeywordTok{elseif.}\NormalTok{ badreps }\RegionMarkerTok{(}\NormalTok{mubmark }\KeywordTok{y}\RegionMarkerTok{)}\NormalTok{ jreplace JMASTER}\KeywordTok{;}\NormalTok{CNMFMARK }\KeywordTok{do.}
\NormalTok{  jderr ERR013 }\CommentTok{NB. errmsg: cannot mark master}
\KeywordTok{elseif.do.}\NormalTok{ ok }\KeywordTok{y}
\KeywordTok{end.}
\KeywordTok{:}
\CommentTok{NB. dyad resets the master}
\KeywordTok{if.}\NormalTok{ badreps }\RegionMarkerTok{(}\NormalTok{mubmark }\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ jreplace JMASTER}\KeywordTok{;}\NormalTok{CNMFMARK }\KeywordTok{do.}\NormalTok{ jderr ERR013 }\KeywordTok{else.}\NormalTok{ ok }\DecValTok{0} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mnl}\AlertTok{=:}\index{mnl@\texttt{mnl}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*mnl v{-}{-} list objects in all registered dictionaries.}
\CommentTok{NB.}
\CommentTok{NB. monad:  mnl clStr | zlStr}
\CommentTok{NB.}
\CommentTok{NB.   mnl \textquotesingle{}\textquotesingle{}     NB. list all words in all registered dictionaries}
\CommentTok{NB.   mnl \textquotesingle{}pfx\textquotesingle{}  NB. list all words in all registered dictionaries starting with \textquotesingle{}pfx\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes mnl clStr | zlStr}
\CommentTok{NB.}
\CommentTok{NB.   4 2  mnl \textquotesingle{}ex\textquotesingle{}  NB. macros with names containing \textquotesingle{}ex\textquotesingle{} in all registered dictionaries}
\CommentTok{NB.   2 3  mnl \textquotesingle{}et\textquotesingle{}  NB. groups with names ending with \textquotesingle{}et\textquotesingle{} in all registered dictionaries}
\CommentTok{NB.   4 3 25 mnl \textquotesingle{}\_sql\textquotesingle{} NB. text macros with names ending \textquotesingle{}\_sql\textquotesingle{}}
\CommentTok{NB.   0 \_1 mnl \textquotesingle{}se\textquotesingle{}  NB. duplicate words starting with \textquotesingle{}se\textquotesingle{}}

\NormalTok{WORD mnl }\KeywordTok{y}
\KeywordTok{:}

\CommentTok{NB. (mnl) does not require open dictionaries}
\KeywordTok{if.}\NormalTok{     badcl }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR010  }\CommentTok{NB. errmsg: invalid name pattern}
\KeywordTok{elseif.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr ERR001  }\CommentTok{NB. errmsg: invalid option(s)}
\KeywordTok{elseif.} \KeywordTok{do.}

  \CommentTok{NB. format standard (mnl) (x) options and search}
  \KeywordTok{x=.} \DecValTok{3} \KeywordTok{\{.} \KeywordTok{x} \KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{<:\#x}\RegionMarkerTok{)}\KeywordTok{\}.} \DecValTok{1} \KeywordTok{,}\NormalTok{ DEFAULT}

  \CommentTok{NB. validate options}
  \KeywordTok{if.} \KeywordTok{{-}.}\RegionMarkerTok{((}\DecValTok{1}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ PATOPS}\RegionMarkerTok{)} \KeywordTok{*.} \RegionMarkerTok{(}\DecValTok{0}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ OBJECTNC }\KeywordTok{do.}\NormalTok{ jderr ERR001 }\KeywordTok{return.} \KeywordTok{end.}


  \KeywordTok{if.}\NormalTok{ WORD }\KeywordTok{=} \DecValTok{0}\KeywordTok{\{x} \KeywordTok{do.}

    \KeywordTok{if.} \KeywordTok{{-}.}\RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.} \RegionMarkerTok{(}\KeywordTok{i.} \DecValTok{4}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{DEFAULT     }\KeywordTok{do.}\NormalTok{ jderr ERR001 }\KeywordTok{return.} \KeywordTok{end.}

  \KeywordTok{elseif.} \RegionMarkerTok{(}\DecValTok{0}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ TEST}\KeywordTok{,}\NormalTok{GROUP}\KeywordTok{,}\NormalTok{SUITE }\KeywordTok{do.}

    \KeywordTok{if.}\NormalTok{ DEFAULT }\KeywordTok{\textasciitilde{}:} \DecValTok{2}\KeywordTok{\{x}                \KeywordTok{do.}\NormalTok{ jderr ERR001 }\KeywordTok{return.} \KeywordTok{end.}

  \KeywordTok{elseif.}\NormalTok{ MACRO }\KeywordTok{=} \DecValTok{0}\KeywordTok{\{x}  \KeywordTok{do.}

    \KeywordTok{if.} \KeywordTok{{-}.}\RegionMarkerTok{(}\DecValTok{2}\KeywordTok{\{x}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ MACROTYPE}\KeywordTok{,}\NormalTok{DEFAULT  }\KeywordTok{do.}\NormalTok{ jderr ERR001 }\KeywordTok{return.} \KeywordTok{end.}

  \KeywordTok{elseif.} \KeywordTok{do.}\NormalTok{ jderr ERR001 }\KeywordTok{return.}

  \KeywordTok{end.}

  \KeywordTok{x}\NormalTok{ mnlsearch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. master use bit mark}
\NormalTok{mubmark}\AlertTok{=:}\index{mubmark@\texttt{mubmark}} \KeywordTok{]} \KeywordTok{;} \KeywordTok{[:} \RegionMarkerTok{(}\DecValTok{6}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)} \KeywordTok{0:} \KeywordTok{$} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. J name class override {-} traps limit error for very long names}
\NormalTok{nc}\AlertTok{=:}\index{nc@\texttt{nc}} \DecValTok{4}\KeywordTok{!:}\DecValTok{0} \KeywordTok{::}\RegionMarkerTok{(}\KeywordTok{\_2:}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{newd}\AlertTok{=:}\index{newd@\texttt{newd}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*newd v{-}{-} creates a new dictionary}
\CommentTok{NB.}
\CommentTok{NB. monad:  newd clName | (clName ; clPath)}
\CommentTok{NB.}
\CommentTok{NB.  newd \textquotesingle{}New0Dict\textquotesingle{}             NB. store in default J user directory}
\CommentTok{NB.  newd \textquotesingle{}New1Dict\textquotesingle{};\textquotesingle{}c:\textbackslash{}put\textbackslash{}it\textbackslash{}here\textquotesingle{}           NB. windows drives}
\CommentTok{NB.  newd \textquotesingle{}New2Dict\textquotesingle{};\textquotesingle{}\textbackslash{}\textbackslash{}shared\textbackslash{}netdrive\textbackslash{}new2\textquotesingle{}   NB. windows UNC shares}
\CommentTok{NB.  newd \textquotesingle{}New3Dict\textquotesingle{};\textquotesingle{}/home/john/temp/new3\textquotesingle{}     NB. linux rooted paths}

\KeywordTok{if.}\NormalTok{ badcl }\KeywordTok{y} \KeywordTok{do.}
  \DecValTok{1}\NormalTok{ newregdict}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{else.}
\NormalTok{  drn}\KeywordTok{=.} \KeywordTok{y} \KeywordTok{{-}.} \KeywordTok{y} \KeywordTok{{-}.}\NormalTok{ ALPHA  }\CommentTok{NB. safe directory chars only}
  \DecValTok{1}\NormalTok{ newregdict}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y;}\NormalTok{hostsep }\RegionMarkerTok{(}\NormalTok{jpath }\StringTok{\textquotesingle{}\textasciitilde{}user\textbackslash{}\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{JJODDIR}\KeywordTok{,}\RegionMarkerTok{(}\DecValTok{255}\KeywordTok{<.\#}\NormalTok{drn}\RegionMarkerTok{)}\KeywordTok{\{.}\NormalTok{drn}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nlargs}\AlertTok{=:}\index{nlargs@\texttt{nlargs}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*nlargs v{-}{-} test basic name list arguments}
\CommentTok{NB.}
\CommentTok{NB. dyad:  il nlargs cl}

\KeywordTok{if.}\NormalTok{     badcl }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR010  }\CommentTok{NB. errmsg: invalid name pattern}
\KeywordTok{elseif.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr ERR001  }\CommentTok{NB. errmsg: invalid option(s)}
\CommentTok{NB. do we have a dictionary open?}
\KeywordTok{elseif.do.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. numeric list timestamp}
\NormalTok{now}\AlertTok{=:}\index{now@\texttt{now}} \DecValTok{6}\KeywordTok{!:}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. convert timestamp to yyyymmdd}
\NormalTok{nowfd}\AlertTok{=:}\index{nowfd@\texttt{nowfd}} \RegionMarkerTok{(}\KeywordTok{[:} \DecValTok{0} \DecValTok{100} \DecValTok{100}\KeywordTok{\&\#.} \KeywordTok{3:} \KeywordTok{\{.} \KeywordTok{]}\RegionMarkerTok{)} \KeywordTok{+} \RegionMarkerTok{(}\KeywordTok{[:} \DecValTok{24} \DecValTok{60} \DecValTok{60}\KeywordTok{\&\#.} \KeywordTok{3:} \KeywordTok{\}.} \KeywordTok{]}\RegionMarkerTok{)} \KeywordTok{\%} \DecValTok{86400}\KeywordTok{"}\NormalTok{\_}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{obidfile}\AlertTok{=:}\index{obidfile@\texttt{obidfile}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*obidfile v{-}{-} location of jod object id history file.}
\CommentTok{NB.}
\CommentTok{NB. monad: obidfile uuIgnore}

\RegionMarkerTok{(}\NormalTok{jodsystempath }\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{,}\StringTok{\textquotesingle{}jod.ijn\textquotesingle{}}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{od}\AlertTok{=:}\index{od@\texttt{od}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*od v{-}{-} opens and closes dictionaries.}
\CommentTok{NB.}
\CommentTok{NB. monad: od clDictionary|blclDictionary}
\CommentTok{NB.}
\CommentTok{NB. dyad:  iaOption od clDictionary|blclDictionary}
\CommentTok{NB.}
\CommentTok{NB.   od \textquotesingle{}test dictionary\textquotesingle{};\textquotesingle{}another test dictionary\textquotesingle{}  NB. open r/w}
\CommentTok{NB.   3 od \textquotesingle{}test dictionary\textquotesingle{}                          NB. close}

\DecValTok{1}\NormalTok{ od }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR005 }\CommentTok{NB. errmsg: invalid or missing dictionary names}

\CommentTok{NB. list all registered dictionaries (short form)}
\KeywordTok{if.}\NormalTok{ badjr mdt}\KeywordTok{=.}\NormalTok{ jread JMASTER}\KeywordTok{;}\NormalTok{CNMFTAB }\KeywordTok{do.}
\NormalTok{  jderr ERR006 }\KeywordTok{return.}
\KeywordTok{end.}
\NormalTok{dl}\KeywordTok{=.} \DecValTok{0}\KeywordTok{\{>}\NormalTok{mdt}

\KeywordTok{select.} \KeywordTok{x}
\KeywordTok{case.} \DecValTok{1} \KeywordTok{do.}   \CommentTok{NB. HARDCODE: magic numbers read/write codes}

  \KeywordTok{if.}\NormalTok{ isempty }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ ok }\KeywordTok{/:\textasciitilde{}}\NormalTok{ dl}
  \KeywordTok{else.}
    \CommentTok{NB. open read/write}
    \KeywordTok{y=.}\NormalTok{ boxopen }\KeywordTok{,y}
    \CommentTok{NB. all dictionary names must be on master list}
    \KeywordTok{if.} \KeywordTok{*./y} \KeywordTok{e.}\NormalTok{ dl }\KeywordTok{do.} \KeywordTok{y}\NormalTok{ opendict}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{1}\KeywordTok{;}\NormalTok{mdt }\KeywordTok{else.}\NormalTok{ jderr msg }\KeywordTok{end.}
  \KeywordTok{end.}

\KeywordTok{case.} \DecValTok{2} \KeywordTok{do.}

  \CommentTok{NB. open read/only}
  \KeywordTok{y=.}\NormalTok{ boxopen }\KeywordTok{,y}
  \KeywordTok{if.} \KeywordTok{*./y} \KeywordTok{e.}\NormalTok{ dl }\KeywordTok{do.} \KeywordTok{y}\NormalTok{ opendict}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{2}\KeywordTok{;}\NormalTok{mdt }\KeywordTok{else.}\NormalTok{ jderr msg }\KeywordTok{end.}

\KeywordTok{case.} \DecValTok{3} \KeywordTok{do.}

  \CommentTok{NB. close dictionaries}
  \KeywordTok{if.}\NormalTok{ badrc msg1}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg1 }\KeywordTok{return.} \KeywordTok{end.}
  \KeywordTok{if.}\NormalTok{ isempty }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y=.} \KeywordTok{\{."}\DecValTok{1}\NormalTok{ DPATH}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{else.} \KeywordTok{y=.}\NormalTok{boxopen }\KeywordTok{,y} \KeywordTok{end.}
  \KeywordTok{if.} \KeywordTok{*./y} \KeywordTok{e.}\NormalTok{ dl }\KeywordTok{do.}\NormalTok{ mdt closedict}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{else.}\NormalTok{ jderr msg }\KeywordTok{end.}

\KeywordTok{case.} \DecValTok{4} \KeywordTok{do.}

  \CommentTok{NB. HARDCODE (mdt rows) display dictionary names and source paths}
\NormalTok{  mdt}\KeywordTok{=.}\NormalTok{ jpathsep}\KeywordTok{\&.>} \DecValTok{0} \DecValTok{2}\KeywordTok{\{>}\NormalTok{mdt}
\NormalTok{  ok }\KeywordTok{<}\RegionMarkerTok{(}\KeywordTok{/:}\DecValTok{0}\KeywordTok{\{}\NormalTok{mdt}\RegionMarkerTok{)}\KeywordTok{\{} \KeywordTok{|:}\NormalTok{ mdt}

\KeywordTok{case.} \DecValTok{5} \KeywordTok{do.}

  \CommentTok{NB. return the currently registered dictionaries as a (regd) script}
\NormalTok{  mdt}\KeywordTok{=.}\NormalTok{ quote}\KeywordTok{\&.>} \DecValTok{0} \DecValTok{2}\KeywordTok{\{>}\NormalTok{mdt}
\NormalTok{  mdt}\KeywordTok{=.}\NormalTok{ ctl }\KeywordTok{;"}\DecValTok{1} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{}regd \textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{,"}\DecValTok{1} \KeywordTok{|:} \DecValTok{1} \DecValTok{0} \DecValTok{2}\KeywordTok{\{} \RegionMarkerTok{(}\KeywordTok{<}\StringTok{\textquotesingle{};\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{mdt}
  \CommentTok{NB. prefix command to close and unregister all current dictionaries}
\NormalTok{  mdt}\KeywordTok{=.} \StringTok{\textquotesingle{}NB. require \textquotesingle{}\textquotesingle{}general/jod\textquotesingle{}\textquotesingle{}\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\StringTok{\textquotesingle{}3 regd\&> \}. od\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{} [ 3 od \textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\NormalTok{mdt}
\NormalTok{  ok }\StringTok{\textquotesingle{}NB. JOD registrations: \textquotesingle{}}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{tstamp }\StringTok{\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{,}\NormalTok{LF}\KeywordTok{,}\NormalTok{jpathsep mdt}

\KeywordTok{case.do.}\NormalTok{ jderr ERR001  }\CommentTok{NB. errmsg: invalid option(s)}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. format normal return}
\NormalTok{ok}\AlertTok{=:}\index{ok@\texttt{ok}} \KeywordTok{1:} \KeywordTok{;} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{packd}\AlertTok{=:}\index{packd@\texttt{packd}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*packd  v{-}{-} backs up and recovers wasted  space in  dictionary}
\CommentTok{NB. files.   Backups  are  stored  in  the   dictionary\textquotesingle{}s  backup}
\CommentTok{NB. directory. Sets  of backup  files are prefixed  with an  ever}
\CommentTok{NB. increasing backup number, e.g: 13jwords.ijf. Dictionary files}
\CommentTok{NB. are NEVER deleted by JOD commands.}
\CommentTok{NB.}
\CommentTok{NB. monad:  packd clName}
\CommentTok{NB.}
\CommentTok{NB.   packd \textquotesingle{}dictionary\textquotesingle{}}

\CommentTok{NB. NIMP: packd/restd not supported on iOS/Android devices for now}
\CommentTok{NB. if. badrc uv=. checksup \textquotesingle{}packd\textquotesingle{} do. uv return. end.}

\CommentTok{NB. only put dictionaries can be packed}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{DL}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\{}\NormalTok{ uv  }\CommentTok{NB. directory object !(*)=. DL}

\CommentTok{NB. is there enough space on the backup volume?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ packspace}\DecValTok{\_\_}\NormalTok{DL }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}

\NormalTok{packdict}\DecValTok{\_\_}\NormalTok{DL }\KeywordTok{y}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. promote lists to tables {-} other ranks unchanged}
\NormalTok{plt}\AlertTok{=:}\index{plt@\texttt{plt}} \KeywordTok{]\textasciigrave{},:@.}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{\&=@:}\RegionMarkerTok{(}\KeywordTok{\#@:$}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{put}\AlertTok{=:}\index{put@\texttt{put}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*put v{-}{-} stores objects in dictionary database files.}
\CommentTok{NB.}
\CommentTok{NB. monad:  put blclWords}
\CommentTok{NB.}
\CommentTok{NB.   put ;: \textquotesingle{}it where the sun dont shine\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes put bluu}
\CommentTok{NB.}
\CommentTok{NB.   2 7 put \textquotesingle{}GroupName\textquotesingle{};\textquotesingle{}Group documentation text ....\textquotesingle{}}

\NormalTok{WORD put }\KeywordTok{y}
\KeywordTok{:}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001 }\KeywordTok{[}\NormalTok{ loc}\KeywordTok{=.} \KeywordTok{<}\StringTok{\textquotesingle{}base\textquotesingle{}}  \CommentTok{NB. errmsg: invalid option(s)}

\CommentTok{NB. do not save decommented words {-} set PUTBLACK to 1 to override}
\KeywordTok{if.} \KeywordTok{{-}.}\NormalTok{ PUTBLACK }\KeywordTok{+.} \DecValTok{9}\KeywordTok{!:}\DecValTok{40}\StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{do.}
  \CommentTok{NB. errmsg: white space preservation is off {-} turn on to put}
\NormalTok{  jderr ERR023 }\KeywordTok{return.}
\KeywordTok{end.}

\KeywordTok{if.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}
  \CommentTok{NB. errmsg: invalid or missing locale}
  \KeywordTok{if.} \DecValTok{\_1}\KeywordTok{\&}\NormalTok{badlocn }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr ERR004 }\KeywordTok{return.} \KeywordTok{else.} \KeywordTok{x=.}\NormalTok{ WORD }\KeywordTok{[}\NormalTok{ loc }\KeywordTok{=.} \KeywordTok{<x{-}.}\StringTok{\textquotesingle{} \textquotesingle{}} \KeywordTok{end.}
\KeywordTok{end.}

\CommentTok{NB. do we have a put dictionary open?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{DL}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\{}\NormalTok{ uv  }\CommentTok{NB. directory object !(*)=. DL}

\CommentTok{NB. format standard (x) options}
\KeywordTok{x=.} \DecValTok{2} \KeywordTok{\{.} \KeywordTok{x} \KeywordTok{,}\NormalTok{ DEFAULT}

\KeywordTok{select.} \KeywordTok{\{.} \KeywordTok{x}
\KeywordTok{case.}\NormalTok{ WORD }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{loc}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putwords}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;}\DecValTok{1}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ NVTABLE  }\KeywordTok{do.}
      \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.} \RegionMarkerTok{(}\KeywordTok{i.} \DecValTok{4}\RegionMarkerTok{)}\NormalTok{ checknttab2 }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{else.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttable}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{end.}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ TEST }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}
      \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{ checknttab }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{else.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttable}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{end.}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{;}\DecValTok{1}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ GROUP }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{;}\DecValTok{0}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{;}\DecValTok{1}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \CommentTok{NB. HARDCODE {-} lines inserted to maintain put/get symmetry for}
    \CommentTok{NB. the frequent argument cases 2 1 and 3 1}
    \KeywordTok{case.} \DecValTok{1} \KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{;}\DecValTok{0}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{GROUP}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ SUITE }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{;}\DecValTok{0}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{;}\DecValTok{1}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \DecValTok{1} \KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{;}\DecValTok{0}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}  \CommentTok{NB. HARDCODE}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{SUITE}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ MACRO }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}
      \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{ MACROTYPE checknttab2 }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{else.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttable}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{end.}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{;}\DecValTok{1}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ puttexts}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.} \KeywordTok{{-}}\NormalTok{INPUT   }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{;<}\NormalTok{DL}\RegionMarkerTok{)}\NormalTok{ putntstamp}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ DICTIONARY }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ putdicdoc}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg}
  \KeywordTok{end.}
\KeywordTok{case.do.}\NormalTok{ jderr msg}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. quotes character lists for execution}
\NormalTok{quote}\AlertTok{=:}\index{quote@\texttt{quote}} \StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}\KeywordTok{\&,@}\RegionMarkerTok{(}\KeywordTok{,\&}\StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{)}\KeywordTok{@}\RegionMarkerTok{(}\KeywordTok{\#\textasciitilde{}} \KeywordTok{>:@}\RegionMarkerTok{(}\KeywordTok{=\&}\StringTok{\textquotesingle{}\textquotesingle{}\textquotesingle{}\textquotesingle{}}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. reads a file as a list of bytes}
\NormalTok{read}\AlertTok{=:}\index{read@\texttt{read}} \DecValTok{1}\KeywordTok{!:}\DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{]\textasciigrave{}<@.}\RegionMarkerTok{(}\DecValTok{32}\KeywordTok{\&>@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. reads a J binary noun file}
\NormalTok{readnoun}\AlertTok{=:}\index{readnoun@\texttt{readnoun}} \DecValTok{3}\KeywordTok{!:}\DecValTok{2}\KeywordTok{@}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{!:}\DecValTok{1}\KeywordTok{\&}\RegionMarkerTok{(}\KeywordTok{]\textasciigrave{}<@.}\RegionMarkerTok{(}\DecValTok{32}\KeywordTok{\&>@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{))))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{readobid}\AlertTok{=:}\index{readobid@\texttt{readobid}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*readobid  v{-}{-}  unique  object ids  that  opened  dictionaries}
\CommentTok{NB. read/write on this machine.}
\CommentTok{NB.}
\CommentTok{NB. monad: readobid uuIngnore}

\RegionMarkerTok{(}\NormalTok{readnoun }\KeywordTok{::} \RegionMarkerTok{((}\KeywordTok{i.}\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{"}\NormalTok{\_}\RegionMarkerTok{))}\NormalTok{ obidfile }\DecValTok{0}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{regd}\AlertTok{=:}\index{regd@\texttt{regd}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*regd v{-}{-} register and unregister JOD dictionaries.}
\CommentTok{NB.}
\CommentTok{NB. monad:  regd blcl}
\CommentTok{NB.}
\CommentTok{NB.   regd \textquotesingle{}name\textquotesingle{};\textquotesingle{}c:\textbackslash{}location\textbackslash{}of\textbackslash{}files\textquotesingle{};\textquotesingle{}documentation...\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  iaOption make cl}
\CommentTok{NB.}
\CommentTok{NB.   3 regd \textquotesingle{}name\textquotesingle{}  NB. unregister dictionary}

\DecValTok{0}\NormalTok{ newregdict}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
\KeywordTok{:}
\KeywordTok{if.} \KeywordTok{x{-}:}\DecValTok{3} \KeywordTok{do.} \CommentTok{NB. HARDCODE option}
  \CommentTok{NB. errmsg: invalid or missing dictionary name(s)}
  \KeywordTok{if.}\NormalTok{ badcl }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ jderr ERR005 }\KeywordTok{return.} \KeywordTok{end.}
  \CommentTok{NB. errmsg: dictionary in use {-} cannot unregister}
  \KeywordTok{if.} \RegionMarkerTok{(}\KeywordTok{<,y}\RegionMarkerTok{)} \KeywordTok{e.} \KeywordTok{\{."}\DecValTok{1}\NormalTok{ DPATH}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{do.}\NormalTok{ jderr ERR018 }\KeywordTok{return.} \KeywordTok{end.}
  \CommentTok{NB. errmsg: cannot read master}
  \KeywordTok{if.}\NormalTok{ badjr mdt}\KeywordTok{=.}\NormalTok{ jread JMASTER}\KeywordTok{;}\NormalTok{CNMFTAB }\KeywordTok{do.}\NormalTok{ jderr ERR006 }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{  mdt}\KeywordTok{=.>}\NormalTok{mdt}
\NormalTok{  mu}\KeywordTok{=.} \RegionMarkerTok{(}\DecValTok{0}\KeywordTok{\{}\NormalTok{mdt}\RegionMarkerTok{)}\KeywordTok{=<,y}
  \KeywordTok{if.} \KeywordTok{+./}\NormalTok{mu }\KeywordTok{do.}
    \StringTok{\textquotesingle{}path inuse\textquotesingle{}}\KeywordTok{=.} \DecValTok{2} \DecValTok{3}\KeywordTok{\{}\NormalTok{mu }\KeywordTok{\#"}\DecValTok{1}\NormalTok{ mdt}
    \CommentTok{NB. errmsg: dictionary in use {-} cannot unregister}
    \KeywordTok{if.}\NormalTok{ inuse }\KeywordTok{do.}\NormalTok{ jderr ERR018 }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{    newmdt}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{{-}.}\NormalTok{mu}\RegionMarkerTok{)}\KeywordTok{\#"}\DecValTok{1}\NormalTok{ mdt}
    \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ markmast }\DecValTok{1} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badreps }\RegionMarkerTok{((}\KeywordTok{<}\NormalTok{newmdt}\RegionMarkerTok{)}\KeywordTok{,<}\NormalTok{mdt}\RegionMarkerTok{)}\NormalTok{ jreplace JMASTER}\KeywordTok{;}\NormalTok{CNMFTAB}\KeywordTok{,}\NormalTok{CNMFTABBCK }\KeywordTok{do.}
\NormalTok{      jdmasterr ERR017 }\KeywordTok{return.}  \CommentTok{NB. errmsg: jfile replace error}
    \KeywordTok{end.}
    \KeywordTok{if.}\NormalTok{ badrc msg}\KeywordTok{=.}\NormalTok{ markmast}\KeywordTok{\textasciitilde{}}\DecValTok{0} \KeywordTok{do.}\NormalTok{ msg }\KeywordTok{return.} \KeywordTok{end.}
    \RegionMarkerTok{(}\NormalTok{ok OK001}\RegionMarkerTok{)}\KeywordTok{,y;}\NormalTok{jpathsep path}
  \KeywordTok{else.}
\NormalTok{    jderr ERR005}
  \KeywordTok{end.}
\KeywordTok{else.}
\NormalTok{  jderr ERR001}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{remast}\AlertTok{=:}\index{remast@\texttt{remast}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*remast v{-}{-} clears all  in use bits  in the  master file. When}
\CommentTok{NB. JOD  opens a dictionary  an in  use bit is set in the  master}
\CommentTok{NB. file. When the dictionary  is closed the bit is cleared. When}
\CommentTok{NB. the  in  use  bit is set  the  dictionary  cannot  be  opened}
\CommentTok{NB. read/write by other dictionary tasks.}
\CommentTok{NB.}
\CommentTok{NB. monad:  remast paMeAll}
\CommentTok{NB.}
\CommentTok{NB.   remast 0  NB. reset all}
\CommentTok{NB.   remast 1  NB. reset me}

\NormalTok{mdt}\KeywordTok{=.} \KeywordTok{>}\NormalTok{ jread JMASTER}\KeywordTok{;}\NormalTok{CNMFTAB}
\KeywordTok{if.} \DecValTok{0}\KeywordTok{=y} \KeywordTok{do.}
  \CommentTok{NB. reset all}
\NormalTok{  mdt}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<"}\DecValTok{0} \RegionMarkerTok{(}\KeywordTok{\{:$}\NormalTok{mdt}\RegionMarkerTok{)}\KeywordTok{\#}\DecValTok{0}\RegionMarkerTok{)} \DecValTok{3}\KeywordTok{\}}\NormalTok{ mdt}
\KeywordTok{else.}
  \CommentTok{NB. reset me}
\NormalTok{  mdt}\KeywordTok{=.} \RegionMarkerTok{(}\KeywordTok{<}\DecValTok{0}\RegionMarkerTok{)} \RegionMarkerTok{(}\KeywordTok{<}\DecValTok{3}\KeywordTok{;I.} \RegionMarkerTok{(}\KeywordTok{;}\DecValTok{3}\KeywordTok{\{}\NormalTok{mdt}\RegionMarkerTok{)} \KeywordTok{e.}\NormalTok{ readobid obidfile }\DecValTok{0}\RegionMarkerTok{)}\KeywordTok{\}}\NormalTok{mdt}
\KeywordTok{end.}
\RegionMarkerTok{(}\KeywordTok{<}\NormalTok{mdt}\RegionMarkerTok{)}\NormalTok{ jreplace JMASTER}\KeywordTok{;}\NormalTok{CNMFTAB}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{restd}\AlertTok{=:}\index{restd@\texttt{restd}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*restd v{-}{-} restores the most recent backup created by (packd).}
\CommentTok{NB.}
\CommentTok{NB. monad:  restd cl}
\CommentTok{NB.}
\CommentTok{NB.   restd \textquotesingle{}backup\textquotesingle{}}

\CommentTok{NB. NIMP: packd/restd not supported on iOS/Android devices for now}
\CommentTok{NB. if. badrc uv=. checksup \textquotesingle{}restd\textquotesingle{} do. uv return. end.}

\CommentTok{NB. only put dictionaries can be restored}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkput}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{DL}\KeywordTok{=.} \DecValTok{1} \KeywordTok{\{}\NormalTok{ uv  }\CommentTok{NB. directory object !(*)=. DL}

\CommentTok{NB. is there enough space on the dictionary volume?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ restspace}\DecValTok{\_\_}\NormalTok{DL }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{else.} \RegionMarkerTok{(}\KeywordTok{\}.}\NormalTok{ uv}\RegionMarkerTok{)}\NormalTok{ restdict}\DecValTok{\_\_}\NormalTok{DL }\KeywordTok{y} \KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. ok return value}
\NormalTok{rv}\AlertTok{=:}\index{rv@\texttt{rv}} \KeywordTok{>@}\RegionMarkerTok{(}\DecValTok{1}\KeywordTok{\&\{}\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rxs}\AlertTok{=:}\index{rxs@\texttt{rxs}} \StringTok{\textquotesingle{}\textquotesingle{}}\KeywordTok{\&$:} \KeywordTok{:}\RegionMarkerTok{(}\DecValTok{4} \RegionMarkerTok{: 0)}

\CommentTok{NB.*rxs v{-}{-} regular expression search.}
\CommentTok{NB.}
\CommentTok{NB. monad:  rxs blclNames}
\CommentTok{NB.}
\CommentTok{NB.   NB. display all WORD regx search text}
\CommentTok{NB.   NB.  \textquotesingle{}\textquotesingle{} rxs \}. dnl \textquotesingle{}re\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   rxs \}. dnl \textquotesingle{}re\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:  (clPatten ; ilCodes) rxs blclNames}
\CommentTok{NB.        clPattern rxs blclNames}


\CommentTok{NB. do we have a dictionary open?}
\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. (x) is either cl or (cl ; il)  errmsg: invalid option(s)}
\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001}
\KeywordTok{if.} \DecValTok{1} \KeywordTok{<} \KeywordTok{L.} \KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.} \DecValTok{0} \KeywordTok{=} \KeywordTok{L.} \KeywordTok{x} \KeywordTok{do.} \KeywordTok{x=.} \KeywordTok{x} \KeywordTok{;}\NormalTok{ WORD}\KeywordTok{,}\NormalTok{DEFAULT}\KeywordTok{,}\DecValTok{1}
\KeywordTok{else.}
  \KeywordTok{if.} \RegionMarkerTok{(}\DecValTok{1} \KeywordTok{\textasciitilde{}:} \KeywordTok{$$,x}\RegionMarkerTok{)} \KeywordTok{*.} \DecValTok{2} \KeywordTok{\textasciitilde{}:} \KeywordTok{\#,x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{end.}

\CommentTok{NB. regular expression and object options}
\StringTok{\textquotesingle{}pat opts\textquotesingle{}}\KeywordTok{=.} \KeywordTok{x}
\KeywordTok{if.}\NormalTok{ badcl pat  }\KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.}\NormalTok{ badil opts }\KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\CommentTok{NB. format options HARDCODE: codes and positions}
\NormalTok{opts}\KeywordTok{=.}\NormalTok{ opts }\KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{{-}}\DecValTok{3}\KeywordTok{{-}\#}\NormalTok{opts}\RegionMarkerTok{)} \KeywordTok{\{.}\NormalTok{ DEFAULT }\KeywordTok{,} \DecValTok{1}
\KeywordTok{if.} \KeywordTok{{-}.} \DecValTok{1} \DecValTok{2} \DecValTok{3} \KeywordTok{e.\textasciitilde{}} \KeywordTok{\{:}\NormalTok{ opts }\KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}

\KeywordTok{if.}\NormalTok{ DICTIONARY}\KeywordTok{=}\DecValTok{0}\KeywordTok{\{}\NormalTok{opts }\KeywordTok{do.}
  \CommentTok{NB. no short and long texts for dictionary documents}
  \KeywordTok{if.}\NormalTok{ DEFAULT }\KeywordTok{\textasciitilde{}:} \DecValTok{1}\KeywordTok{\{}\NormalTok{opts }\KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{end.}
  \CommentTok{NB. tolerate any (y) for dictionary text case}
\NormalTok{  uv}\KeywordTok{=.}\NormalTok{ opts rxsget }\DecValTok{0}
\KeywordTok{else.}

  \CommentTok{NB. are names valid?}
  \KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{checknames }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{return.} \KeywordTok{else.} \KeywordTok{y=.} \KeywordTok{\}.y} \KeywordTok{end.}

  \CommentTok{NB. remove nouns {-} they are not searched for patterns}
  \CommentTok{NB. return nothing found if all names are nouns}
  \KeywordTok{if.}\NormalTok{ WORD }\KeywordTok{=} \DecValTok{0}\KeywordTok{\{}\NormalTok{opts }\KeywordTok{do.}
    \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{,}\NormalTok{INCLASS}\RegionMarkerTok{)}\NormalTok{ invfetch}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
    \KeywordTok{if.} \DecValTok{0} \KeywordTok{=} \KeywordTok{\#y=.} \KeywordTok{y} \KeywordTok{\#\textasciitilde{}} \DecValTok{0} \KeywordTok{\textasciitilde{}:} \KeywordTok{>}\DecValTok{1}\KeywordTok{\{}\NormalTok{uv }\KeywordTok{do.}\NormalTok{ ok }\KeywordTok{<}\DecValTok{0} \DecValTok{2}\KeywordTok{$<}\StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{return.} \KeywordTok{end.}
  \KeywordTok{end.}

  \KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ opts rxsget }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{end.}

\CommentTok{NB. empty patterns mean return all nonempty text to be searched}
\CommentTok{NB. handy for complex pattern debugging and verification}
\KeywordTok{if.} \KeywordTok{\#}\NormalTok{pat }\KeywordTok{do.} \RegionMarkerTok{(}\NormalTok{pat}\KeywordTok{;}\NormalTok{opts}\RegionMarkerTok{)}\NormalTok{ rxssearch }\KeywordTok{>}\DecValTok{1}\KeywordTok{\{}\NormalTok{uv }\KeywordTok{else.}\NormalTok{ uv  }\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rxsget}\AlertTok{=:}\index{rxsget@\texttt{rxsget}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*rxsget v{-}{-} retrieves  text  objects from dictionary  database}
\CommentTok{NB. files.}
\CommentTok{NB.}
\CommentTok{NB. A  variation of (get) that only retrieves  text  objects from}
\CommentTok{NB. dictionary  database  files. (rxsget)  returns the texts that}
\CommentTok{NB. are searched for regular expression patterns by (rxs).}
\CommentTok{NB.}
\CommentTok{NB. Note:  binary objects (nouns)  are  eliminated from the  name}
\CommentTok{NB. list (y) by the caller of this verb.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  ilCodes rxsget bluu}
\CommentTok{NB.}
\CommentTok{NB.   2 8 1 rxsget \textquotesingle{}GroupName\textquotesingle{}}
\CommentTok{NB.   4 7 1 rxsget \textquotesingle{}MacroText\textquotesingle{}}

\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001 }\CommentTok{NB. errmsg: invalid option(s)}

\KeywordTok{select.} \KeywordTok{\{.} \KeywordTok{x}
\KeywordTok{case.}\NormalTok{ WORD }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{WORD}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ WORD getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ WORD getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg }\KeywordTok{return.}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ TEST }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{TEST}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ TEST getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ TEST getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg  }\KeywordTok{return.}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ GROUP }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ GROUP getgstext}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ GROUP getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ GROUP getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg }\KeywordTok{return.}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ SUITE }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ SUITE getgstext}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ SUITE getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ SUITE getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg }\KeywordTok{return.}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ MACRO }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{MACRO}\KeywordTok{,}\DecValTok{0}\RegionMarkerTok{)}\NormalTok{ getobjects}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ EXPLAIN  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ MACRO getexplain}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.}\NormalTok{ DOCUMENT }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ MACRO getdocument}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y}
    \KeywordTok{case.do.}\NormalTok{ jderr msg }\KeywordTok{return.}
  \KeywordTok{end.}
\KeywordTok{case.}\NormalTok{ DICTIONARY }\KeywordTok{do.}
  \KeywordTok{select.}\NormalTok{ second }\KeywordTok{x}
    \KeywordTok{case.}\NormalTok{ DEFAULT  }\KeywordTok{do.}\NormalTok{ txt}\KeywordTok{=.}\NormalTok{ getdicdoc}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0}
    \KeywordTok{case.do.}\NormalTok{ jderr msg }\KeywordTok{return.}
  \KeywordTok{end.}
\KeywordTok{case.do.}\NormalTok{ jderr msg }\KeywordTok{return.}
\KeywordTok{end.}

\KeywordTok{if.}\NormalTok{ badrc txt }\KeywordTok{do.}\NormalTok{ txt}
\KeywordTok{else.}
  \CommentTok{NB. form two column (name,text) table remove 0 length texts}
  \KeywordTok{if.}\NormalTok{ badcl txt}\KeywordTok{=.} \KeywordTok{>}\DecValTok{1}\KeywordTok{\{}\NormalTok{txt }\KeywordTok{do.}
\NormalTok{    txt}\KeywordTok{=.} \RegionMarkerTok{(}\DecValTok{0}\KeywordTok{,<:\{:$}\NormalTok{txt}\RegionMarkerTok{)} \KeywordTok{\{"}\DecValTok{1}\NormalTok{ txt}
\NormalTok{    ok }\KeywordTok{<}\NormalTok{txt }\KeywordTok{\#\textasciitilde{}} \DecValTok{0} \KeywordTok{<} \KeywordTok{\#\&>} \DecValTok{1} \KeywordTok{\{"}\DecValTok{1}\NormalTok{ txt}
  \KeywordTok{else.}
    \CommentTok{NB. dictionary documentation case often empty {-} only unnamed text}
\NormalTok{    ok }\KeywordTok{<}\RegionMarkerTok{((}\DecValTok{0}\KeywordTok{<\#}\NormalTok{txt}\RegionMarkerTok{)}\KeywordTok{,}\DecValTok{2}\RegionMarkerTok{)}\KeywordTok{$}\StringTok{\textquotesingle{}\textquotesingle{}}\KeywordTok{;}\NormalTok{txt}
  \KeywordTok{end.}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rxssearch}\AlertTok{=:}\index{rxssearch@\texttt{rxssearch}} \DecValTok{4} \RegionMarkerTok{: 0}

\CommentTok{NB.*rxssearch v{-}{-} search (name, text) table for regex matches.}
\CommentTok{NB.}
\CommentTok{NB. dyad:  (clPat ; ilOpts) rxssearch btNameText}

\CommentTok{NB. all arguments validated by callers}
\StringTok{\textquotesingle{}pat opts\textquotesingle{}}\KeywordTok{=.} \KeywordTok{x}

\CommentTok{NB. require \textquotesingle{}regex\textquotesingle{} !(*)=. rxfirst rxall rxmatches}
\CommentTok{NB. HARDCODE: option codes}
\KeywordTok{select.} \KeywordTok{\{:}\NormalTok{opts}
\KeywordTok{case.} \DecValTok{1} \KeywordTok{do.}
\NormalTok{  h}\KeywordTok{=.}\NormalTok{ pat}\KeywordTok{\&}\NormalTok{rxfirst}\KeywordTok{\&.>} \DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}
\NormalTok{  ok  }\KeywordTok{<}\RegionMarkerTok{((}\DecValTok{0} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}\RegionMarkerTok{)} \KeywordTok{,.}\NormalTok{ h}\RegionMarkerTok{)} \KeywordTok{\#\textasciitilde{}} \DecValTok{0} \KeywordTok{<} \KeywordTok{\#\&>}\NormalTok{ h}
\KeywordTok{case.} \DecValTok{2} \KeywordTok{do.}
\NormalTok{  h}\KeywordTok{=.}\NormalTok{ pat}\KeywordTok{\&}\NormalTok{rxall}\KeywordTok{\&.>} \DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}
\NormalTok{  ok  }\KeywordTok{<}\RegionMarkerTok{((}\DecValTok{0} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}\RegionMarkerTok{)} \KeywordTok{,.}\NormalTok{ h}\RegionMarkerTok{)} \KeywordTok{\#\textasciitilde{}} \DecValTok{0} \KeywordTok{<} \KeywordTok{\#\&>}\NormalTok{ h}
\KeywordTok{case.} \DecValTok{3} \KeywordTok{do.}
\NormalTok{  h}\KeywordTok{=.}\NormalTok{ pat}\KeywordTok{\&}\NormalTok{rxmatches}\KeywordTok{\&.>} \DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}
\NormalTok{  b}\KeywordTok{=.} \DecValTok{0} \KeywordTok{<} \KeywordTok{\#\&>}\NormalTok{ h}
\NormalTok{  ok  }\KeywordTok{<}\RegionMarkerTok{(}\NormalTok{b }\KeywordTok{\#} \DecValTok{0} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}\RegionMarkerTok{)} \KeywordTok{,.} \RegionMarkerTok{(}\NormalTok{b }\KeywordTok{\#}\NormalTok{ h}\RegionMarkerTok{)} \KeywordTok{,.}\NormalTok{ b }\KeywordTok{\#} \DecValTok{1} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{y}
\KeywordTok{case.do.}\NormalTok{ jderr ERR001}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{saveobid}\AlertTok{=:}\index{saveobid@\texttt{saveobid}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*saveobid v{-}{-}  saves the last  n JOD object ids  in the \textbackslash{}jnxxx}
\CommentTok{NB. directory. These globally unique values are used to reset any}
\CommentTok{NB. dictionaries left open by JOD tasks spawned from  the current}
\CommentTok{NB. machine.}
\CommentTok{NB.}
\CommentTok{NB. monad:  saveobid xiObid}
\CommentTok{NB.}
\CommentTok{NB.   saveobid JODOBID}

\NormalTok{id}\KeywordTok{=.} \KeywordTok{\textasciitilde{}.} \KeywordTok{y} \KeywordTok{,}\NormalTok{ readobid file}\KeywordTok{=.}\NormalTok{obidfile }\DecValTok{0}

\CommentTok{NB. HARDCODE up to 30 last object ids spawned on this machine}
\CommentTok{NB. NOTE: if you run more than 30 JOD tasks on the current}
\CommentTok{NB. machine you will lose object id\textquotesingle{}s which cause the RESETME}
\CommentTok{NB. option of (dpset) to not reset all dictionaries recently opened {-}}
\CommentTok{NB. but never closed {-} on this machine. JUST INCREASE THE NUMBER EHHH!!}
\RegionMarkerTok{((}\DecValTok{30}\KeywordTok{<.\#}\NormalTok{id}\RegionMarkerTok{)} \KeywordTok{\{.}\NormalTok{ id}\RegionMarkerTok{)} \RegionMarkerTok{(}\NormalTok{writenoun }\KeywordTok{::} \KeywordTok{\_1:}\RegionMarkerTok{)}\NormalTok{ file}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. second list item}
\NormalTok{second}\AlertTok{=:}\index{second@\texttt{second}} \DecValTok{1}\KeywordTok{\&\{}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. J type code}
\NormalTok{tc}\AlertTok{=:}\index{tc@\texttt{tc}} \DecValTok{3}\KeywordTok{!:}\DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. removes blanks from items on blcl}
\NormalTok{trimnl}\AlertTok{=:}\index{trimnl@\texttt{trimnl}} \KeywordTok{{-}.\&}\StringTok{\textquotesingle{} \textquotesingle{}}\KeywordTok{\&.>}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. appends trailing / iff last character is not \textbackslash{} or /}
\NormalTok{tslash2}\AlertTok{=:}\index{tslash2@\texttt{tslash2}} \RegionMarkerTok{(}\KeywordTok{[:} \KeywordTok{{-}} \StringTok{\textquotesingle{}\textbackslash{}/\textquotesingle{}} \KeywordTok{e.\textasciitilde{}} \KeywordTok{\{:}\RegionMarkerTok{)} \KeywordTok{\}.} \StringTok{\textquotesingle{}/\textquotesingle{}} \KeywordTok{,\textasciitilde{}} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tstamp}\AlertTok{=:}\index{tstamp@\texttt{tstamp}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*tstamp v{-}{-} standard j 8\_07 library timestamp.}
\CommentTok{NB.}
\CommentTok{NB. A renamed version of the standard  J 8.07 era  timestamp. JOD}
\CommentTok{NB. used an earlier version of this verb, see (tstamp2), that did}
\CommentTok{NB. not handle all zero timestamps.}
\CommentTok{NB.}
\CommentTok{NB. monad:  clDate =. tstamp il | fl}
\CommentTok{NB.}
\CommentTok{NB.   tstamp \textquotesingle{}\textquotesingle{} NB. now timestamp}
\CommentTok{NB.   tstamp 0 0 0 0 0 0  NB. zero stamp}

\KeywordTok{if.} \DecValTok{0} \KeywordTok{=} \KeywordTok{\#y} \KeywordTok{do.}\NormalTok{ w}\KeywordTok{=.} \DecValTok{6}\KeywordTok{!:}\DecValTok{0}\StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{else.}\NormalTok{ w}\KeywordTok{=.} \KeywordTok{y} \KeywordTok{end.}
\NormalTok{r}\KeywordTok{=.} \KeywordTok{\}:} \KeywordTok{$}\NormalTok{ w}
\NormalTok{t}\KeywordTok{=.} \DecValTok{2} \DecValTok{1} \DecValTok{0} \DecValTok{3} \DecValTok{4} \DecValTok{5} \KeywordTok{\{"}\DecValTok{1} \KeywordTok{[} \DecValTok{\_6} \KeywordTok{[\textbackslash{}} \KeywordTok{,} \DecValTok{6} \KeywordTok{\{."}\DecValTok{1} \KeywordTok{<.}\NormalTok{ w}
\NormalTok{d}\KeywordTok{=.} \StringTok{\textquotesingle{}+++::\textquotesingle{}} \DecValTok{2} \DecValTok{6} \DecValTok{11} \DecValTok{14} \DecValTok{17} \KeywordTok{\}"}\DecValTok{1} \KeywordTok{[} \DecValTok{2} \DecValTok{4} \DecValTok{5} \DecValTok{3} \DecValTok{3} \DecValTok{3} \KeywordTok{":}\NormalTok{ t}
\NormalTok{mth}\KeywordTok{=.} \DecValTok{\_3}\KeywordTok{[\textbackslash{}}\StringTok{\textquotesingle{}   JanFebMarAprMayJunJulAugSepOctNovDec\textquotesingle{}}
\NormalTok{d}\KeywordTok{=.} \KeywordTok{,}\RegionMarkerTok{((}\DecValTok{1} \KeywordTok{\{"}\DecValTok{1}\NormalTok{ t}\RegionMarkerTok{)} \KeywordTok{\{}\NormalTok{ mth}\RegionMarkerTok{)} \DecValTok{3} \DecValTok{4} \DecValTok{5} \KeywordTok{\}"}\DecValTok{1}\NormalTok{ d}
\NormalTok{d}\KeywordTok{=.} \StringTok{\textquotesingle{}0\textquotesingle{}} \RegionMarkerTok{(}\KeywordTok{I.}\NormalTok{ d}\KeywordTok{=}\StringTok{\textquotesingle{} \textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{\}}\NormalTok{ d}
\NormalTok{d}\KeywordTok{=.} \StringTok{\textquotesingle{} \textquotesingle{}} \RegionMarkerTok{(}\KeywordTok{I.}\NormalTok{ d}\KeywordTok{=}\StringTok{\textquotesingle{}+\textquotesingle{}}\RegionMarkerTok{)} \KeywordTok{\}}\NormalTok{ d}
\RegionMarkerTok{(}\NormalTok{r}\KeywordTok{,}\DecValTok{20}\RegionMarkerTok{)} \KeywordTok{$}\NormalTok{ d}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uses}\AlertTok{=:}\index{uses@\texttt{uses}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*uses v{-}{-} returns word references.}
\CommentTok{NB.}
\CommentTok{NB. monad:  uses blclName}
\CommentTok{NB.}
\CommentTok{NB.   NB. non{-}locale global word references}
\CommentTok{NB.   uses ;:\textquotesingle{}out global references please\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB. dyad:   ilObjOpt uses clName}
\CommentTok{NB.}
\CommentTok{NB.   NB. global locale word references}
\CommentTok{NB.   11 uses ;:\textquotesingle{}out locale references\textquotesingle{}}
\CommentTok{NB.}
\CommentTok{NB.   0 31 uses \textquotesingle{}wordname\textquotesingle{}  NB. uses union of word}
\CommentTok{NB.   0 32 uses \textquotesingle{}}

\DecValTok{0}\NormalTok{ uses }\KeywordTok{y}
\KeywordTok{:}

\KeywordTok{if.}\NormalTok{ badrc uv}\KeywordTok{=.}\NormalTok{ checkopen}\DecValTok{\_\_}\NormalTok{ST }\DecValTok{0} \KeywordTok{do.}\NormalTok{ uv }\KeywordTok{return.} \KeywordTok{end.}
\KeywordTok{if.}\NormalTok{ badrc }\KeywordTok{y=.}\NormalTok{checknames }\KeywordTok{y} \KeywordTok{do.} \KeywordTok{y} \KeywordTok{return.} \KeywordTok{else.} \KeywordTok{y=.} \KeywordTok{\}.y} \KeywordTok{end.}

\NormalTok{msg}\KeywordTok{=.}\NormalTok{ ERR001 }\CommentTok{NB. errmsg: invalid option(s)}
\KeywordTok{if.}\NormalTok{ badil }\KeywordTok{x} \KeywordTok{do.}\NormalTok{ jderr msg }\KeywordTok{return.} \KeywordTok{else.} \KeywordTok{x=.} \StringTok{\textquotesingle{}\textquotesingle{}}\KeywordTok{$x} \KeywordTok{end.}

\KeywordTok{if.} \KeywordTok{x{-}:}\NormalTok{WORD }\KeywordTok{do.}
  \KeywordTok{if.}\NormalTok{ badrc dat}\KeywordTok{=.}\NormalTok{WORD getrefs}\DecValTok{\_\_}\NormalTok{ST }\KeywordTok{y} \KeywordTok{do.}\NormalTok{ dat }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{  dat}\KeywordTok{=.}\NormalTok{ rv dat}
\NormalTok{  dat}\KeywordTok{=.} \RegionMarkerTok{(}\NormalTok{uv}\KeywordTok{=.} \KeywordTok{\{."}\DecValTok{1}\NormalTok{ dat}\RegionMarkerTok{)} \KeywordTok{,.} \KeywordTok{>} \KeywordTok{\{:"}\DecValTok{1}\NormalTok{ dat}
  \CommentTok{NB. return in order requested}
\NormalTok{  ok }\KeywordTok{<}\RegionMarkerTok{((}\KeywordTok{\{."}\DecValTok{1}\NormalTok{ dat}\RegionMarkerTok{)} \KeywordTok{i.} \KeywordTok{y}\RegionMarkerTok{)}\KeywordTok{\{}\NormalTok{dat}
\KeywordTok{elseif.} \KeywordTok{x{-}:}\NormalTok{UNION }\KeywordTok{do.}

  \CommentTok{NB. word uses unions}
\NormalTok{  uv}\KeywordTok{=.} \KeywordTok{i.} \DecValTok{0} \DecValTok{0}
  \KeywordTok{for\_wrd.} \KeywordTok{y} \KeywordTok{do.}
\NormalTok{    srch}\KeywordTok{=.}\StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{[}\NormalTok{ refs}\KeywordTok{=.}\NormalTok{wrd}
\NormalTok{    loc}\KeywordTok{=.}\StringTok{\textquotesingle{}\textquotesingle{}} \KeywordTok{[}\NormalTok{ self}\KeywordTok{=.}\DecValTok{0}
    \KeywordTok{while.do.}
      \KeywordTok{if.}\NormalTok{ badrc dat}\KeywordTok{=.}\NormalTok{WORD getrefs}\DecValTok{\_\_}\NormalTok{ST refs }\KeywordTok{do.}\NormalTok{ dat }\KeywordTok{return.} \KeywordTok{end.}
\NormalTok{      srch}\KeywordTok{=.} \KeywordTok{\textasciitilde{}.}\NormalTok{ srch }\KeywordTok{,} \KeywordTok{\{."}\DecValTok{1}\NormalTok{ dat}\KeywordTok{=.}\NormalTok{ rv dat}
      \CommentTok{NB. only non{-}locale names are searched}
\NormalTok{      self}\KeywordTok{=.}\NormalTok{ self}\KeywordTok{+.}\NormalTok{wrd }\KeywordTok{e.}\NormalTok{ new}\KeywordTok{=.} \KeywordTok{\textasciitilde{}.} \KeywordTok{;} \KeywordTok{\{.\&>} \KeywordTok{\{:"}\DecValTok{1}\NormalTok{ dat}
\NormalTok{      new}\KeywordTok{=.}\NormalTok{ new }\KeywordTok{{-}.}\NormalTok{ srch}
\NormalTok{      loc}\KeywordTok{=.} \KeywordTok{\textasciitilde{}.}\NormalTok{ loc }\KeywordTok{,} \RegionMarkerTok{(}\KeywordTok{;} \KeywordTok{\{:\&>} \KeywordTok{\{:"}\DecValTok{1}\NormalTok{ dat}\RegionMarkerTok{)} \KeywordTok{{-}.}\NormalTok{ loc}
      \KeywordTok{if.}\NormalTok{ isempty new }\KeywordTok{do.} \KeywordTok{break.} \KeywordTok{end.}
\NormalTok{      refs}\KeywordTok{=.}\NormalTok{ new}
    \KeywordTok{end.}
\NormalTok{    srch}\KeywordTok{=.} \KeywordTok{/:\textasciitilde{}}\NormalTok{ srch }\KeywordTok{{-}.}\NormalTok{ self}\KeywordTok{\}.}\NormalTok{wrd}
\NormalTok{    uv}\KeywordTok{=.}\NormalTok{ uv}\KeywordTok{,}\NormalTok{wrd}\KeywordTok{,}\NormalTok{srch}\KeywordTok{;<}\NormalTok{loc}
  \KeywordTok{end.}
\NormalTok{  ok }\KeywordTok{<}\NormalTok{uv}

\KeywordTok{elseif.do.}\NormalTok{ jderr msg}
\KeywordTok{end.}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{valdate}\AlertTok{=:}\index{valdate@\texttt{valdate}} \DecValTok{3} \RegionMarkerTok{: 0}

\CommentTok{NB.*valdate v{-}{-} validates lists or tables of YYYY MM DD Gregorian}
\CommentTok{NB. calendar dates.}
\CommentTok{NB.}
\CommentTok{NB. monad:  valdate il|it}
\CommentTok{NB.}
\CommentTok{NB.   valdate 1953 7 2}
\CommentTok{NB.   valdate 1953 2 29 ,: 1953 2 28  NB. not a leap year}

\NormalTok{s}\KeywordTok{=.} \KeywordTok{\}:$y}
\StringTok{\textquotesingle{}w m d\textquotesingle{}}\KeywordTok{=.}\NormalTok{ t}\KeywordTok{=.} \KeywordTok{|:}\RegionMarkerTok{((}\KeywordTok{*/}\NormalTok{s}\RegionMarkerTok{)}\KeywordTok{,}\DecValTok{3}\RegionMarkerTok{)}\KeywordTok{$,y}
\NormalTok{b}\KeywordTok{=.} \KeywordTok{*./}\RegionMarkerTok{(}\NormalTok{t}\KeywordTok{=<.}\NormalTok{t}\RegionMarkerTok{)}\KeywordTok{,}\RegionMarkerTok{(}\NormalTok{\_}\DecValTok{1} \DecValTok{0} \DecValTok{0}\KeywordTok{<}\NormalTok{t}\RegionMarkerTok{)}\KeywordTok{,}\DecValTok{12}\KeywordTok{>:m}
\NormalTok{day}\KeywordTok{=.} \RegionMarkerTok{(}\DecValTok{13}\KeywordTok{|m}\RegionMarkerTok{)}\KeywordTok{\{}\DecValTok{0} \DecValTok{31} \DecValTok{28} \DecValTok{31} \DecValTok{30} \DecValTok{31} \DecValTok{30} \DecValTok{31} \DecValTok{31} \DecValTok{30} \DecValTok{31} \DecValTok{30} \DecValTok{31}
\NormalTok{day}\KeywordTok{=.}\NormalTok{ day}\KeywordTok{+}\RegionMarkerTok{(}\KeywordTok{m=}\DecValTok{2}\RegionMarkerTok{)}\KeywordTok{*{-}/}\DecValTok{0}\KeywordTok{=}\DecValTok{4} \DecValTok{100} \DecValTok{400}\KeywordTok{|/}\NormalTok{w}
\NormalTok{s}\KeywordTok{$}\NormalTok{b}\KeywordTok{*}\NormalTok{d}\KeywordTok{<:}\NormalTok{day}
\RegionMarkerTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. 1 when word with name exists 0 otherwise}
\NormalTok{wex}\AlertTok{=:}\index{wex@\texttt{wex}} \DecValTok{0}\KeywordTok{\&<:@:}\NormalTok{nc}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. word storage representation {-} nouns binary others linear}
\NormalTok{wrep}\AlertTok{=:}\index{wrep@\texttt{wrep}} \DecValTok{5}\KeywordTok{!:}\DecValTok{5}\KeywordTok{@<\textasciigrave{}}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{1}\KeywordTok{@:".}\RegionMarkerTok{)}\KeywordTok{@.}\RegionMarkerTok{(}\DecValTok{0}\KeywordTok{\&=@}\RegionMarkerTok{(}\NormalTok{nc}\KeywordTok{@<}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. writes a list of bytes to file}
\NormalTok{write}\AlertTok{=:}\index{write@\texttt{write}} \DecValTok{1}\KeywordTok{!:}\DecValTok{2} \KeywordTok{]\textasciigrave{}<@.}\RegionMarkerTok{(}\DecValTok{32}\KeywordTok{\&>@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{NB. writes a J noun file}
\NormalTok{writenoun}\AlertTok{=:}\index{writenoun@\texttt{writenoun}} \RegionMarkerTok{(}\KeywordTok{[:} \DecValTok{3}\KeywordTok{!:}\DecValTok{1} \KeywordTok{[}\RegionMarkerTok{)} \RegionMarkerTok{(}\DecValTok{1}\KeywordTok{!:}\DecValTok{2} \KeywordTok{]\textasciigrave{}<@.}\RegionMarkerTok{(}\DecValTok{32}\KeywordTok{\&>@}\RegionMarkerTok{(}\DecValTok{3}\KeywordTok{!:}\DecValTok{0}\RegionMarkerTok{)))} \KeywordTok{]}
\end{Highlighting}
\end{Shaded}
